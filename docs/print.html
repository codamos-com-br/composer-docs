<!DOCTYPE HTML>
<html lang="pt-br" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Composer - PT-BR</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Book</li><li class="chapter-item expanded "><a href="pt-br/00-introducao.html"><strong aria-hidden="true">1.</strong> Introdução</a></li><li class="chapter-item expanded "><a href="pt-br/01-utilizacao-basica.html"><strong aria-hidden="true">2.</strong> Utilização básica</a></li><li class="chapter-item expanded "><a href="pt-br/02-bibliotecas.html"><strong aria-hidden="true">3.</strong> Bibliotecas</a></li><li class="chapter-item expanded "><a href="pt-br/03-linha-de-comando.html"><strong aria-hidden="true">4.</strong> Linha de comando (CLI)</a></li><li class="chapter-item expanded "><a href="pt-br/04-schema.html"><strong aria-hidden="true">5.</strong> Schema</a></li><li class="chapter-item expanded "><a href="pt-br/05-repositorios.html"><strong aria-hidden="true">6.</strong> Repositorios</a></li><li class="chapter-item expanded "><a href="pt-br/06-configuracao.html"><strong aria-hidden="true">7.</strong> Configuração</a></li><li class="chapter-item expanded "><a href="pt-br/07-ambiente.html"><strong aria-hidden="true">8.</strong> Ambiente</a></li><li class="chapter-item expanded "><a href="pt-br/08-comunidade.html"><strong aria-hidden="true">9.</strong> Comunidade</a></li><li class="chapter-item expanded affix "><li class="part-title">Articles</li><li class="chapter-item expanded "><a href="en/articles/aliases.html"><strong aria-hidden="true">10.</strong> Aliases</a></li><li class="chapter-item expanded "><a href="en/articles/authentication-for-private-packages.html"><strong aria-hidden="true">11.</strong> Authentication for privately hosted packages and repositories</a></li><li class="chapter-item expanded "><a href="en/articles/autoloader-optimization.html"><strong aria-hidden="true">12.</strong> Autoloader optimization</a></li><li class="chapter-item expanded "><a href="en/articles/composer-platform-dependencies.html"><strong aria-hidden="true">13.</strong> Composer platform dependencies</a></li><li class="chapter-item expanded "><a href="en/articles/custom-installers.html"><strong aria-hidden="true">14.</strong> Setting up and using custom installers</a></li><li class="chapter-item expanded "><a href="en/articles/handling-private-packages.html"><strong aria-hidden="true">15.</strong> Handling private packages</a></li><li class="chapter-item expanded "><a href="en/articles/plugins.html"><strong aria-hidden="true">16.</strong> Setting up and using plugins</a></li><li class="chapter-item expanded "><a href="en/articles/repository-priorities.html"><strong aria-hidden="true">17.</strong> Repository priorities</a></li><li class="chapter-item expanded "><a href="en/articles/resolving-merge-conflicts.html"><strong aria-hidden="true">18.</strong> Resolving merge conflicts</a></li><li class="chapter-item expanded "><a href="en/articles/scripts.html"><strong aria-hidden="true">19.</strong> Scripts</a></li><li class="chapter-item expanded "><a href="en/articles/troubleshooting.html"><strong aria-hidden="true">20.</strong> Troubleshooting</a></li><li class="chapter-item expanded "><a href="en/articles/vendor-binaries.html"><strong aria-hidden="true">21.</strong> Vendor binaries and the vendor/bin directory</a></li><li class="chapter-item expanded "><a href="en/articles/versions.html"><strong aria-hidden="true">22.</strong> Versions and constraints</a></li><li class="chapter-item expanded affix "><li class="part-title">FAQs</li><li class="chapter-item expanded "><a href="en/faqs/how-do-i-install-a-package-to-a-custom-path-for-my-framework.html"><strong aria-hidden="true">23.</strong> How do I install a package to a custom path for my framework?</a></li><li class="chapter-item expanded "><a href="en/faqs/how-to-install-composer-programmatically.html"><strong aria-hidden="true">24.</strong> How do I install Composer programmatically?</a></li><li class="chapter-item expanded "><a href="en/faqs/how-to-install-untrusted-packages-safely.html"><strong aria-hidden="true">25.</strong> How do I install untrusted packages safely? Is it safe to run Composer as superuser or root?</a></li><li class="chapter-item expanded "><a href="en/faqs/should-i-commit-the-dependencies-in-my-vendor-directory.html"><strong aria-hidden="true">26.</strong> Should I commit the dependencies in my vendor directory?</a></li><li class="chapter-item expanded "><a href="en/faqs/which-version-numbering-system-does-composer-itself-use.html"><strong aria-hidden="true">27.</strong> Which version numbering system does Composer itself use?</a></li><li class="chapter-item expanded "><a href="en/faqs/why-are-unbound-version-constraints-a-bad-idea.html"><strong aria-hidden="true">28.</strong> Why are unbound version constraints a bad idea?</a></li><li class="chapter-item expanded "><a href="en/faqs/why-are-version-constraints-combining-comparisons-and-wildcards-a-bad-idea.html"><strong aria-hidden="true">29.</strong> Why are version constraints combining comparisons and wildcards a bad idea?</a></li><li class="chapter-item expanded "><a href="en/faqs/why-cant-composer-load-repositories-recursively.html"><strong aria-hidden="true">30.</strong> Why can't Composer load repositories recursively?</a></li><li class="chapter-item expanded affix "><li class="part-title">API Docs</li><li class="chapter-item expanded "><div><strong aria-hidden="true">31.</strong> API Docs</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Composer - PT-BR</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div style="break-before: page; page-break-before: always;"></div><h1 id="introdução"><a class="header" href="#introdução">Introdução</a></h1>
<p>Composer é uma ferramenta para gerenciamento de dependências em PHP. Ela te
permite declarar de quais bibliotecas seu projeto depende e as gerenciará
(fará a instalação e atualização) para você.</p>
<h2 id="gerenciamento-de-dependências"><a class="header" href="#gerenciamento-de-dependências">Gerenciamento de dependências</a></h2>
<p>Composer <strong>não é</strong> um gerenciador de pacotes no mesmo sentido em que Yum ou
Apt são. Sim, Composer lida com &quot;pacotes&quot; ou bibliotecas, mas as gerencia
por projeto e as instala num diretório dentro de seu projeto (por exemplo <code>vendor</code>).
Por padrão nada é instalado de forma global. Portanto Composer é um gerenciador
de dependências. Porém Composer oferece um projeto &quot;global&quot; para facilitar a sua
vida, através do comando <a href="pt-br/03-linha-de-comando.html#global">global</a>.</p>
<p>Esta ideia não é novidade e Composer foi fortemente inspirado pelo
<a href="https://www.npmjs.com/">npm</a> do Node e <a href="https://bundler.io/">bundler</a> do Ruby.</p>
<p>Vamos supor que:</p>
<ol>
<li>Você possua um projeto que depende de várias bibliotecas.</li>
<li>Algumas destas bibliotecas dependem de outras bibliotecas.</li>
</ol>
<p>Composer:</p>
<ol>
<li>Te permite declarar de quais bibliotecas você depende.</li>
<li>Encontra quais versões de quais pacotes podem e precisa ser instaladas, e
as instala (as baixa para o seu projeto).</li>
<li>Você pode atualizar todas suas dependências em um único comando.</li>
</ol>
<p>Veja o capítulo <a href="pt-br/01-utilizacao-basica.html">Utilização básica</a> para mais detalhes
sobre como declarar dependências.</p>
<h2 id="requisitos-de-sistema"><a class="header" href="#requisitos-de-sistema">Requisitos de Sistema</a></h2>
<p>A versão mais recente de Composer precisa do PHP 7.2.5 para executar. A versão de
suporte continuado (2.2.x) ainda oferece suporte para PHP 5.3.2+ caso você
ainda utilize a versão legada da linguagem PHP. Algumas configurações do PHP
e flags de compilação também são necessárias, mas ao utilizar o instalador
você receberá avisos sobre quaisquer incompatibilidades.</p>
<p>Para instalar pacotes a partir de código fonte em vez de arquivos zip, você
vai precisar de git, svn, fossil ou hg dependendo de como é feito o
gerenciamento de versões.</p>
<p>Composer é multi-plataforma e nós nos esforçamos para fazer com que execute 
igualmente bem nas plataformas Windows, Linux e macOS.</p>
<h2 id="instalação---linux--unix--macos"><a class="header" href="#instalação---linux--unix--macos">Instalação - Linux / Unix / macOS</a></h2>
<h3 id="baixando-o-executável-composer"><a class="header" href="#baixando-o-executável-composer">Baixando o executável Composer</a></h3>
<p>Composer oferece um instalador bem conveniente que você pode executar diretamente
da linha de comando. Sinta-se livre para
<a href="https://getcomposer.org/installer">baixar este arquivo</a>
ou revisá-lo no <a href="https://github.com/composer/getcomposer.org/blob/main/web/installer">GitHub</a>
caso queira saber mais detalhes de como ele funciona internamente. O código está
em PHP puro.</p>
<p>Há duas formas de instalar Composer. De forma local, dentro de seu projeto, ou
com uma instalação global disponível para todo seu sistema.</p>
<h4 id="local"><a class="header" href="#local">Local</a></h4>
<p>Para instalar Composer de forma local, execute o instalador no diretório de seu
projeto. Visite a <a href="https://getcomposer.org/download/">página de Download</a> para
obter instruções.</p>
<p>O instalador vai verificar algumas configurações do PHP e baixar o arquivo
<code>composer.phar</code> para o seu diretório atual. Este arquivo é o binário de Composer.
É um PHAR (PHP archive), um formato <em>archive</em> para PHP que pode executar na linha
de comando, dentre outras coisas.</p>
<p>Agora execute <code>php composer.phar</code> para executar Composer.</p>
<p>Você pode instalar Composer em um diretório específico usando a opção
<code>--install-dir</code> e também (re)nomeá-lo utilizando a opção <code>--filename</code>.
Quando ao executar o instalador, ao seguir
<a href="https://getcomposer.org/download/">as instruções da página de Download</a>,
adicione os seguintes parâmetros:</p>
<pre><code class="language-sh">php composer-setup.php --install-dir=bin --filename=composer
</code></pre>
<p>Agora execute <code>php bin/composer</code> para executar o binário Composer.</p>
<h4 id="global"><a class="header" href="#global">Global</a></h4>
<p>Você pode colocar o arquivo Composer PHAR em qualquer lugar que quiser. Se você
o colocar num diretório incluído em sua variável <code>PATH</code>, poderá o acessar de
forma global. Em sistemas Unix você pode até mesmo torná-lo executável e executar 
o comando diretamente sem precisar prefixar com o interpretador <code>php</code> na
linha de comando.</p>
<p>Após executaro instalador seguindo
<a href="https://getcomposer.org/download/">as instruções da página de Download</a>
você pode executar o seguinte comando para mover composer.phar para um diretório
que esteja em sua variável path:</p>
<pre><code class="language-sh">mv composer.phar /usr/local/bin/composer
</code></pre>
<p>Caso queira instalar apenas para o seu usuário e evitar a necessidade de permissões
de super usuário (root), você pode usar <code>~/.local/bin</code> que é disponibilizado por
padrão em algumas distros Linux.</p>
<blockquote>
<p><strong>Importante:</strong> Se o comando acima falhar por conta de permissões, você pode
precisar executar o comando novamente com <code>sudo</code>.</p>
</blockquote>
<blockquote>
<p><strong>Importante:</strong> Em algumas versões do macOS o diretório <code>/usr</code> não existe. Se
você receber o erro &quot;/usr/local/bin/composer: No such file or directory&quot; você
vai precisar criar o diretório manualmente antes de executar o comando:
<code>mkdir -p /usr/local/bin</code>.</p>
</blockquote>
<blockquote>
<p><strong>Importante:</strong> Para obter informações sobre como alterar sua variável PATH,
leia o <a href="https://en.wikipedia.org/wiki/PATH_(variable)">artigo na Wikipedia</a>
e/ou utilize seu mecanismo de busca favorito.</p>
</blockquote>
<p>Agora execute <code>composer</code> para executar Composer em vez de <code>php composer.phar</code>.</p>
<h2 id="instalação---windows"><a class="header" href="#instalação---windows">Instalação - Windows</a></h2>
<h3 id="utilizando-o-instalador"><a class="header" href="#utilizando-o-instalador">Utilizando o Instalador</a></h3>
<p>Esta é a maneira mais fácil de instalar Composer em seu computador.</p>
<p>Baixe e execute <a href="https://getcomposer.org/Composer-Setup.exe">Composer-Setup.exe</a>.
Isto vai instalar a versão mais recente de Composer e configurar sua variável
PATH para que você possa executar <code>composer</code> a partir de qualquer diretório
em sua linha de comando.</p>
<blockquote>
<p><strong>Importante:</strong> Feche seu terminal. Teste a utilização de Composer com um
terminal novo: isto é importante porque a variável PATH só é carregada
quando o terminal é inicializado.</p>
</blockquote>
<h3 id="instalação-manual"><a class="header" href="#instalação-manual">Instalação Manual</a></h3>
<p>Vá para algum diretório descrito em sua variável PATH e execute o instalador
seguindo <a href="https://getcomposer.org/download/">as instruções da página de Download</a>
para baixar o arquivo <code>composer.phar</code>.</p>
<p>Crie um arquivo <code>composer.bat</code> ao lado de <code>composer.phar</code>:</p>
<p>Utilizando cmd.exe:</p>
<pre><code class="language-sh">C:\bin&gt; echo @php &quot;%~dp0composer.phar&quot; %*&gt;composer.bat
</code></pre>
<p>Utilizando PowerShell:</p>
<pre><code class="language-sh">PS C:\bin&gt; Set-Content composer.bat '@php &quot;%~dp0composer.phar&quot; %*'
</code></pre>
<p>Adicione o diretório em sua variável PATH caso ainda não esteja adicionado.
Para informações sobre como alterar sua variável PATH, veja
<a href="https://www.computerhope.com/issues/ch000549.htm">este artigo</a> e/ou
utilize seu mecanismo de busca favorito.</p>
<p>Feche seu terminal atual. E teste Composer com um novo terminal:</p>
<pre><code class="language-sh">C:\Users\username&gt;composer -V
Composer version 2.0.12 2021-04-01 10:14:59
</code></pre>
<h2 id="utilizando-composer"><a class="header" href="#utilizando-composer">Utilizando Composer</a></h2>
<p>Agora que você instalou Composer, você já tem tudo o que precisa para começar
a usar! Vá para o próximo capítulo para uma pequena amostra de como utilizar Composer.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basic-usage"><a class="header" href="#basic-usage">Basic usage</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>For our basic usage introduction, we will be installing <code>monolog/monolog</code>,
a logging library. If you have not yet installed Composer, refer to the
<a href="pt-br/00-intro.html">Intro</a> chapter.</p>
<blockquote>
<p><strong>Note:</strong> for the sake of simplicity, this introduction will assume you
have performed a <a href="pt-br/00-intro.html#locally">local</a> install of Composer.</p>
</blockquote>
<h2 id="composerjson-project-setup"><a class="header" href="#composerjson-project-setup"><code>composer.json</code>: Project setup</a></h2>
<p>To start using Composer in your project, all you need is a <code>composer.json</code>
file. This file describes the dependencies of your project and may contain
other metadata as well. It typically should go in the top-most directory of
your project/VCS repository. You can technically run Composer anywhere but
if you want to publish a package to Packagist.org, it will have to be able
to find the file at the top of your VCS repository.</p>
<h3 id="the-require-key"><a class="header" href="#the-require-key">The <code>require</code> key</a></h3>
<p>The first thing you specify in <code>composer.json</code> is the
<a href="pt-br/04-schema.html#require"><code>require</code></a> key. You are telling Composer which
packages your project depends on.</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;2.0.*&quot;
    }
}
</code></pre>
<p>As you can see, <a href="pt-br/04-schema.html#require"><code>require</code></a> takes an object that maps
<strong>package names</strong> (e.g. <code>monolog/monolog</code>) to <strong>version constraints</strong> (e.g.
<code>1.0.*</code>).</p>
<p>Composer uses this information to search for the right set of files in package
&quot;repositories&quot; that you register using the <a href="pt-br/04-schema.html#repositories"><code>repositories</code></a>
key, or in <a href="https://packagist.org">Packagist.org</a>, the default package repository.
In the above example, since no other repository has been registered in the
<code>composer.json</code> file, it is assumed that the <code>monolog/monolog</code> package is registered
on Packagist.org. (Read more <a href="pt-br/01-utilizacao-basica.html#packagist">about Packagist</a>, and
<a href="pt-br/05-repositories.html">about repositories</a>).</p>
<h3 id="package-names"><a class="header" href="#package-names">Package names</a></h3>
<p>The package name consists of a vendor name and the project's name. Often these
will be identical - the vendor name only exists to prevent naming clashes. For
example, it would allow two different people to create a library named <code>json</code>.
One might be named <code>igorw/json</code> while the other might be <code>seldaek/json</code>.</p>
<p>Read more about <a href="pt-br/02-libraries.html">publishing packages and package naming</a>.
(Note that you can also specify &quot;platform packages&quot; as dependencies, allowing
you to require certain versions of server software. See
<a href="pt-br/01-utilizacao-basica.html#platform-packages">platform packages</a> below.)</p>
<h3 id="package-version-constraints"><a class="header" href="#package-version-constraints">Package version constraints</a></h3>
<p>In our example, we are requesting the Monolog package with the version constraint
<a href="https://semver.mwl.be/#?package=monolog%2Fmonolog&amp;version=2.0.*"><code>2.0.*</code></a>.
This means any version in the <code>2.0</code> development branch, or any version that is
greater than or equal to 2.0 and less than 2.1 (<code>&gt;=2.0 &lt;2.1</code>).</p>
<p>Please read <a href="pt-br/articles/versions.html">versions</a> for more in-depth information on
versions, how versions relate to each other, and on version constraints.</p>
<blockquote>
<p><strong>How does Composer download the right files?</strong> When you specify a dependency in
<code>composer.json</code>, Composer first takes the name of the package that you have requested
and searches for it in any repositories that you have registered using the
<a href="pt-br/04-schema.html#repositories"><code>repositories</code></a> key. If you have not registered
any extra repositories, or it does not find a package with that name in the
repositories you have specified, it falls back to Packagist.org (more <a href="pt-br/01-utilizacao-basica.html#packagist">below</a>).</p>
<p>When Composer finds the right package, either in Packagist.org or in a repo you have specified,
it then uses the versioning features of the package's VCS (i.e., branches and tags)
to attempt to find the best match for the version constraint you have specified. Be sure to read
about versions and package resolution in the <a href="pt-br/articles/versions.html">versions article</a>.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> If you are trying to require a package but Composer throws an error
regarding package stability, the version you have specified may not meet your
default minimum stability requirements. By default, only stable releases are taken
into consideration when searching for valid package versions in your VCS.</p>
<p>You might run into this if you are trying to require dev, alpha, beta, or RC
versions of a package. Read more about stability flags and the <code>minimum-stability</code>
key on the <a href="pt-br/04-schema.html">schema page</a>.</p>
</blockquote>
<h2 id="installing-dependencies"><a class="header" href="#installing-dependencies">Installing dependencies</a></h2>
<p>To initially install the defined dependencies for your project, you should run the
<a href="pt-br/03-cli.html#update-u"><code>update</code></a> command.</p>
<pre><code class="language-sh">php composer.phar update
</code></pre>
<p>This will make Composer do two things:</p>
<ul>
<li>It resolves all dependencies listed in your <code>composer.json</code> file and writes all of the
packages and their exact versions to the <code>composer.lock</code> file, locking the project to
those specific versions. You should commit the <code>composer.lock</code> file to your project repo
so that all people working on the project are locked to the same versions of dependencies
(more below). This is the main role of the <code>update</code> command.</li>
<li>It then implicitly runs the <a href="pt-br/03-cli.html#install-i"><code>install</code></a> command. This will download
the dependencies' files into the <code>vendor</code> directory in your project. (The <code>vendor</code>
directory is the conventional location for all third-party code in a project). In our
example from above, you would end up with the Monolog source files in
<code>vendor/monolog/monolog/</code>. As Monolog has a dependency on <code>psr/log</code>, that package's files
can also be found inside <code>vendor/</code>.</li>
</ul>
<blockquote>
<p><strong>Tip:</strong> If you are using git for your project, you probably want to add
<code>vendor</code> in your <code>.gitignore</code>. You really don't want to add all of that
third-party code to your versioned repository.</p>
</blockquote>
<h3 id="commit-your-composerlock-file-to-version-control"><a class="header" href="#commit-your-composerlock-file-to-version-control">Commit your <code>composer.lock</code> file to version control</a></h3>
<p>Committing this file to version control is important because it will cause anyone
who sets up the project to use the exact same
versions of the dependencies that you are using. Your CI server, production
machines, other developers in your team, everything and everyone runs on the
same dependencies, which mitigates the potential for bugs affecting only some
parts of the deployments. Even if you develop alone, in six months when
reinstalling the project you can feel confident the dependencies installed are
still working even if your dependencies released many new versions since then.
(See note below about using the <code>update</code> command.)</p>
<blockquote>
<p><strong>Note:</strong> For libraries it is not necessary to commit the lock
file, see also: <a href="pt-br/02-libraries.html#lock-file">Libraries - Lock file</a>.</p>
</blockquote>
<h3 id="installing-from-composerlock"><a class="header" href="#installing-from-composerlock">Installing from <code>composer.lock</code></a></h3>
<p>If there is already a <code>composer.lock</code> file in the project folder, it means either
you ran the <code>update</code> command before, or someone else on the project ran the <code>update</code>
command and committed the <code>composer.lock</code> file to the project (which is good).</p>
<p>Either way, running <code>install</code> when a <code>composer.lock</code> file is present resolves and installs
all dependencies that you listed in <code>composer.json</code>, but Composer uses the exact versions listed
in <code>composer.lock</code> to ensure that the package versions are consistent for everyone
working on your project. As a result you will have all dependencies requested by your
<code>composer.json</code> file, but they may not all be at the very latest available versions
(some of the dependencies listed in the <code>composer.lock</code> file may have released newer versions since
the file was created). This is by design, it ensures that your project does not break because of
unexpected changes in dependencies.</p>
<p>So after fetching new changes from your VCS repository it is recommended to run
a Composer <code>install</code> to make sure the vendor directory is up in sync with your
<code>composer.lock</code> file.</p>
<pre><code class="language-sh">php composer.phar install
</code></pre>
<h2 id="updating-dependencies-to-their-latest-versions"><a class="header" href="#updating-dependencies-to-their-latest-versions">Updating dependencies to their latest versions</a></h2>
<p>As mentioned above, the <code>composer.lock</code> file prevents you from automatically getting
the latest versions of your dependencies. To update to the latest versions, use the
<a href="pt-br/03-cli.html#update-u"><code>update</code></a> command. This will fetch the latest matching
versions (according to your <code>composer.json</code> file) and update the lock file
with the new versions.</p>
<pre><code class="language-sh">php composer.phar update
</code></pre>
<blockquote>
<p><strong>Note:</strong> Composer will display a Warning when executing an <code>install</code> command
if the <code>composer.lock</code> has not been updated since changes were made to the
<code>composer.json</code> that might affect dependency resolution.</p>
</blockquote>
<p>If you only want to install, upgrade or remove one dependency, you can explicitly list it as an argument:</p>
<pre><code class="language-sh">php composer.phar update monolog/monolog [...]
</code></pre>
<h2 id="packagist"><a class="header" href="#packagist">Packagist</a></h2>
<p><a href="https://packagist.org/">Packagist.org</a> is the main Composer repository. A Composer
repository is basically a package source: a place where you can get packages
from. Packagist aims to be the central repository that everybody uses. This
means that you can automatically <code>require</code> any package that is available there,
without further specifying where Composer should look for the package.</p>
<p>If you go to the <a href="https://packagist.org/">Packagist.org website</a>,
you can browse and search for packages.</p>
<p>Any open source project using Composer is recommended to publish their packages
on Packagist. A library does not need to be on Packagist to be used by Composer,
but it enables discovery and adoption by other developers more quickly.</p>
<h2 id="platform-packages"><a class="header" href="#platform-packages">Platform packages</a></h2>
<p>Composer has platform packages, which are virtual packages for things that are
installed on the system but are not actually installable by Composer. This
includes PHP itself, PHP extensions and some system libraries.</p>
<ul>
<li>
<p><code>php</code> represents the PHP version of the user, allowing you to apply
constraints, e.g. <code>^7.1</code>. To require a 64bit version of php, you can
require the <code>php-64bit</code> package.</p>
</li>
<li>
<p><code>hhvm</code> represents the version of the HHVM runtime and allows you to apply
a constraint, e.g., <code>^2.3</code>.</p>
</li>
<li>
<p><code>ext-&lt;name&gt;</code> allows you to require PHP extensions (includes core
extensions). Versioning can be quite inconsistent here, so it's often
a good idea to set the constraint to <code>*</code>.  An example of an extension
package name is <code>ext-gd</code>.</p>
</li>
<li>
<p><code>lib-&lt;name&gt;</code> allows constraints to be made on versions of libraries used by
PHP. The following are available: <code>curl</code>, <code>iconv</code>, <code>icu</code>, <code>libxml</code>,
<code>openssl</code>, <code>pcre</code>, <code>uuid</code>, <code>xsl</code>.</p>
</li>
</ul>
<p>You can use <a href="pt-br/03-cli.html#show"><code>show --platform</code></a> to get a list of your locally
available platform packages.</p>
<h2 id="autoloading"><a class="header" href="#autoloading">Autoloading</a></h2>
<p>For libraries that specify autoload information, Composer generates a
<code>vendor/autoload.php</code> file. You can include this file and start
using the classes that those libraries provide without any extra work:</p>
<pre><code class="language-php">require __DIR__ . '/vendor/autoload.php';

$log = new Monolog\Logger('name');
$log-&gt;pushHandler(new Monolog\Handler\StreamHandler('app.log', Monolog\Logger::WARNING));
$log-&gt;warning('Foo');
</code></pre>
<p>You can even add your own code to the autoloader by adding an
<a href="pt-br/04-schema.html#autoload"><code>autoload</code></a> field to <code>composer.json</code>.</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-4&quot;: {&quot;Acme\\&quot;: &quot;src/&quot;}
    }
}
</code></pre>
<p>Composer will register a <a href="https://www.php-fig.org/psr/psr-4/">PSR-4</a> autoloader
for the <code>Acme</code> namespace.</p>
<p>You define a mapping from namespaces to directories. The <code>src</code> directory would
be in your project root, on the same level as the <code>vendor</code> directory. An example
filename would be <code>src/Foo.php</code> containing an <code>Acme\Foo</code> class.</p>
<p>After adding the <a href="pt-br/04-schema.html#autoload"><code>autoload</code></a> field, you have to re-run
this command:</p>
<pre><code class="language-sh">php composer.phar dump-autoload
</code></pre>
<p>This command will re-generate the <code>vendor/autoload.php</code> file.
See the <a href="pt-br/03-cli.html#dump-autoload-dumpautoload-"><code>dump-autoload</code></a> section for
more information.</p>
<p>Including that file will also return the autoloader instance, so you can store
the return value of the include call in a variable and add more namespaces.
This can be useful for autoloading classes in a test suite, for example.</p>
<pre><code class="language-php">$loader = require __DIR__ . '/vendor/autoload.php';
$loader-&gt;addPsr4('Acme\\Test\\', __DIR__);
</code></pre>
<p>In addition to PSR-4 autoloading, Composer also supports PSR-0, classmap and
files autoloading. See the <a href="pt-br/04-schema.html#autoload"><code>autoload</code></a> reference for
more information.</p>
<p>See also the docs on <a href="pt-br/articles/autoloader-optimization.html">optimizing the autoloader</a>.</p>
<blockquote>
<p><strong>Note:</strong> Composer provides its own autoloader. If you don't want to use that
one, you can include <code>vendor/composer/autoload_*.php</code> files, which return
associative arrays allowing you to configure your own autoloader.</p>
</blockquote>
<p>← <a href="pt-br/00-intro.html">Intro</a>  |  <a href="pt-br/02-libraries.html">Libraries</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="libraries"><a class="header" href="#libraries">Libraries</a></h1>
<p>This chapter will tell you how to make your library installable through
Composer.</p>
<h2 id="every-project-is-a-package"><a class="header" href="#every-project-is-a-package">Every project is a package</a></h2>
<p>As soon as you have a <code>composer.json</code> in a directory, that directory is a
package. When you add a <a href="pt-br/04-schema.html#require"><code>require</code></a> to a project, you are
making a package that depends on other packages. The only difference between
your project and a library is that your project is a package without a name.</p>
<p>In order to make that package installable you need to give it a name. You do
this by adding the <a href="pt-br/04-schema.html#name"><code>name</code></a> property in <code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/hello-world&quot;,
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*&quot;
    }
}
</code></pre>
<p>In this case the project name is <code>acme/hello-world</code>, where <code>acme</code> is the vendor
name. Supplying a vendor name is mandatory.</p>
<blockquote>
<p><strong>Note:</strong> If you don't know what to use as a vendor name, your GitHub
username is usually a good bet. Package names must be lowercase, and the
convention is to use dashes for word separation.</p>
</blockquote>
<h2 id="library-versioning"><a class="header" href="#library-versioning">Library Versioning</a></h2>
<p>In the vast majority of cases, you will be maintaining your library using some
sort of version control system like git, svn, hg or fossil. In these cases,
Composer infers versions from your VCS, and you <strong>should not</strong> specify a version
in your <code>composer.json</code> file. (See the <a href="pt-br/articles/versions.html">Versions article</a>
to learn about how Composer uses VCS branches and tags to resolve version
constraints.)</p>
<p>If you are maintaining packages by hand (i.e., without a VCS), you'll need to
specify the version explicitly by adding a <code>version</code> value in your <code>composer.json</code>
file:</p>
<pre><code class="language-json">{
    &quot;version&quot;: &quot;1.0.0&quot;
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> When you add a hardcoded version to a VCS, the version will conflict
with tag names. Composer will not be able to determine the version number.</p>
</blockquote>
<h3 id="vcs-versioning"><a class="header" href="#vcs-versioning">VCS Versioning</a></h3>
<p>Composer uses your VCS's branch and tag features to resolve the version
constraints you specify in your <a href="pt-br/04-schema.html#require"><code>require</code></a> field to specific sets of files.
When determining valid available versions, Composer looks at all of your tags
and branches and translates their names into an internal list of options that
it then matches against the version constraint you provided.</p>
<p>For more on how Composer treats tags and branches and how it resolves package
version constraints, read the <a href="pt-br/articles/versions.html">versions</a> article.</p>
<h2 id="lock-file"><a class="header" href="#lock-file">Lock file</a></h2>
<p>For your library you may commit the <code>composer.lock</code> file if you want to. This
can help your team to always test against the same dependency versions.
However, this lock file will not have any effect on other projects that depend
on it. It only has an effect on the main project.</p>
<p>If you do not want to commit the lock file, and you are using git, add it to
the <code>.gitignore</code>.</p>
<h2 id="publishing-to-a-vcs"><a class="header" href="#publishing-to-a-vcs">Publishing to a VCS</a></h2>
<p>Once you have a VCS repository (version control system, e.g. git) containing a
<code>composer.json</code> file, your library is already composer-installable. In this
example we will publish the <code>acme/hello-world</code> library on GitHub under
<code>github.com/username/hello-world</code>.</p>
<p>Now, to test installing the <code>acme/hello-world</code> package, we create a new
project locally. We will call it <code>acme/blog</code>. This blog will depend on
<code>acme/hello-world</code>, which in turn depends on <code>monolog/monolog</code>. We can
accomplish this by creating a new <code>blog</code> directory somewhere, containing a
<code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/blog&quot;,
    &quot;require&quot;: {
        &quot;acme/hello-world&quot;: &quot;dev-master&quot;
    }
}
</code></pre>
<p>The name is not needed in this case, since we don't want to publish the blog
as a library. It is added here to clarify which <code>composer.json</code> is being
described.</p>
<p>Now we need to tell the blog app where to find the <code>hello-world</code> dependency.
We do this by adding a package repository specification to the blog's
<code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/blog&quot;,
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;https://github.com/username/hello-world&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;acme/hello-world&quot;: &quot;dev-master&quot;
    }
}
</code></pre>
<p>For more details on how package repositories work and what other types are
available, see <a href="pt-br/05-repositories.html">Repositories</a>.</p>
<p>That's all. You can now install the dependencies by running Composer's
<a href="pt-br/03-cli.html#install"><code>install</code></a> command!</p>
<p><strong>Recap:</strong> Any git/svn/hg/fossil repository containing a <code>composer.json</code> can be
added to your project by specifying the package repository and declaring the
dependency in the <a href="pt-br/04-schema.html#require"><code>require</code></a> field.</p>
<h2 id="publishing-to-packagist"><a class="header" href="#publishing-to-packagist">Publishing to packagist</a></h2>
<p>Alright, so now you can publish packages. But specifying the VCS repository
every time is cumbersome. You don't want to force all your users to do that.</p>
<p>The other thing that you may have noticed is that we did not specify a package
repository for <code>monolog/monolog</code>. How did that work? The answer is Packagist.</p>
<p><a href="https://packagist.org/">Packagist</a> is the main package repository for
Composer, and it is enabled by default. Anything that is published on
Packagist is available automatically through Composer. Since
<a href="https://packagist.org/packages/monolog/monolog">Monolog is on Packagist</a>, we
can depend on it without having to specify any additional repositories.</p>
<p>If we wanted to share <code>hello-world</code> with the world, we would publish it on
Packagist as well.</p>
<p>You visit <a href="https://packagist.org">Packagist</a> and hit the &quot;Submit&quot;
button. This will prompt you to sign up if you haven't already, and then
allows you to submit the URL to your VCS repository, at which point Packagist
will start crawling it. Once it is done, your package will be available to
anyone!</p>
<p>← <a href="pt-br/01-basic-usage.html">Basic usage</a> |  <a href="pt-br/03-cli.html">Command-line interface</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-line-interface--commands"><a class="header" href="#command-line-interface--commands">Command-line interface / Commands</a></h1>
<p>You've already learned how to use the command-line interface to do some
things. This chapter documents all the available commands.</p>
<p>To get help from the command-line, call <code>composer</code> or <code>composer list</code>
to see the complete list of commands, then <code>--help</code> combined with any of those
can give you more information.</p>
<p>As Composer uses <a href="https://github.com/symfony/console">symfony/console</a> you can call commands by short name if it's not ambiguous.</p>
<pre><code class="language-sh">php composer.phar dump
</code></pre>
<p>calls <code>composer dump-autoload</code>.</p>
<h2 id="global-options"><a class="header" href="#global-options">Global Options</a></h2>
<p>The following options are available with every command:</p>
<ul>
<li><strong>--verbose (-v):</strong> Increase verbosity of messages.</li>
<li><strong>--help (-h):</strong> Display help information.</li>
<li><strong>--quiet (-q):</strong> Do not output any message.</li>
<li><strong>--no-interaction (-n):</strong> Do not ask any interactive question.</li>
<li><strong>--no-plugins:</strong> Disables plugins.</li>
<li><strong>--no-scripts:</strong> Skips execution of scripts defined in <code>composer.json</code>.</li>
<li><strong>--no-cache:</strong> Disables the use of the cache directory. Same as setting the COMPOSER_CACHE_DIR
env var to /dev/null (or NUL on Windows).</li>
<li><strong>--working-dir (-d):</strong> If specified, use the given directory as working directory.</li>
<li><strong>--profile:</strong> Display timing and memory usage information</li>
<li><strong>--ansi:</strong> Force ANSI output.</li>
<li><strong>--no-ansi:</strong> Disable ANSI output.</li>
<li><strong>--version (-V):</strong> Display this application version.</li>
</ul>
<h2 id="process-exit-codes"><a class="header" href="#process-exit-codes">Process Exit Codes</a></h2>
<ul>
<li><strong>0:</strong> OK</li>
<li><strong>1:</strong> Generic/unknown error code</li>
<li><strong>2:</strong> Dependency solving error code</li>
</ul>
<h2 id="init"><a class="header" href="#init">init</a></h2>
<p>In the <a href="pt-br/02-libraries.html">Libraries</a> chapter we looked at how to create a
<code>composer.json</code> by hand. There is also an <code>init</code> command available to do this.</p>
<p>When you run the command it will interactively ask you to fill in the fields,
while using some smart defaults.</p>
<pre><code class="language-sh">php composer.phar init
</code></pre>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<ul>
<li><strong>--name:</strong> Name of the package.</li>
<li><strong>--description:</strong> Description of the package.</li>
<li><strong>--author:</strong> Author name of the package.</li>
<li><strong>--type:</strong> Type of package.</li>
<li><strong>--homepage:</strong> Homepage of the package.</li>
<li><strong>--require:</strong> Package to require with a version constraint. Should be
in format <code>foo/bar:1.0.0</code>.</li>
<li><strong>--require-dev:</strong> Development requirements, see <strong>--require</strong>.</li>
<li><strong>--stability (-s):</strong> Value for the <code>minimum-stability</code> field.</li>
<li><strong>--license (-l):</strong> License of package.</li>
<li><strong>--repository:</strong> Provide one (or more) custom repositories. They will be stored
in the generated composer.json, and used for auto-completion when prompting for
the list of requires. Every repository can be either an HTTP URL pointing
to a <code>composer</code> repository or a JSON string which similar to what the
<a href="pt-br/04-schema.html#repositories">repositories</a> key accepts.</li>
<li><strong>--autoload (-a):</strong> Add a PSR-4 autoload mapping to the composer.json. Automatically maps your package's namespace to the provided directory. (Expects a relative path, e.g. src/) See also <a href="pt-br/04-schema.html#psr-4">PSR-4 autoload</a>.</li>
</ul>
<h2 id="install--i"><a class="header" href="#install--i">install / i</a></h2>
<p>The <code>install</code> command reads the <code>composer.json</code> file from the current
directory, resolves the dependencies, and installs them into <code>vendor</code>.</p>
<pre><code class="language-sh">php composer.phar install
</code></pre>
<p>If there is a <code>composer.lock</code> file in the current directory, it will use the
exact versions from there instead of resolving them. This ensures that
everyone using the library will get the same versions of the dependencies.</p>
<p>If there is no <code>composer.lock</code> file, Composer will create one after dependency
resolution.</p>
<h3 id="options-1"><a class="header" href="#options-1">Options</a></h3>
<ul>
<li><strong>--prefer-install:</strong> There are two ways of downloading a package: <code>source</code>
and <code>dist</code>. Composer uses <code>dist</code> by default. If you pass
<code>--prefer-install=source</code> (or <code>--prefer-source</code>) Composer will install from
<code>source</code> if there is one. This is useful if you want to make a bugfix to a
project and get a local git clone of the dependency directly.
To get the legacy behavior where Composer use <code>source</code> automatically for dev
versions of packages, use <code>--prefer-install=auto</code>. See also <a href="pt-br/06-config.html#preferred-install">config.preferred-install</a>.
Passing this flag will override the config value.</li>
<li><strong>--dry-run:</strong> If you want to run through an installation without actually
installing a package, you can use <code>--dry-run</code>. This will simulate the
installation and show you what would happen.</li>
<li><strong>--dev:</strong> Install packages listed in <code>require-dev</code> (this is the default behavior).</li>
<li><strong>--no-dev:</strong> Skip installing packages listed in <code>require-dev</code>. The autoloader
generation skips the <code>autoload-dev</code> rules.</li>
<li><strong>--no-autoloader:</strong> Skips autoloader generation.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--optimize-autoloader (-o):</strong> Convert PSR-0/4 autoloading to classmap to get a faster
autoloader. This is recommended especially for production, but can take
a bit of time to run so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize-autoloader</code>.</li>
<li><strong>--apcu-autoloader:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-autoloader-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu-autoloader</code>.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard. Appending
a <code>+</code> makes it only ignore the upper-bound of the requirements. For example, if a package
requires <code>php: ^7</code>, then the option <code>--ignore-platform-req=php+</code> would allow installing on PHP 8,
but installation on PHP 5.6 would still fail.</li>
</ul>
<h2 id="update--u"><a class="header" href="#update--u">update / u</a></h2>
<p>In order to get the latest versions of the dependencies and to update the
<code>composer.lock</code> file, you should use the <code>update</code> command. This command is also
aliased as <code>upgrade</code> as it does the same as <code>upgrade</code> does if you are thinking
of <code>apt-get</code> or similar package managers.</p>
<pre><code class="language-sh">php composer.phar update
</code></pre>
<p>This will resolve all dependencies of the project and write the exact versions
into <code>composer.lock</code>.</p>
<p>If you only want to update a few packages and not all, you can list them as such:</p>
<pre><code class="language-sh">php composer.phar update vendor/package vendor/package2
</code></pre>
<p>You can also use wildcards to update a bunch of packages at once:</p>
<pre><code class="language-sh">php composer.phar update &quot;vendor/*&quot;
</code></pre>
<p>If you want to downgrade a package to a specific version without changing your
composer.json you can use <code>--with</code> and provide a custom version constraint:</p>
<pre><code class="language-sh">php composer.phar update --with vendor/package:2.0.1
</code></pre>
<p>Note that with the above all packages will be updated. If you only want to
update the package(s) for which you provide custom constraints using <code>--with</code>,
you can skip <code>--with</code> and instead use constraints with the partial update syntax:</p>
<pre><code class="language-sh">php composer.phar update vendor/package:2.0.1 vendor/package2:3.0.*
</code></pre>
<p>The custom constraint has to be a subset of the existing constraint you have,
and this feature is only available for your root package dependencies.</p>
<h3 id="options-2"><a class="header" href="#options-2">Options</a></h3>
<ul>
<li><strong>--prefer-install:</strong> There are two ways of downloading a package: <code>source</code>
and <code>dist</code>. Composer uses <code>dist</code> by default. If you pass
<code>--prefer-install=source</code> (or <code>--prefer-source</code>) Composer will install from
<code>source</code> if there is one. This is useful if you want to make a bugfix to a
project and get a local git clone of the dependency directly.
To get the legacy behavior where Composer use <code>source</code> automatically for dev
versions of packages, use <code>--prefer-install=auto</code>. See also <a href="pt-br/06-config.html#preferred-install">config.preferred-install</a>.
Passing this flag will override the config value.</li>
<li><strong>--dry-run:</strong> Simulate the command without actually doing anything.</li>
<li><strong>--dev:</strong> Install packages listed in <code>require-dev</code> (this is the default behavior).</li>
<li><strong>--no-dev:</strong> Skip installing packages listed in <code>require-dev</code>. The autoloader generation skips the <code>autoload-dev</code> rules.</li>
<li><strong>--no-install:</strong> Does not run the install step after updating the composer.lock file.</li>
<li><strong>--lock:</strong> Only updates the lock file hash to suppress warning about the
lock file being out of date.</li>
<li><strong>--with:</strong> Temporary version constraint to add, e.g. foo/bar:1.0.0 or foo/bar=1.0.0</li>
<li><strong>--no-autoloader:</strong> Skips autoloader generation.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--with-dependencies (-w):</strong> Update also dependencies of packages in the argument list, except those which are root requirements.</li>
<li><strong>--with-all-dependencies (-W):</strong> Update also dependencies of packages in the argument list, including those which are root requirements.</li>
<li><strong>--optimize-autoloader (-o):</strong> Convert PSR-0/4 autoloading to classmap to get a faster
autoloader. This is recommended especially for production, but can take
a bit of time to run, so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize-autoloader</code>.</li>
<li><strong>--apcu-autoloader:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-autoloader-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu-autoloader</code>.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard. Appending
a <code>+</code> makes it only ignore the upper-bound of the requirements. For example, if a package
requires <code>php: ^7</code>, then the option <code>--ignore-platform-req=php+</code> would allow installing on PHP 8,
but installation on PHP 5.6 would still fail.</li>
<li><strong>--prefer-stable:</strong> Prefer stable versions of dependencies.</li>
<li><strong>--prefer-lowest:</strong> Prefer lowest versions of dependencies. Useful for testing minimal
versions of requirements, generally used with <code>--prefer-stable</code>.</li>
<li><strong>--interactive:</strong> Interactive interface with autocompletion to select the packages to update.</li>
<li><strong>--root-reqs:</strong> Restricts the update to your first degree dependencies.</li>
</ul>
<p>Specifying one of the words <code>mirrors</code>, <code>lock</code>, or <code>nothing</code> as an argument has the same effect as specifying the option <code>--lock</code>, for example <code>composer update mirrors</code> is exactly the same as <code>composer update --lock</code>.</p>
<h2 id="require"><a class="header" href="#require">require</a></h2>
<p>The <code>require</code> command adds new packages to the <code>composer.json</code> file from
the current directory. If no file exists one will be created on the fly.</p>
<pre><code class="language-sh">php composer.phar require
</code></pre>
<p>After adding/changing the requirements, the modified requirements will be
installed or updated.</p>
<p>If you do not want to choose requirements interactively, you can pass them
to the command.</p>
<pre><code class="language-sh">php composer.phar require &quot;vendor/package:2.*&quot; vendor/package2:dev-master
</code></pre>
<p>If you do not specify a package, Composer will prompt you to search for a package, and given results, provide a list of  matches to require.</p>
<h3 id="options-3"><a class="header" href="#options-3">Options</a></h3>
<ul>
<li><strong>--dev:</strong> Add packages to <code>require-dev</code>.</li>
<li><strong>--dry-run:</strong> Simulate the command without actually doing anything.</li>
<li><strong>--prefer-install:</strong> There are two ways of downloading a package: <code>source</code>
and <code>dist</code>. Composer uses <code>dist</code> by default. If you pass
<code>--prefer-install=source</code> (or <code>--prefer-source</code>) Composer will install from
<code>source</code> if there is one. This is useful if you want to make a bugfix to a
project and get a local git clone of the dependency directly.
To get the legacy behavior where Composer use <code>source</code> automatically for dev
versions of packages, use <code>--prefer-install=auto</code>. See also <a href="pt-br/06-config.html#preferred-install">config.preferred-install</a>.
Passing this flag will override the config value.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--no-update:</strong> Disables the automatic update of the dependencies (implies --no-install).</li>
<li><strong>--no-install:</strong> Does not run the install step after updating the composer.lock file.</li>
<li><strong>--update-no-dev:</strong> Run the dependency update with the <code>--no-dev</code> option.</li>
<li><strong>--update-with-dependencies (-w):</strong> Also update dependencies of the newly required packages, except those that are root requirements.</li>
<li><strong>--update-with-all-dependencies (-W):</strong> Also update dependencies of the newly required packages, including those that are root requirements.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard.</li>
<li><strong>--prefer-stable:</strong> Prefer stable versions of dependencies.</li>
<li><strong>--prefer-lowest:</strong> Prefer lowest versions of dependencies. Useful for testing minimal
versions of requirements, generally used with <code>--prefer-stable</code>.</li>
<li><strong>--sort-packages:</strong> Keep packages sorted in <code>composer.json</code>.</li>
<li><strong>--optimize-autoloader (-o):</strong> Convert PSR-0/4 autoloading to classmap to
get a faster autoloader. This is recommended especially for production, but
can take a bit of time to run, so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize-autoloader</code>.</li>
<li><strong>--apcu-autoloader:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-autoloader-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu-autoloader</code>.</li>
</ul>
<h2 id="remove"><a class="header" href="#remove">remove</a></h2>
<p>The <code>remove</code> command removes packages from the <code>composer.json</code> file from
the current directory.</p>
<pre><code class="language-sh">php composer.phar remove vendor/package vendor/package2
</code></pre>
<p>After removing the requirements, the modified requirements will be
uninstalled.</p>
<h3 id="options-4"><a class="header" href="#options-4">Options</a></h3>
<ul>
<li><strong>--dev:</strong> Remove packages from <code>require-dev</code>.</li>
<li><strong>--dry-run:</strong> Simulate the command without actually doing anything.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--no-update:</strong> Disables the automatic update of the dependencies (implies --no-install).</li>
<li><strong>--no-install:</strong> Does not run the install step after updating the composer.lock file.</li>
<li><strong>--update-no-dev:</strong> Run the dependency update with the --no-dev option.</li>
<li><strong>--update-with-dependencies (-w):</strong> Also update dependencies of the removed packages.
(Deprecated, is now default behavior)</li>
<li><strong>--update-with-all-dependencies (-W):</strong> Allows all inherited dependencies to be updated,
including those that are root requirements.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard.</li>
<li><strong>--optimize-autoloader (-o):</strong> Convert PSR-0/4 autoloading to classmap to
get a faster autoloader. This is recommended especially for production, but
can take a bit of time to run so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize-autoloader</code>.</li>
<li><strong>--apcu-autoloader:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-autoloader-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu-autoloader</code>.</li>
</ul>
<h2 id="reinstall"><a class="header" href="#reinstall">reinstall</a></h2>
<p>The <code>reinstall</code> command looks up installed packages by name,
uninstalls them and reinstalls them. This lets you do a clean install
of a package if you messed with its files, or if you wish to change
the installation type using --prefer-install.</p>
<pre><code class="language-sh">php composer.phar reinstall acme/foo acme/bar
</code></pre>
<p>You can specify more than one package name to reinstall, or use a
wildcard to select several packages at once:</p>
<pre><code class="language-sh">php composer.phar reinstall &quot;acme/*&quot;
</code></pre>
<h3 id="options-5"><a class="header" href="#options-5">Options</a></h3>
<ul>
<li><strong>--prefer-install:</strong> There are two ways of downloading a package: <code>source</code>
and <code>dist</code>. Composer uses <code>dist</code> by default. If you pass
<code>--prefer-install=source</code> (or <code>--prefer-source</code>) Composer will install from
<code>source</code> if there is one. This is useful if you want to make a bugfix to a
project and get a local git clone of the dependency directly.
To get the legacy behavior where Composer use <code>source</code> automatically for dev
versions of packages, use <code>--prefer-install=auto</code>. See also <a href="pt-br/06-config.html#preferred-install">config.preferred-install</a>.
Passing this flag will override the config value.</li>
<li><strong>--no-autoloader:</strong> Skips autoloader generation.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--optimize-autoloader (-o):</strong> Convert PSR-0/4 autoloading to classmap to get a faster
autoloader. This is recommended especially for production, but can take
a bit of time to run so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize-autoloader</code>.</li>
<li><strong>--apcu-autoloader:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-autoloader-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu-autoloader</code>.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements. This only
has an effect in the context of the autoloader generation for the
reinstall command.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement. This only
has an effect in the context of the autoloader generation for the
reinstall command.  Multiple requirements can be ignored via wildcard.</li>
</ul>
<h2 id="check-platform-reqs"><a class="header" href="#check-platform-reqs">check-platform-reqs</a></h2>
<p>The check-platform-reqs command checks that your PHP and extensions versions
match the platform requirements of the installed packages. This can be used
to verify that a production server has all the extensions needed to run a
project after installing it for example.</p>
<p>Unlike update/install, this command will ignore config.platform settings and
check the real platform packages so you can be certain you have the required
platform dependencies.</p>
<h2 id="global-1"><a class="header" href="#global-1">global</a></h2>
<p>The global command allows you to run other commands like <code>install</code>, <code>remove</code>, <code>require</code>
or <code>update</code> as if you were running them from the <a href="pt-br/03-linha-de-comando.html#composer-home">COMPOSER_HOME</a>
directory.</p>
<p>This is merely a helper to manage a project stored in a central location that
can hold CLI tools or Composer plugins that you want to have available everywhere.</p>
<p>This can be used to install CLI utilities globally. Here is an example:</p>
<pre><code class="language-sh">php composer.phar global require friendsofphp/php-cs-fixer
</code></pre>
<p>Now the <code>php-cs-fixer</code> binary is available globally. Make sure your global
<a href="pt-br/articles/vendor-binaries.html">vendor binaries</a> directory is in your <code>$PATH</code>
environment variable, you can get its location with the following command :</p>
<pre><code class="language-sh">php composer.phar global config bin-dir --absolute
</code></pre>
<p>If you wish to update the binary later on you can run a global update:</p>
<pre><code class="language-sh">php composer.phar global update
</code></pre>
<h2 id="search"><a class="header" href="#search">search</a></h2>
<p>The search command allows you to search through the current project's package
repositories. Usually this will be packagist. You pass it the terms you want
to search for.</p>
<pre><code class="language-sh">php composer.phar search monolog
</code></pre>
<p>You can also search for more than one term by passing multiple arguments.</p>
<h3 id="options-6"><a class="header" href="#options-6">Options</a></h3>
<ul>
<li><strong>--only-name (-N):</strong> Search only in package names.</li>
<li><strong>--only-vendor (-O):</strong> Search only for vendor / organization names, returns only &quot;vendor&quot;
as a result.</li>
<li><strong>--type (-t):</strong> Search for a specific package type.</li>
<li><strong>--format (-f):</strong> Lets you pick between text (default) or json output format.
Note that in the json, only the name and description keys are guaranteed to be
present. The rest (<code>url</code>, <code>repository</code>, <code>downloads</code> and <code>favers</code>) are available
for Packagist.org search results and other repositories may return more or less
data.</li>
</ul>
<h2 id="show"><a class="header" href="#show">show</a></h2>
<p>To list all of the available packages, you can use the <code>show</code> command.</p>
<pre><code class="language-sh">php composer.phar show
</code></pre>
<p>To filter the list you can pass a package mask using wildcards.</p>
<pre><code class="language-sh">php composer.phar show monolog/*

monolog/monolog 1.19.0 Sends your logs to files, sockets, inboxes, databases and various web services
</code></pre>
<p>If you want to see the details of a certain package, you can pass the package
name.</p>
<pre><code class="language-sh">php composer.phar show monolog/monolog

name     : monolog/monolog
versions : master-dev, 1.0.2, 1.0.1, 1.0.0, 1.0.0-RC1
type     : library
names    : monolog/monolog
source   : [git] https://github.com/Seldaek/monolog.git 3d4e60d0cbc4b888fe5ad223d77964428b1978da
dist     : [zip] https://github.com/Seldaek/monolog/zipball/3d4e60d0cbc4b888fe5ad223d77964428b1978da 3d4e60d0cbc4b888fe5ad223d77964428b1978da
license  : MIT

autoload
psr-0
Monolog : src/

requires
php &gt;=5.3.0
</code></pre>
<p>You can even pass the package version, which will tell you the details of that
specific version.</p>
<pre><code class="language-sh">php composer.phar show monolog/monolog 1.0.2
</code></pre>
<h3 id="options-7"><a class="header" href="#options-7">Options</a></h3>
<ul>
<li><strong>--all :</strong> List all packages available in all your repositories.</li>
<li><strong>--installed (-i):</strong> List the packages that are installed (this is enabled by default, and deprecated).</li>
<li><strong>--locked:</strong> List the locked packages from composer.lock.</li>
<li><strong>--platform (-p):</strong> List only platform packages (php &amp; extensions).</li>
<li><strong>--available (-a):</strong> List available packages only.</li>
<li><strong>--self (-s):</strong> List the root package info.</li>
<li><strong>--name-only (-N):</strong> List package names only.</li>
<li><strong>--path (-P):</strong> List package paths.</li>
<li><strong>--tree (-t):</strong> List your dependencies as a tree. If you pass a package name it will show the dependency tree for that package.</li>
<li><strong>--latest (-l):</strong> List all installed packages including their latest version.</li>
<li><strong>--outdated (-o):</strong> Implies --latest, but this lists <em>only</em> packages that have a newer version available.</li>
<li><strong>--no-dev:</strong> Filters dev dependencies from the package list.</li>
<li><strong>--minor-only (-m):</strong> Use with --latest. Only shows packages that have minor SemVer-compatible updates.</li>
<li><strong>--direct (-D):</strong> Restricts the list of packages to your direct dependencies.</li>
<li><strong>--strict:</strong> Return a non-zero exit code when there are outdated packages.</li>
<li><strong>--format (-f):</strong> Lets you pick between text (default) or json output format.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these. Use with the --outdated option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard. Use with
the --outdated option.</li>
</ul>
<h2 id="outdated"><a class="header" href="#outdated">outdated</a></h2>
<p>The <code>outdated</code> command shows a list of installed packages that have updates available,
including their current and latest versions. This is basically an alias for
<code>composer show -lo</code>.</p>
<p>The color coding is as such:</p>
<ul>
<li><strong>green (=)</strong>: Dependency is in the latest version and is up to date.</li>
<li><strong>yellow (<code>~</code>)</strong>: Dependency has a new version available that includes backwards compatibility breaks according to semver, so upgrade when
you can but it may involve work.</li>
<li><strong>red (!)</strong>: Dependency has a new version that is semver-compatible and you should upgrade it.</li>
</ul>
<h3 id="options-8"><a class="header" href="#options-8">Options</a></h3>
<ul>
<li><strong>--all (-a):</strong> Show all packages, not just outdated (alias for <code>composer show -l</code>).</li>
<li><strong>--direct (-D):</strong> Restricts the list of packages to your direct dependencies.</li>
<li><strong>--strict:</strong> Returns non-zero exit code if any package is outdated.</li>
<li><strong>--minor-only (-m):</strong> Only shows packages that have minor SemVer-compatible updates.</li>
<li><strong>--format (-f):</strong> Lets you pick between text (default) or json output format.</li>
<li><strong>--no-dev:</strong> Do not show outdated dev dependencies.</li>
<li><strong>--locked:</strong> Shows updates for packages from the lock file, regardless of what is currently in vendor dir.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard.</li>
</ul>
<h2 id="browse--home"><a class="header" href="#browse--home">browse / home</a></h2>
<p>The <code>browse</code> (aliased to <code>home</code>) opens a package's repository URL or homepage
in your browser.</p>
<h3 id="options-9"><a class="header" href="#options-9">Options</a></h3>
<ul>
<li><strong>--homepage (-H):</strong> Open the homepage instead of the repository URL.</li>
<li><strong>--show (-s):</strong> Only show the homepage or repository URL.</li>
</ul>
<h2 id="suggests"><a class="header" href="#suggests">suggests</a></h2>
<p>Lists all packages suggested by the currently installed set of packages. You can
optionally pass one or multiple package names in the format of <code>vendor/package</code>
to limit output to suggestions made by those packages only.</p>
<p>Use the <code>--by-package</code> (default) or <code>--by-suggestion</code> flags to group the output by
the package offering the suggestions or the suggested packages respectively.</p>
<p>If you only want a list of suggested package names, use <code>--list</code>.</p>
<h3 id="options-10"><a class="header" href="#options-10">Options</a></h3>
<ul>
<li><strong>--by-package:</strong> Groups output by suggesting package (default).</li>
<li><strong>--by-suggestion:</strong> Groups output by suggested package.</li>
<li><strong>--all:</strong> Show suggestions from all dependencies, including transitive ones (by
default only direct dependencies' suggestions are shown).</li>
<li><strong>--list:</strong> Show only list of suggested package names.</li>
<li><strong>--no-dev:</strong> Excludes suggestions from <code>require-dev</code> packages.</li>
</ul>
<h2 id="fund"><a class="header" href="#fund">fund</a></h2>
<p>Discover how to help fund the maintenance of your dependencies. This lists
all funding links from the installed dependencies. Use <code>--format=json</code> to
get machine-readable output.</p>
<h3 id="options-11"><a class="header" href="#options-11">Options</a></h3>
<ul>
<li><strong>--format (-f):</strong> Lets you pick between text (default) or json output format.</li>
</ul>
<h2 id="depends-why"><a class="header" href="#depends-why">depends (why)</a></h2>
<p>The <code>depends</code> command tells you which other packages depend on a certain
package. As with installation <code>require-dev</code> relationships are only considered
for the root package.</p>
<pre><code class="language-sh">php composer.phar depends doctrine/lexer
 doctrine/annotations v1.2.7 requires doctrine/lexer (1.*)
 doctrine/common      v2.6.1 requires doctrine/lexer (1.*)
</code></pre>
<p>You can optionally specify a version constraint after the package to limit the
search.</p>
<p>Add the <code>--tree</code> or <code>-t</code> flag to show a recursive tree of why the package is
depended upon, for example:</p>
<pre><code class="language-sh">php composer.phar depends psr/log -t
psr/log 1.0.0 Common interface for logging libraries
|- aboutyou/app-sdk 2.6.11 (requires psr/log 1.0.*)
|  `- __root__ (requires aboutyou/app-sdk ^2.6)
|- monolog/monolog 1.17.2 (requires psr/log ~1.0)
|  `- laravel/framework v5.2.16 (requires monolog/monolog ~1.11)
|     `- __root__ (requires laravel/framework ^5.2)
`- symfony/symfony v3.0.2 (requires psr/log ~1.0)
   `- __root__ (requires symfony/symfony ^3.0)
</code></pre>
<h3 id="options-12"><a class="header" href="#options-12">Options</a></h3>
<ul>
<li><strong>--recursive (-r):</strong> Recursively resolves up to the root package.</li>
<li><strong>--tree (-t):</strong> Prints the results as a nested tree, implies -r.</li>
</ul>
<h2 id="prohibits-why-not"><a class="header" href="#prohibits-why-not">prohibits (why-not)</a></h2>
<p>The <code>prohibits</code> command tells you which packages are blocking a given package
from being installed. Specify a version constraint to verify whether upgrades
can be performed in your project, and if not why not. See the following
example:</p>
<pre><code class="language-sh">php composer.phar prohibits symfony/symfony 3.1
 laravel/framework v5.2.16 requires symfony/var-dumper (2.8.*|3.0.*)
</code></pre>
<p>Note that you can also specify platform requirements, for example to check
whether you can upgrade your server to PHP 8.0:</p>
<pre><code class="language-sh">php composer.phar prohibits php:8
 doctrine/cache        v1.6.0 requires php (~5.5|~7.0)
 doctrine/common       v2.6.1 requires php (~5.5|~7.0)
 doctrine/instantiator 1.0.5  requires php (&gt;=5.3,&lt;8.0-DEV)
</code></pre>
<p>As with <code>depends</code> you can request a recursive lookup, which will list all
packages depending on the packages that cause the conflict.</p>
<h3 id="options-13"><a class="header" href="#options-13">Options</a></h3>
<ul>
<li><strong>--recursive (-r):</strong> Recursively resolves up to the root package.</li>
<li><strong>--tree (-t):</strong> Prints the results as a nested tree, implies -r.</li>
</ul>
<h2 id="validate"><a class="header" href="#validate">validate</a></h2>
<p>You should always run the <code>validate</code> command before you commit your
<code>composer.json</code> file, and before you tag a release. It will check if your
<code>composer.json</code> is valid.</p>
<pre><code class="language-sh">php composer.phar validate
</code></pre>
<h3 id="options-14"><a class="header" href="#options-14">Options</a></h3>
<ul>
<li><strong>--no-check-all:</strong> Do not emit a warning if requirements in <code>composer.json</code> use unbound or overly strict version constraints.</li>
<li><strong>--no-check-lock:</strong> Do not emit an error if <code>composer.lock</code> exists and is not up to date.</li>
<li><strong>--no-check-publish:</strong> Do not emit an error if <code>composer.json</code> is unsuitable for publishing as a package on Packagist but is otherwise valid.</li>
<li><strong>--with-dependencies:</strong> Also validate the composer.json of all installed dependencies.</li>
<li><strong>--strict:</strong> Return a non-zero exit code for warnings as well as errors.</li>
</ul>
<h2 id="status"><a class="header" href="#status">status</a></h2>
<p>If you often need to modify the code of your dependencies and they are
installed from source, the <code>status</code> command allows you to check if you have
local changes in any of them.</p>
<pre><code class="language-sh">php composer.phar status
</code></pre>
<p>With the <code>--verbose</code> option you get some more information about what was
changed:</p>
<pre><code class="language-sh">php composer.phar status -v

You have changes in the following dependencies:
vendor/seld/jsonlint:
    M README.mdown
</code></pre>
<h2 id="self-update-selfupdate"><a class="header" href="#self-update-selfupdate">self-update (selfupdate)</a></h2>
<p>To update Composer itself to the latest version, run the <code>self-update</code>
command. It will replace your <code>composer.phar</code> with the latest version.</p>
<pre><code class="language-sh">php composer.phar self-update
</code></pre>
<p>If you would like to instead update to a specific release specify it:</p>
<pre><code class="language-sh">php composer.phar self-update 1.0.0-alpha7
</code></pre>
<p>If you have installed Composer for your entire system (see <a href="pt-br/00-intro.html#globally">global installation</a>),
you may have to run the command with <code>root</code> privileges</p>
<pre><code class="language-sh">sudo -H composer self-update
</code></pre>
<p>If Composer was not installed as a PHAR, this command is not available.
(This is sometimes the case when Composer was installed by an operating system package manager.)</p>
<h3 id="options-15"><a class="header" href="#options-15">Options</a></h3>
<ul>
<li><strong>--rollback (-r):</strong> Rollback to the last version you had installed.</li>
<li><strong>--clean-backups:</strong> Delete old backups during an update. This makes the
current version of Composer the only backup available after the update.</li>
<li><strong>--no-progress:</strong> Do not output download progress.</li>
<li><strong>--update-keys:</strong> Prompt user for a key update.</li>
<li><strong>--stable:</strong> Force an update to the stable channel.</li>
<li><strong>--preview:</strong> Force an update to the preview channel.</li>
<li><strong>--snapshot:</strong> Force an update to the snapshot channel.</li>
<li><strong>--1:</strong> Force an update to the stable channel, but only use 1.x versions</li>
<li><strong>--2:</strong> Force an update to the stable channel, but only use 2.x versions</li>
<li><strong>--set-channel-only:</strong> Only store the channel as the default one and then exit</li>
</ul>
<h2 id="config"><a class="header" href="#config">config</a></h2>
<p>The <code>config</code> command allows you to edit Composer config settings and repositories
in either the local <code>composer.json</code> file or the global <code>config.json</code> file.</p>
<p>Additionally it lets you edit most properties in the local <code>composer.json</code>.</p>
<pre><code class="language-sh">php composer.phar config --list
</code></pre>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<p><code>config [options] [setting-key] [setting-value1] ... [setting-valueN]</code></p>
<p><code>setting-key</code> is a configuration option name and <code>setting-value1</code> is a
configuration value.  For settings that can take an array of values (like
<code>github-protocols</code>), multiple setting-value arguments are allowed.</p>
<p>You can also edit the values of the following properties:</p>
<p><code>description</code>, <code>homepage</code>, <code>keywords</code>, <code>license</code>, <code>minimum-stability</code>,
<code>name</code>, <code>prefer-stable</code>, <code>type</code> and <code>version</code>.</p>
<p>See the <a href="pt-br/06-config.html">Config</a> chapter for valid configuration options.</p>
<h3 id="options-16"><a class="header" href="#options-16">Options</a></h3>
<ul>
<li><strong>--global (-g):</strong> Operate on the global config file located at
<code>$COMPOSER_HOME/config.json</code> by default.  Without this option, this command
affects the local composer.json file or a file specified by <code>--file</code>.</li>
<li><strong>--editor (-e):</strong> Open the local composer.json file using in a text editor as
defined by the <code>EDITOR</code> env variable.  With the <code>--global</code> option, this opens
the global config file.</li>
<li><strong>--auth (-a):</strong> Affect auth config file (only used for --editor).</li>
<li><strong>--unset:</strong> Remove the configuration element named by <code>setting-key</code>.</li>
<li><strong>--list (-l):</strong> Show the list of current config variables.  With the <code>--global</code>
option this lists the global configuration only.</li>
<li><strong>--file=&quot;...&quot; (-f):</strong> Operate on a specific file instead of composer.json. Note
that this cannot be used in conjunction with the <code>--global</code> option.</li>
<li><strong>--absolute:</strong> Returns absolute paths when fetching <code>*-dir</code> config values
instead of relative.</li>
<li><strong>--json:</strong> JSON decode the setting value, to be used with <code>extra.*</code> keys.</li>
<li><strong>--merge:</strong> Merge the setting value with the current value, to be used with <code>extra.*</code> keys in combination with <code>--json</code>.</li>
<li><strong>--append:</strong> When adding a repository, append it (lowest priority) to the existing ones instead of prepending it (highest priority).</li>
<li><strong>--source:</strong> Display where the config value is loaded from.</li>
</ul>
<h3 id="modifying-repositories"><a class="header" href="#modifying-repositories">Modifying Repositories</a></h3>
<p>In addition to modifying the config section, the <code>config</code> command also supports making
changes to the repositories section by using it the following way:</p>
<pre><code class="language-sh">php composer.phar config repositories.foo vcs https://github.com/foo/bar
</code></pre>
<p>If your repository requires more configuration options, you can instead pass its JSON representation :</p>
<pre><code class="language-sh">php composer.phar config repositories.foo '{&quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;http://svn.example.org/my-project/&quot;, &quot;trunk-path&quot;: &quot;master&quot;}'
</code></pre>
<h3 id="modifying-extra-values"><a class="header" href="#modifying-extra-values">Modifying Extra Values</a></h3>
<p>In addition to modifying the config section, the <code>config</code> command also supports making
changes to the extra section by using it the following way:</p>
<pre><code class="language-sh">php composer.phar config extra.foo.bar value
</code></pre>
<p>The dots indicate array nesting, a max depth of 3 levels is allowed though. The above
would set <code>&quot;extra&quot;: { &quot;foo&quot;: { &quot;bar&quot;: &quot;value&quot; } }</code>.</p>
<p>If you have a complex value to add/modify, you can use the <code>--json</code> and <code>--merge</code> flags
to edit extra fields as json:</p>
<pre><code class="language-sh">php composer.phar config --json extra.foo.bar '{&quot;baz&quot;: true, &quot;qux&quot;: []}'
</code></pre>
<h2 id="create-project"><a class="header" href="#create-project">create-project</a></h2>
<p>You can use Composer to create new projects from an existing package. This is
the equivalent of doing a git clone/svn checkout followed by a <code>composer install</code>
of the vendors.</p>
<p>There are several applications for this:</p>
<ol>
<li>You can deploy application packages.</li>
<li>You can check out any package and start developing on patches for example.</li>
<li>Projects with multiple developers can use this feature to bootstrap the
initial application for development.</li>
</ol>
<p>To create a new project using Composer you can use the <code>create-project</code> command.
Pass it a package name, and the directory to create the project in. You can also
provide a version as a third argument, otherwise the latest version is used.</p>
<p>If the directory does not currently exist, it will be created during installation.</p>
<pre><code class="language-sh">php composer.phar create-project doctrine/orm path &quot;2.2.*&quot;
</code></pre>
<p>It is also possible to run the command without params in a directory with an
existing <code>composer.json</code> file to bootstrap a project.</p>
<p>By default the command checks for the packages on packagist.org.</p>
<h3 id="options-17"><a class="header" href="#options-17">Options</a></h3>
<ul>
<li><strong>--stability (-s):</strong> Minimum stability of package. Defaults to <code>stable</code>.</li>
<li><strong>--prefer-install:</strong> There are two ways of downloading a package: <code>source</code>
and <code>dist</code>. Composer uses <code>dist</code> by default. If you pass
<code>--prefer-install=source</code> (or <code>--prefer-source</code>) Composer will install from
<code>source</code> if there is one. This is useful if you want to make a bugfix to a
project and get a local git clone of the dependency directly.
To get the legacy behavior where Composer use <code>source</code> automatically for dev
versions of packages, use <code>--prefer-install=auto</code>. See also <a href="pt-br/06-config.html#preferred-install">config.preferred-install</a>.
Passing this flag will override the config value.</li>
<li><strong>--repository:</strong> Provide a custom repository to search for the package,
which will be used instead of packagist. Can be either an HTTP URL pointing
to a <code>composer</code> repository, a path to a local <code>packages.json</code> file, or a
JSON string which similar to what the <a href="pt-br/04-schema.html#repositories">repositories</a>
key accepts. You can use this multiple times to configure multiple repositories.</li>
<li><strong>--add-repository:</strong> Add the custom repository in the composer.json. If a lock
file is present, it will be deleted and an update will be run instead of an install.</li>
<li><strong>--dev:</strong> Install packages listed in <code>require-dev</code>.</li>
<li><strong>--no-dev:</strong> Disables installation of require-dev packages.</li>
<li><strong>--no-scripts:</strong> Disables the execution of the scripts defined in the root
package.</li>
<li><strong>--no-progress:</strong> Removes the progress display that can mess with some
terminals or scripts which don't handle backspace characters.</li>
<li><strong>--no-secure-http:</strong> Disable the secure-http config option temporarily while
installing the root package. Use at your own risk. Using this flag is a bad
idea.</li>
<li><strong>--keep-vcs:</strong> Skip the deletion of the VCS metadata for the created
project. This is mostly useful if you run the command in non-interactive
mode.</li>
<li><strong>--remove-vcs:</strong> Force-remove the VCS metadata without prompting.</li>
<li><strong>--no-install:</strong> Disables installation of the vendors.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all platform requirements (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine does
not fulfill these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement(<code>php</code>,
<code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>) and force the installation even if the local machine
does not fulfill it. Multiple requirements can be ignored via wildcard.</li>
<li><strong>--ask:</strong> Ask the user to provide a target directory for the new project.</li>
</ul>
<h2 id="dump-autoload-dumpautoload"><a class="header" href="#dump-autoload-dumpautoload">dump-autoload (dumpautoload)</a></h2>
<p>If you need to update the autoloader because of new classes in a classmap
package for example, you can use <code>dump-autoload</code> to do that without having to
go through an install or update.</p>
<p>Additionally, it can dump an optimized autoloader that converts PSR-0/4 packages
into classmap ones for performance reasons. In large applications with many
classes, the autoloader can take up a substantial portion of every request's
time. Using classmaps for everything is less convenient in development, but
using this option you can still use PSR-0/4 for convenience and classmaps for
performance.</p>
<h3 id="options-18"><a class="header" href="#options-18">Options</a></h3>
<ul>
<li><strong>--optimize (-o):</strong> Convert PSR-0/4 autoloading to classmap to get a faster
autoloader. This is recommended especially for production, but can take
a bit of time to run, so it is currently not done by default.</li>
<li><strong>--classmap-authoritative (-a):</strong> Autoload classes from the classmap only.
Implicitly enables <code>--optimize</code>.</li>
<li><strong>--apcu:</strong> Use APCu to cache found/not-found classes.</li>
<li><strong>--apcu-prefix:</strong> Use a custom prefix for the APCu autoloader cache.
Implicitly enables <code>--apcu</code>.</li>
<li><strong>--no-dev:</strong> Disables autoload-dev rules. Composer will by default infer this
automatically according to the last <code>install</code> or <code>update</code> <code>--no-dev</code> state.</li>
<li><strong>--dev:</strong> Enables autoload-dev rules. Composer will by default infer this
automatically according to the last <code>install</code> or <code>update</code> <code>--no-dev</code> state.</li>
<li><strong>--ignore-platform-reqs:</strong> ignore all <code>php</code>, <code>hhvm</code>, <code>lib-*</code> and <code>ext-*</code>
requirements and skip the <a href="pt-br/07-runtime.html#platform-check">platform check</a> for these.
See also the <a href="pt-br/06-config.html#platform"><code>platform</code></a> config option.</li>
<li><strong>--ignore-platform-req:</strong> ignore a specific platform requirement (<code>php</code>, <code>hhvm</code>,
<code>lib-*</code> and <code>ext-*</code>) and skip the <a href="pt-br/07-runtime.html#platform-check">platform check</a> for it.
Multiple requirements can be ignored via wildcard.</li>
</ul>
<h2 id="clear-cache--clearcache--cc"><a class="header" href="#clear-cache--clearcache--cc">clear-cache / clearcache / cc</a></h2>
<p>Deletes all content from Composer's cache directories.</p>
<h2 id="licenses"><a class="header" href="#licenses">licenses</a></h2>
<p>Lists the name, version and license of every package installed. Use
<code>--format=json</code> to get machine-readable output.</p>
<h3 id="options-19"><a class="header" href="#options-19">Options</a></h3>
<ul>
<li><strong>--format:</strong> Format of the output: text, json or summary (default: &quot;text&quot;)</li>
<li><strong>--no-dev:</strong> Remove dev dependencies from the output</li>
</ul>
<h2 id="run-script"><a class="header" href="#run-script">run-script</a></h2>
<h3 id="options-20"><a class="header" href="#options-20">Options</a></h3>
<ul>
<li><strong>--timeout:</strong> Set the script timeout in seconds, or 0 for no timeout.</li>
<li><strong>--dev:</strong> Sets the dev mode.</li>
<li><strong>--no-dev:</strong> Disable dev mode.</li>
<li><strong>--list (-l):</strong> List user defined scripts.</li>
</ul>
<p>To run <a href="pt-br/articles/scripts.html">scripts</a> manually you can use this command,
give it the script name and optionally any required arguments.</p>
<h2 id="exec"><a class="header" href="#exec">exec</a></h2>
<p>Executes a vendored binary/script. You can execute any command and this will
ensure that the Composer bin-dir is pushed on your PATH before the command
runs.</p>
<h3 id="options-21"><a class="header" href="#options-21">Options</a></h3>
<ul>
<li><strong>--list (-l):</strong> List the available Composer binaries.</li>
</ul>
<h2 id="diagnose"><a class="header" href="#diagnose">diagnose</a></h2>
<p>If you think you found a bug, or something is behaving strangely, you might
want to run the <code>diagnose</code> command to perform automated checks for many common
problems.</p>
<pre><code class="language-sh">php composer.phar diagnose
</code></pre>
<h2 id="archive"><a class="header" href="#archive">archive</a></h2>
<p>This command is used to generate a zip/tar archive for a given package in a
given version. It can also be used to archive your entire project without
excluded/ignored files.</p>
<pre><code class="language-sh">php composer.phar archive vendor/package 2.0.21 --format=zip
</code></pre>
<h3 id="options-22"><a class="header" href="#options-22">Options</a></h3>
<ul>
<li><strong>--format (-f):</strong> Format of the resulting archive: tar, tar.gz, tar.bz2
or zip (default: &quot;tar&quot;).</li>
<li><strong>--dir:</strong> Write the archive to this directory (default: &quot;.&quot;)</li>
<li><strong>--file:</strong> Write the archive with the given file name.</li>
</ul>
<h2 id="help"><a class="header" href="#help">help</a></h2>
<p>To get more information about a certain command, you can use <code>help</code>.</p>
<pre><code class="language-sh">php composer.phar help install
</code></pre>
<h2 id="command-line-completion"><a class="header" href="#command-line-completion">Command-line completion</a></h2>
<p>Command-line completion can be enabled by following instructions
<a href="https://github.com/bamarni/symfony-console-autocomplete">on this page</a>.</p>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment variables</a></h2>
<p>You can set a number of environment variables that override certain settings.
Whenever possible it is recommended to specify these settings in the <code>config</code>
section of <code>composer.json</code> instead. It is worth noting that the env vars will
always take precedence over the values specified in <code>composer.json</code>.</p>
<h3 id="composer"><a class="header" href="#composer">COMPOSER</a></h3>
<p>By setting the <code>COMPOSER</code> env variable it is possible to set the filename of
<code>composer.json</code> to something else.</p>
<p>For example:</p>
<pre><code class="language-sh">COMPOSER=composer-other.json php composer.phar install
</code></pre>
<p>The generated lock file will use the same name: <code>composer-other.lock</code> in this example.</p>
<h3 id="composer_allow_superuser"><a class="header" href="#composer_allow_superuser">COMPOSER_ALLOW_SUPERUSER</a></h3>
<p>If set to 1, this env disables the warning about running commands as root/super user.
It also disables automatic clearing of sudo sessions, so you should really only set this
if you use Composer as a super user at all times like in docker containers.</p>
<h3 id="composer_allow_xdebug"><a class="header" href="#composer_allow_xdebug">COMPOSER_ALLOW_XDEBUG</a></h3>
<p>If set to 1, this env allows running Composer when the Xdebug extension is enabled, without restarting PHP without it.</p>
<h3 id="composer_auth"><a class="header" href="#composer_auth">COMPOSER_AUTH</a></h3>
<p>The <code>COMPOSER_AUTH</code> var allows you to set up authentication as an environment variable.
The contents of the variable should be a JSON formatted object containing <a href="pt-br/articles/authentication-for-private-packages.html">http-basic,
github-oauth, bitbucket-oauth, ... objects as needed</a>,
and following the
<a href="pt-br/06-config.html">spec from the config</a>.</p>
<h3 id="composer_bin_dir"><a class="header" href="#composer_bin_dir">COMPOSER_BIN_DIR</a></h3>
<p>By setting this option you can change the <code>bin</code> (<a href="pt-br/articles/vendor-binaries.html">Vendor Binaries</a>)
directory to something other than <code>vendor/bin</code>.</p>
<h3 id="composer_cache_dir"><a class="header" href="#composer_cache_dir">COMPOSER_CACHE_DIR</a></h3>
<p>The <code>COMPOSER_CACHE_DIR</code> var allows you to change the Composer cache directory,
which is also configurable via the <a href="pt-br/06-config.html#cache-dir"><code>cache-dir</code></a> option.</p>
<p>By default, it points to <code>C:\Users\&lt;user&gt;\AppData\Local\Composer</code> (or <code>%LOCALAPPDATA%/Composer</code>) on Windows.
On *nix systems that follow the <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base
Directory Specifications</a>,
it points to <code>$XDG_CACHE_HOME/composer</code>. On other *nix systems and on macOS, it points to
<code>$COMPOSER_HOME/cache</code>.</p>
<h3 id="composer_cafile"><a class="header" href="#composer_cafile">COMPOSER_CAFILE</a></h3>
<p>By setting this environmental value, you can set a path to a certificate bundle
file to be used during SSL/TLS peer verification.</p>
<h3 id="composer_disable_xdebug_warn"><a class="header" href="#composer_disable_xdebug_warn">COMPOSER_DISABLE_XDEBUG_WARN</a></h3>
<p>If set to 1, this env suppresses a warning when Composer is running with the Xdebug extension enabled.</p>
<h3 id="composer_discard_changes"><a class="header" href="#composer_discard_changes">COMPOSER_DISCARD_CHANGES</a></h3>
<p>This env var controls the <a href="pt-br/06-config.html#discard-changes"><code>discard-changes</code></a> config option.</p>
<h3 id="composer_home"><a class="header" href="#composer_home">COMPOSER_HOME</a></h3>
<p>The <code>COMPOSER_HOME</code> var allows you to change the Composer home directory. This
is a hidden, global (per-user on the machine) directory that is shared between
all projects.</p>
<p>Use <code>composer config --global home</code> to see the location of the home directory.</p>
<p>By default, it points to <code>C:\Users\&lt;user&gt;\AppData\Roaming\Composer</code> on Windows
and <code>/Users/&lt;user&gt;/.composer</code> on macOS. On *nix systems that follow the <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base
Directory Specifications</a>,
it points to <code>$XDG_CONFIG_HOME/composer</code>. On other *nix systems, it points to
<code>/home/&lt;user&gt;/.composer</code>.</p>
<h4 id="composer_homeconfigjson"><a class="header" href="#composer_homeconfigjson">COMPOSER_HOME/config.json</a></h4>
<p>You may put a <code>config.json</code> file into the location which <code>COMPOSER_HOME</code> points
to. Composer will partially (only <code>config</code> and <code>repositories</code> keys) merge this
configuration with your project's <code>composer.json</code> when you run the <code>install</code> and
<code>update</code> commands.</p>
<p>This file allows you to set <a href="pt-br/05-repositories.html">repositories</a> and
<a href="pt-br/06-config.html">configuration</a> for the user's projects.</p>
<p>In case global configuration matches <em>local</em> configuration, the <em>local</em>
configuration in the project's <code>composer.json</code> always wins.</p>
<h3 id="composer_htaccess_protect"><a class="header" href="#composer_htaccess_protect">COMPOSER_HTACCESS_PROTECT</a></h3>
<p>Defaults to <code>1</code>. If set to <code>0</code>, Composer will not create <code>.htaccess</code> files in the
Composer home, cache, and data directories.</p>
<h3 id="composer_memory_limit"><a class="header" href="#composer_memory_limit">COMPOSER_MEMORY_LIMIT</a></h3>
<p>If set, the value is used as php's memory_limit.</p>
<h3 id="composer_mirror_path_repos"><a class="header" href="#composer_mirror_path_repos">COMPOSER_MIRROR_PATH_REPOS</a></h3>
<p>If set to 1, this env changes the default path repository strategy to <code>mirror</code> instead
of <code>symlink</code>. As it is the default strategy being set it can still be overwritten by
repository options.</p>
<h3 id="composer_no_interaction"><a class="header" href="#composer_no_interaction">COMPOSER_NO_INTERACTION</a></h3>
<p>If set to 1, this env var will make Composer behave as if you passed the
<code>--no-interaction</code> flag to every command. This can be set on build boxes/CI.</p>
<h3 id="composer_process_timeout"><a class="header" href="#composer_process_timeout">COMPOSER_PROCESS_TIMEOUT</a></h3>
<p>This env var controls the time Composer waits for commands (such as git
commands) to finish executing. The default value is 300 seconds (5 minutes).</p>
<h3 id="composer_root_version"><a class="header" href="#composer_root_version">COMPOSER_ROOT_VERSION</a></h3>
<p>By setting this var you can specify the version of the root package, if it
cannot be guessed from VCS info and is not present in <code>composer.json</code>.</p>
<h3 id="composer_vendor_dir"><a class="header" href="#composer_vendor_dir">COMPOSER_VENDOR_DIR</a></h3>
<p>By setting this var you can make Composer install the dependencies into a
directory other than <code>vendor</code>.</p>
<h3 id="composer_runtime_env"><a class="header" href="#composer_runtime_env">COMPOSER_RUNTIME_ENV</a></h3>
<p>This lets you hint under which environment Composer is running, which can help Composer
work around some environment specific issues. The only value currently supported is
<code>virtualbox</code>, which then enables some short <code>sleep()</code> calls to wait for the filesystem
to have written files properly before we attempt reading them. You can set the
environment variable if you use Vagrant or VirtualBox and experience issues with files not
being found during installation even though they should be present.</p>
<h3 id="http_proxy-or-http_proxy"><a class="header" href="#http_proxy-or-http_proxy">http_proxy or HTTP_PROXY</a></h3>
<p>If you are using Composer from behind an HTTP proxy, you can use the standard
<code>http_proxy</code> or <code>HTTP_PROXY</code> env vars. Set it to the URL of your proxy.
Many operating systems already set this variable for you.</p>
<p>Using <code>http_proxy</code> (lowercased) or even defining both might be preferable since
some tools like git or curl will only use the lower-cased <code>http_proxy</code> version.
Alternatively you can also define the git proxy using
<code>git config --global http.proxy &lt;proxy url&gt;</code>.</p>
<p>If you are using Composer in a non-CLI context (i.e. integration into a CMS or
similar use case), and need to support proxies, please provide the <code>CGI_HTTP_PROXY</code>
environment variable instead. See <a href="https://httpoxy.org/">httpoxy.org</a> for further
details.</p>
<h3 id="composer_max_parallel_http"><a class="header" href="#composer_max_parallel_http">COMPOSER_MAX_PARALLEL_HTTP</a></h3>
<p>Set to an integer to configure how many files can be downloaded in parallel. This
defaults to 12 and must be between 1 and 50. If your proxy has issues with
concurrency maybe you want to lower this. Increasing it should generally not result
in performance gains.</p>
<h3 id="http_proxy_request_fulluri"><a class="header" href="#http_proxy_request_fulluri">HTTP_PROXY_REQUEST_FULLURI</a></h3>
<p>If you use a proxy, but it does not support the request_fulluri flag, then you
should set this env var to <code>false</code> or <code>0</code> to prevent Composer from setting the
request_fulluri option.</p>
<h3 id="https_proxy_request_fulluri"><a class="header" href="#https_proxy_request_fulluri">HTTPS_PROXY_REQUEST_FULLURI</a></h3>
<p>If you use a proxy, but it does not support the request_fulluri flag for HTTPS
requests, then you should set this env var to <code>false</code> or <code>0</code> to prevent Composer
from setting the request_fulluri option.</p>
<h3 id="composer_self_update_target"><a class="header" href="#composer_self_update_target">COMPOSER_SELF_UPDATE_TARGET</a></h3>
<p>If set, makes the self-update command write the new Composer phar file into that path instead of overwriting itself. Useful for updating Composer on a read-only filesystem.</p>
<h3 id="no_proxy-or-no_proxy"><a class="header" href="#no_proxy-or-no_proxy">no_proxy or NO_PROXY</a></h3>
<p>If you are behind a proxy and would like to disable it for certain domains, you
can use the <code>no_proxy</code> or <code>NO_PROXY</code> env var. Set it to a comma separated list of
domains the proxy should <em>not</em> be used for.</p>
<p>The env var accepts domains, IP addresses, and IP address blocks in CIDR
notation. You can restrict the filter to a particular port (e.g. <code>:80</code>). You
can also set it to <code>*</code> to ignore the proxy for all HTTP requests.</p>
<h3 id="composer_disable_network"><a class="header" href="#composer_disable_network">COMPOSER_DISABLE_NETWORK</a></h3>
<p>If set to <code>1</code>, disables network access (best effort). This can be used for debugging or
to run Composer on a plane or a starship with poor connectivity.</p>
<p>If set to <code>prime</code>, GitHub VCS repositories will prime the cache, so it can then be used
fully offline with <code>1</code>.</p>
<h3 id="composer_debug_events"><a class="header" href="#composer_debug_events">COMPOSER_DEBUG_EVENTS</a></h3>
<p>If set to <code>1</code>, outputs information about events being dispatched, which can be
useful for plugin authors to identify what is firing when exactly.</p>
<h3 id="composer_no_dev"><a class="header" href="#composer_no_dev">COMPOSER_NO_DEV</a></h3>
<p>If set to <code>1</code>, it is the equivalent of passing the <code>--no-dev</code> argument to <code>install</code> or
<code>update</code>. You can override this for a single command by setting <code>COMPOSER_NO_DEV=0</code>.</p>
<h3 id="composer_ignore_platform_req-or-composer_ignore_platform_reqs"><a class="header" href="#composer_ignore_platform_req-or-composer_ignore_platform_reqs">COMPOSER_IGNORE_PLATFORM_REQ or COMPOSER_IGNORE_PLATFORM_REQS</a></h3>
<p>If <code>COMPOSER_IGNORE_PLATFORM_REQS</code> set to <code>1</code>, it is the equivalent of passing the <code>--ignore-platform-reqs</code> argument.
Otherwise, specifying a comma separated list in <code>COMPOSER_IGNORE_PLATFORM_REQ</code> will ignore those specific requirements.</p>
<p>For example, if a development workstation will never run database queries, this can be used to ignore the requirement for the database extensions to be available. If you set <code>COMPOSER_IGNORE_PLATFORM_REQ=ext-oci8</code>, then composer will allow packages to be installed even if the <code>oci8</code> PHP extension is not enabled.</p>
<p>← <a href="pt-br/02-libraries.html">Libraries</a>  |  <a href="pt-br/04-schema.html">Schema</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-composerjson-schema"><a class="header" href="#the-composerjson-schema">The composer.json schema</a></h1>
<p>This chapter will explain all of the fields available in <code>composer.json</code>.</p>
<h2 id="json-schema"><a class="header" href="#json-schema">JSON schema</a></h2>
<p>We have a <a href="https://json-schema.org">JSON schema</a> that documents the format and
can also be used to validate your <code>composer.json</code>. In fact, it is used by the
<code>validate</code> command. You can find it at: https://getcomposer.org/schema.json</p>
<h2 id="root-package"><a class="header" href="#root-package">Root Package</a></h2>
<p>The root package is the package defined by the <code>composer.json</code> at the root of
your project. It is the main <code>composer.json</code> that defines your project
requirements.</p>
<p>Certain fields only apply when in the root package context. One example of
this is the <code>config</code> field. Only the root package can define configuration.
The config of dependencies is ignored. This makes the <code>config</code> field
<code>root-only</code>.</p>
<blockquote>
<p><strong>Note:</strong> A package can be the root package or not, depending on the context.
For example, if your project depends on the <code>monolog</code> library, your project
is the root package. However, if you clone <code>monolog</code> from GitHub in order to
fix a bug in it, then <code>monolog</code> is the root package.</p>
</blockquote>
<h2 id="properties"><a class="header" href="#properties">Properties</a></h2>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<p>The name of the package. It consists of vendor name and project name,
separated by <code>/</code>. Examples:</p>
<ul>
<li>monolog/monolog</li>
<li>igorw/event-source</li>
</ul>
<p>The name must be lowercase and consist of words separated by <code>-</code>, <code>.</code> or <code>_</code>.
The complete name should match <code>^[a-z0-9]([_.-]?[a-z0-9]+)*/[a-z0-9](([_.]?|-{0,2})[a-z0-9]+)*$</code>.</p>
<p>The <code>name</code> property is required for published packages (libraries).</p>
<blockquote>
<p><strong>Note:</strong> Before Composer version 2.0, a name could contain any character, including white spaces.</p>
</blockquote>
<h3 id="description"><a class="header" href="#description">description</a></h3>
<p>A short description of the package. Usually this is one line long.</p>
<p>Required for published packages (libraries).</p>
<h3 id="version"><a class="header" href="#version">version</a></h3>
<p>The version of the package. In most cases this is not required and should
be omitted (see below).</p>
<p>This must follow the format of <code>X.Y.Z</code> or <code>vX.Y.Z</code> with an optional suffix
of <code>-dev</code>, <code>-patch</code> (<code>-p</code>), <code>-alpha</code> (<code>-a</code>), <code>-beta</code> (<code>-b</code>) or <code>-RC</code>.
The patch, alpha, beta and RC suffixes can also be followed by a number.</p>
<p>Examples:</p>
<ul>
<li>1.0.0</li>
<li>1.0.2</li>
<li>1.1.0</li>
<li>0.2.5</li>
<li>1.0.0-dev</li>
<li>1.0.0-alpha3</li>
<li>1.0.0-beta2</li>
<li>1.0.0-RC5</li>
<li>v2.0.4-p1</li>
</ul>
<p>Optional if the package repository can infer the version from somewhere, such
as the VCS tag name in the VCS repository. In that case it is also recommended
to omit it.</p>
<blockquote>
<p><strong>Note:</strong> Packagist uses VCS repositories, so the statement above is very
much true for Packagist as well. Specifying the version yourself will
most likely end up creating problems at some point due to human error.</p>
</blockquote>
<h3 id="type"><a class="header" href="#type">type</a></h3>
<p>The type of the package. It defaults to <code>library</code>.</p>
<p>Package types are used for custom installation logic. If you have a package
that needs some special logic, you can define a custom type. This could be a
<code>symfony-bundle</code>, a <code>wordpress-plugin</code> or a <code>typo3-cms-extension</code>. These types
will all be specific to certain projects, and they will need to provide an
installer capable of installing packages of that type.</p>
<p>Out of the box, Composer supports four types:</p>
<ul>
<li><strong>library:</strong> This is the default. It will copy the files to <code>vendor</code>.</li>
<li><strong>project:</strong> This denotes a project rather than a library. For example
application shells like the <a href="https://github.com/symfony/symfony-standard">Symfony standard edition</a>,
CMSs like the <a href="https://github.com/silverstripe/silverstripe-installer">SilverStripe installer</a>
or full fledged applications distributed as packages. This can for example
be used by IDEs to provide listings of projects to initialize when creating
a new workspace.</li>
<li><strong>metapackage:</strong> An empty package that contains requirements and will trigger
their installation, but contains no files and will not write anything to the
filesystem. As such, it does not require a dist or source key to be
installable.</li>
<li><strong>composer-plugin:</strong> A package of type <code>composer-plugin</code> may provide an
installer for other packages that have a custom type. Read more in the
<a href="pt-br/articles/custom-installers.html">dedicated article</a>.</li>
</ul>
<p>Only use a custom type if you need custom logic during installation. It is
recommended to omit this field and have it default to <code>library</code>.</p>
<h3 id="keywords"><a class="header" href="#keywords">keywords</a></h3>
<p>An array of keywords that the package is related to. These can be used for
searching and filtering.</p>
<p>Examples:</p>
<ul>
<li>logging</li>
<li>events</li>
<li>database</li>
<li>redis</li>
<li>templating</li>
</ul>
<p>Optional.</p>
<h3 id="homepage"><a class="header" href="#homepage">homepage</a></h3>
<p>A URL to the website of the project.</p>
<p>Optional.</p>
<h3 id="readme"><a class="header" href="#readme">readme</a></h3>
<p>A relative path to the readme document.</p>
<p>Optional.</p>
<h3 id="time"><a class="header" href="#time">time</a></h3>
<p>Release date of the version.</p>
<p>Must be in <code>YYYY-MM-DD</code> or <code>YYYY-MM-DD HH:MM:SS</code> format.</p>
<p>Optional.</p>
<h3 id="license"><a class="header" href="#license">license</a></h3>
<p>The license of the package. This can be either a string or an array of strings.</p>
<p>The recommended notation for the most common licenses is (alphabetical):</p>
<ul>
<li>Apache-2.0</li>
<li>BSD-2-Clause</li>
<li>BSD-3-Clause</li>
<li>BSD-4-Clause</li>
<li>GPL-2.0-only / GPL-2.0-or-later</li>
<li>GPL-3.0-only / GPL-3.0-or-later</li>
<li>LGPL-2.1-only / LGPL-2.1-or-later</li>
<li>LGPL-3.0-only / LGPL-3.0-or-later</li>
<li>MIT</li>
</ul>
<p>Optional, but it is highly recommended to supply this. More identifiers are
listed at the <a href="https://spdx.org/licenses/">SPDX Open Source License Registry</a>.</p>
<blockquote>
<p><strong>Note:</strong> For closed-source software, you may use <code>&quot;proprietary&quot;</code> as the license identifier.</p>
</blockquote>
<p>An Example:</p>
<pre><code class="language-json">{
    &quot;license&quot;: &quot;MIT&quot;
}
</code></pre>
<p>For a package, when there is a choice between licenses (&quot;disjunctive license&quot;),
multiple can be specified as an array.</p>
<p>An Example for disjunctive licenses:</p>
<pre><code class="language-json">{
    &quot;license&quot;: [
       &quot;LGPL-2.1-only&quot;,
       &quot;GPL-3.0-or-later&quot;
    ]
}
</code></pre>
<p>Alternatively they can be separated with &quot;or&quot; and enclosed in parentheses;</p>
<pre><code class="language-json">{
    &quot;license&quot;: &quot;(LGPL-2.1-only or GPL-3.0-or-later)&quot;
}
</code></pre>
<p>Similarly, when multiple licenses need to be applied (&quot;conjunctive license&quot;),
they should be separated with &quot;and&quot; and enclosed in parentheses.</p>
<h3 id="authors"><a class="header" href="#authors">authors</a></h3>
<p>The authors of the package. This is an array of objects.</p>
<p>Each author object can have following properties:</p>
<ul>
<li><strong>name:</strong> The author's name. Usually their real name.</li>
<li><strong>email:</strong> The author's email address.</li>
<li><strong>homepage:</strong> URL to the author's website.</li>
<li><strong>role:</strong> The author's role in the project (e.g. developer or translator)</li>
</ul>
<p>An example:</p>
<pre><code class="language-json">{
    &quot;authors&quot;: [
        {
            &quot;name&quot;: &quot;Nils Adermann&quot;,
            &quot;email&quot;: &quot;naderman@naderman.de&quot;,
            &quot;homepage&quot;: &quot;https://www.naderman.de&quot;,
            &quot;role&quot;: &quot;Developer&quot;
        },
        {
            &quot;name&quot;: &quot;Jordi Boggiano&quot;,
            &quot;email&quot;: &quot;j.boggiano@seld.be&quot;,
            &quot;homepage&quot;: &quot;https://seld.be&quot;,
            &quot;role&quot;: &quot;Developer&quot;
        }
    ]
}
</code></pre>
<p>Optional, but highly recommended.</p>
<h3 id="support"><a class="header" href="#support">support</a></h3>
<p>Various information to get support about the project.</p>
<p>Support information includes the following:</p>
<ul>
<li><strong>email:</strong> Email address for support.</li>
<li><strong>issues:</strong> URL to the issue tracker.</li>
<li><strong>forum:</strong> URL to the forum.</li>
<li><strong>wiki:</strong> URL to the wiki.</li>
<li><strong>irc:</strong> IRC channel for support, as irc://server/channel.</li>
<li><strong>source:</strong> URL to browse or download the sources.</li>
<li><strong>docs:</strong> URL to the documentation.</li>
<li><strong>rss:</strong> URL to the RSS feed.</li>
<li><strong>chat:</strong> URL to the chat channel.</li>
</ul>
<p>An example:</p>
<pre><code class="language-json">{
    &quot;support&quot;: {
        &quot;email&quot;: &quot;support@example.org&quot;,
        &quot;irc&quot;: &quot;irc://irc.freenode.org/composer&quot;
    }
}
</code></pre>
<p>Optional.</p>
<h3 id="funding"><a class="header" href="#funding">funding</a></h3>
<p>A list of URLs to provide funding to the package authors for maintenance and
development of new functionality.</p>
<p>Each entry consists of the following</p>
<ul>
<li><strong>type:</strong> The type of funding, or the platform through which funding can be provided, e.g. patreon, opencollective, tidelift or github.</li>
<li><strong>url:</strong> URL to a website with details, and a way to fund the package.</li>
</ul>
<p>An example:</p>
<pre><code class="language-json">{
    &quot;funding&quot;: [
        {
            &quot;type&quot;: &quot;patreon&quot;,
            &quot;url&quot;: &quot;https://www.patreon.com/phpdoctrine&quot;
        },
        {
            &quot;type&quot;: &quot;tidelift&quot;,
            &quot;url&quot;: &quot;https://tidelift.com/subscription/pkg/packagist-doctrine_doctrine-bundle&quot;
        },
        {
            &quot;type&quot;: &quot;other&quot;,
            &quot;url&quot;: &quot;https://www.doctrine-project.org/sponsorship.html&quot;
        }
    ]
}
</code></pre>
<p>Optional.</p>
<h3 id="package-links"><a class="header" href="#package-links">Package links</a></h3>
<p>All of the following take an object which maps package names to
versions of the package via version constraints. Read more about
versions <a href="pt-br/articles/versions.html">here</a>.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*&quot;
    }
}
</code></pre>
<p>All links are optional fields.</p>
<p><code>require</code> and <code>require-dev</code> additionally support <em>stability flags</em> (<a href="pt-br/04-schema.html#root-package">root-only</a>).
They take the form &quot;<em>constraint</em>@<em>stability flag</em>&quot;.
These allow you to further restrict or expand the stability of a package beyond
the scope of the <a href="pt-br/04-schema.html#minimum-stability">minimum-stability</a> setting. You can apply
them to a constraint, or apply them to an empty <em>constraint</em> if you want to
allow unstable packages of a dependency for example.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*@beta&quot;,
        &quot;acme/foo&quot;: &quot;@dev&quot;
    }
}
</code></pre>
<p>If one of your dependencies has a dependency on an unstable package you need to
explicitly require it as well, along with its sufficient stability flag.</p>
<p>Example:</p>
<p>Assuming <code>doctrine/doctrine-fixtures-bundle</code> requires <code>&quot;doctrine/data-fixtures&quot;: &quot;dev-master&quot;</code>
then inside the root composer.json you need to add the second line below to allow dev
releases for the <code>doctrine/data-fixtures</code> package :</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;doctrine/doctrine-fixtures-bundle&quot;: &quot;dev-master&quot;,
        &quot;doctrine/data-fixtures&quot;: &quot;@dev&quot;
    }
}
</code></pre>
<p><code>require</code> and <code>require-dev</code> additionally support explicit references (i.e.
commit) for dev versions to make sure they are locked to a given state, even
when you run update. These only work if you explicitly require a dev version
and append the reference with <code>#&lt;ref&gt;</code>. This is also a
<a href="pt-br/04-schema.html#root-package">root-only</a> feature and will be ignored in
dependencies.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;dev-master#2eb0c0978d290a1c45346a1955188929cb4e5db7&quot;,
        &quot;acme/foo&quot;: &quot;1.0.x-dev#abc123&quot;
    }
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> This feature has severe technical limitations, as the
composer.json metadata will still be read from the branch name you specify
before the hash. You should therefore only use this as a temporary solution
during development to remediate transient issues, until you can switch to
tagged releases. The Composer team does not actively support this feature
and will not accept bug reports related to it.</p>
</blockquote>
<p>It is also possible to inline-alias a package constraint so that it matches
a constraint that it otherwise would not. For more information <a href="pt-br/articles/aliases.html">see the
aliases article</a>.</p>
<p><code>require</code> and <code>require-dev</code> also support references to specific PHP versions
and PHP extensions your project needs to run successfully.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;require&quot; : {
        &quot;php&quot; : &quot;&gt;=7.4&quot;,
        &quot;ext-mbstring&quot;: &quot;*&quot;
    }
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> It is important to list PHP extensions your project requires.
Not all PHP installations are created equal: some may miss extensions you
may consider as standard (such as <code>ext-mysqli</code> which is not installed by
default in Fedora/CentOS minimal installation systems). Failure to list
required PHP extensions may lead to a bad user experience: Composer will
install your package without any errors but it will then fail at run-time.
The <code>composer show --platform</code> command lists all PHP extensions available on
your system. You may use it to help you compile the list of extensions you
use and require. Alternatively you may use third party tools to analyze
your project for the list of extensions used.</p>
</blockquote>
<h4 id="require-1"><a class="header" href="#require-1">require</a></h4>
<p>Map of packages required by this package. The package will not be installed
unless those requirements can be met.</p>
<h4 id="require-dev-root-only"><a class="header" href="#require-dev-root-only">require-dev <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h4>
<p>Map of packages required for developing this package, or running
tests, etc. The dev requirements of the root package are installed by default.
Both <code>install</code> or <code>update</code> support the <code>--no-dev</code> option that prevents dev
dependencies from being installed.</p>
<h4 id="conflict"><a class="header" href="#conflict">conflict</a></h4>
<p>Map of packages that conflict with this version of this package. They
will not be allowed to be installed together with your package.</p>
<p>Note that when specifying ranges like <code>&lt;1.0 &gt;=1.1</code> in a <code>conflict</code> link,
this will state a conflict with all versions that are less than 1.0 <em>and</em> equal
or newer than 1.1 at the same time, which is probably not what you want. You
probably want to go for <code>&lt;1.0 || &gt;=1.1</code> in this case.</p>
<h4 id="replace"><a class="header" href="#replace">replace</a></h4>
<p>Map of packages that are replaced by this package. This allows you to fork a
package, publish it under a different name with its own version numbers, while
packages requiring the original package continue to work with your fork because
it replaces the original package.</p>
<p>This is also useful for packages that contain sub-packages, for example the main
symfony/symfony package contains all the Symfony Components which are also
available as individual packages. If you require the main package it will
automatically fulfill any requirement of one of the individual components,
since it replaces them.</p>
<p>Caution is advised when using replace for the sub-package purpose explained
above. You should then typically only replace using <code>self.version</code> as a version
constraint, to make sure the main package only replaces the sub-packages of
that exact version, and not any other version, which would be incorrect.</p>
<h4 id="provide"><a class="header" href="#provide">provide</a></h4>
<p>Map of packages that are provided by this package. This is mostly
useful for implementations of common interfaces. A package could depend on
some virtual package e.g. <code>psr/logger-implementation</code>, any library that implements
this logger interface would list it in <code>provide</code>. Implementors can then
be <a href="https://packagist.org/providers/psr/log-implementation">found on Packagist.org</a>.</p>
<p>Using <code>provide</code> with the name of an actual package rather than a virtual one
implies that the code of that package is also shipped, in which case <code>replace</code>
is generally a better choice. A common convention for packages providing an
interface and relying on other packages to provide an implementation (for
instance the PSR interfaces) is to use a <code>-implementation</code> suffix for the
name of the virtual package corresponding to the interface package.</p>
<h4 id="suggest"><a class="header" href="#suggest">suggest</a></h4>
<p>Suggested packages that can enhance or work well with this package. These are
informational and are displayed after the package is installed, to give
your users a hint that they could add more packages, even though they are not
strictly required.</p>
<p>The format is like package links above, except that the values are free text
and not version constraints.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;suggest&quot;: {
        &quot;monolog/monolog&quot;: &quot;Allows more advanced logging of the application flow&quot;,
        &quot;ext-xml&quot;: &quot;Needed to support XML format in class Foo&quot;
    }
}
</code></pre>
<h3 id="autoload"><a class="header" href="#autoload">autoload</a></h3>
<p>Autoload mapping for a PHP autoloader.</p>
<p><a href="https://www.php-fig.org/psr/psr-4/"><code>PSR-4</code></a> and <a href="http://www.php-fig.org/psr/psr-0/"><code>PSR-0</code></a>
autoloading, <code>classmap</code> generation and <code>files</code> includes are supported.</p>
<p>PSR-4 is the recommended way since it offers greater ease of use (no need
to regenerate the autoloader when you add classes).</p>
<h4 id="psr-4"><a class="header" href="#psr-4">PSR-4</a></h4>
<p>Under the <code>psr-4</code> key you define a mapping from namespaces to paths, relative to the
package root. When autoloading a class like <code>Foo\\Bar\\Baz</code> a namespace prefix
<code>Foo\\</code> pointing to a directory <code>src/</code> means that the autoloader will look for a
file named <code>src/Bar/Baz.php</code> and include it if present. Note that as opposed to
the older PSR-0 style, the prefix (<code>Foo\\</code>) is <strong>not</strong> present in the file path.</p>
<p>Namespace prefixes must end in <code>\\</code> to avoid conflicts between similar prefixes.
For example <code>Foo</code> would match classes in the <code>FooBar</code> namespace so the trailing
backslashes solve the problem: <code>Foo\\</code> and <code>FooBar\\</code> are distinct.</p>
<p>The PSR-4 references are all combined, during install/update, into a single
key =&gt; value array which may be found in the generated file
<code>vendor/composer/autoload_psr4.php</code>.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-4&quot;: {
            &quot;Monolog\\&quot;: &quot;src/&quot;,
            &quot;Vendor\\Namespace\\&quot;: &quot;&quot;
        }
    }
}
</code></pre>
<p>If you need to search for a same prefix in multiple directories,
you can specify them as an array as such:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-4&quot;: { &quot;Monolog\\&quot;: [&quot;src/&quot;, &quot;lib/&quot;] }
    }
}
</code></pre>
<p>If you want to have a fallback directory where any namespace will be looked for,
you can use an empty prefix like:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-4&quot;: { &quot;&quot;: &quot;src/&quot; }
    }
}
</code></pre>
<h4 id="psr-0"><a class="header" href="#psr-0">PSR-0</a></h4>
<p>Under the <code>psr-0</code> key you define a mapping from namespaces to paths, relative to the
package root. Note that this also supports the PEAR-style non-namespaced convention.</p>
<p>Please note namespace declarations should end in <code>\\</code> to make sure the autoloader
responds exactly. For example <code>Foo</code> would match in <code>FooBar</code> so the trailing
backslashes solve the problem: <code>Foo\\</code> and <code>FooBar\\</code> are distinct.</p>
<p>The PSR-0 references are all combined, during install/update, into a single key =&gt; value
array which may be found in the generated file <code>vendor/composer/autoload_namespaces.php</code>.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: {
            &quot;Monolog\\&quot;: &quot;src/&quot;,
            &quot;Vendor\\Namespace\\&quot;: &quot;src/&quot;,
            &quot;Vendor_Namespace_&quot;: &quot;src/&quot;
        }
    }
}
</code></pre>
<p>If you need to search for a same prefix in multiple directories,
you can specify them as an array as such:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: { &quot;Monolog\\&quot;: [&quot;src/&quot;, &quot;lib/&quot;] }
    }
}
</code></pre>
<p>The PSR-0 style is not limited to namespace declarations only but may be
specified right down to the class level. This can be useful for libraries with
only one class in the global namespace. If the php source file is also located
in the root of the package, for example, it may be declared like this:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: { &quot;UniqueGlobalClass&quot;: &quot;&quot; }
    }
}
</code></pre>
<p>If you want to have a fallback directory where any namespace can be, you can
use an empty prefix like:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: { &quot;&quot;: &quot;src/&quot; }
    }
}
</code></pre>
<h4 id="classmap"><a class="header" href="#classmap">Classmap</a></h4>
<p>The <code>classmap</code> references are all combined, during install/update, into a single
key =&gt; value array which may be found in the generated file
<code>vendor/composer/autoload_classmap.php</code>. This map is built by scanning for
classes in all <code>.php</code> and <code>.inc</code> files in the given directories/files.</p>
<p>You can use the classmap generation support to define autoloading for all libraries
that do not follow PSR-0/4. To configure this you specify all directories or files
to search for classes.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;classmap&quot;: [&quot;src/&quot;, &quot;lib/&quot;, &quot;Something.php&quot;]
    }
}
</code></pre>
<p>Wildcards (<code>*</code>) are also supported in a classmap paths, and expand to match any directory name:</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;classmap&quot;: [&quot;src/addons/*/lib/&quot;, &quot;3rd-party/*&quot;, &quot;Something.php&quot;]
    }
}
</code></pre>
<h4 id="files"><a class="header" href="#files">Files</a></h4>
<p>If you want to require certain files explicitly on every request then you can use
the <code>files</code> autoloading mechanism. This is useful if your package includes PHP functions
that cannot be autoloaded by PHP.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;files&quot;: [&quot;src/MyLibrary/functions.php&quot;]
    }
}
</code></pre>
<h4 id="exclude-files-from-classmaps"><a class="header" href="#exclude-files-from-classmaps">Exclude files from classmaps</a></h4>
<p>If you want to exclude some files or folders from the classmap you can use the <code>exclude-from-classmap</code> property.
This might be useful to exclude test classes in your live environment, for example, as those will be skipped
from the classmap even when building an optimized autoloader.</p>
<p>The classmap generator will ignore all files in the paths configured here. The paths are absolute from the package
root directory (i.e. composer.json location), and support <code>*</code> to match anything but a slash, and <code>**</code> to
match anything. <code>**</code> is implicitly added to the end of the paths.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;exclude-from-classmap&quot;: [&quot;/Tests/&quot;, &quot;/test/&quot;, &quot;/tests/&quot;]
    }
}
</code></pre>
<h4 id="optimizing-the-autoloader"><a class="header" href="#optimizing-the-autoloader">Optimizing the autoloader</a></h4>
<p>The autoloader can have quite a substantial impact on your request time
(50-100ms per request in large frameworks using a lot of classes). See the
<a href="pt-br/articles/autoloader-optimization.html">article about optimizing the autoloader</a>
for more details on how to reduce this impact.</p>
<h3 id="autoload-dev-root-only"><a class="header" href="#autoload-dev-root-only">autoload-dev <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>This section allows defining autoload rules for development purposes.</p>
<p>Classes needed to run the test suite should not be included in the main autoload
rules to avoid polluting the autoloader in production and when other people use
your package as a dependency.</p>
<p>Therefore, it is a good idea to rely on a dedicated path for your unit tests
and to add it within the autoload-dev section.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-4&quot;: { &quot;MyLibrary\\&quot;: &quot;src/&quot; }
    },
    &quot;autoload-dev&quot;: {
        &quot;psr-4&quot;: { &quot;MyLibrary\\Tests\\&quot;: &quot;tests/&quot; }
    }
}
</code></pre>
<h3 id="include-path"><a class="header" href="#include-path">include-path</a></h3>
<blockquote>
<p><strong>DEPRECATED</strong>: This is only present to support legacy projects, and all new code
should preferably use autoloading. As such it is a deprecated practice, but the
feature itself will not likely disappear from Composer.</p>
</blockquote>
<p>A list of paths which should get appended to PHP's <code>include_path</code>.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;include-path&quot;: [&quot;lib/&quot;]
}
</code></pre>
<p>Optional.</p>
<h3 id="target-dir"><a class="header" href="#target-dir">target-dir</a></h3>
<blockquote>
<p><strong>DEPRECATED</strong>: This is only present to support legacy PSR-0 style autoloading,
and all new code should preferably use PSR-4 without target-dir and projects
using PSR-0 with PHP namespaces are encouraged to migrate to PSR-4 instead.</p>
</blockquote>
<p>Defines the installation target.</p>
<p>In case the package root is below the namespace declaration you cannot
autoload properly. <code>target-dir</code> solves this problem.</p>
<p>An example is Symfony. There are individual packages for the components. The
Yaml component is under <code>Symfony\Component\Yaml</code>. The package root is that
<code>Yaml</code> directory. To make autoloading possible, we need to make sure that it
is not installed into <code>vendor/symfony/yaml</code>, but instead into
<code>vendor/symfony/yaml/Symfony/Component/Yaml</code>, so that the autoloader can load
it from <code>vendor/symfony/yaml</code>.</p>
<p>To do that, <code>autoload</code> and <code>target-dir</code> are defined as follows:</p>
<pre><code class="language-json">{
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: { &quot;Symfony\\Component\\Yaml\\&quot;: &quot;&quot; }
    },
    &quot;target-dir&quot;: &quot;Symfony/Component/Yaml&quot;
}
</code></pre>
<p>Optional.</p>
<h3 id="minimum-stability-root-only"><a class="header" href="#minimum-stability-root-only">minimum-stability <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>This defines the default behavior for filtering packages by stability. This
defaults to <code>stable</code>, so if you rely on a <code>dev</code> package, you should specify
it in your file to avoid surprises.</p>
<p>All versions of each package are checked for stability, and those that are less
stable than the <code>minimum-stability</code> setting will be ignored when resolving
your project dependencies. (Note that you can also specify stability requirements
on a per-package basis using stability flags in the version constraints that you
specify in a <code>require</code> block (see <a href="pt-br/04-schema.html#package-links">package links</a> for more details).</p>
<p>Available options (in order of stability) are <code>dev</code>, <code>alpha</code>, <code>beta</code>, <code>RC</code>,
and <code>stable</code>.</p>
<h3 id="prefer-stable-root-only"><a class="header" href="#prefer-stable-root-only">prefer-stable <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>When this is enabled, Composer will prefer more stable packages over unstable
ones when finding compatible stable packages is possible. If you require a
dev version or only alphas are available for a package, those will still be
selected granted that the minimum-stability allows for it.</p>
<p>Use <code>&quot;prefer-stable&quot;: true</code> to enable.</p>
<h3 id="repositories-root-only"><a class="header" href="#repositories-root-only">repositories <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>Custom package repositories to use.</p>
<p>By default Composer only uses the packagist repository. By specifying
repositories you can get packages from elsewhere.</p>
<p>Repositories are not resolved recursively. You can only add them to your main
<code>composer.json</code>. Repository declarations of dependencies' <code>composer.json</code>s are
ignored.</p>
<p>The following repository types are supported:</p>
<ul>
<li><strong>composer:</strong> A Composer repository is a <code>packages.json</code> file served
via the network (HTTP, FTP, SSH), that contains a list of <code>composer.json</code>
objects with additional <code>dist</code> and/or <code>source</code> information. The <code>packages.json</code>
file is loaded using a PHP stream. You can set extra options on that stream
using the <code>options</code> parameter.</li>
<li><strong>vcs:</strong> The version control system repository can fetch packages from git,
svn, fossil and hg repositories.</li>
<li><strong>package:</strong> If you depend on a project that does not have any support for
Composer whatsoever you can define the package inline using a <code>package</code>
repository. You basically inline the <code>composer.json</code> object.</li>
</ul>
<p>For more information on any of these, see <a href="pt-br/05-repositories.html">Repositories</a>.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;http://packages.example.com&quot;
        },
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://packages.example.com&quot;,
            &quot;options&quot;: {
                &quot;ssl&quot;: {
                    &quot;verify_peer&quot;: &quot;true&quot;
                }
            }
        },
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;https://github.com/Seldaek/monolog&quot;
        },
        {
            &quot;type&quot;: &quot;package&quot;,
            &quot;package&quot;: {
                &quot;name&quot;: &quot;smarty/smarty&quot;,
                &quot;version&quot;: &quot;3.1.7&quot;,
                &quot;dist&quot;: {
                    &quot;url&quot;: &quot;https://www.smarty.net/files/Smarty-3.1.7.zip&quot;,
                    &quot;type&quot;: &quot;zip&quot;
                },
                &quot;source&quot;: {
                    &quot;url&quot;: &quot;https://smarty-php.googlecode.com/svn/&quot;,
                    &quot;type&quot;: &quot;svn&quot;,
                    &quot;reference&quot;: &quot;tags/Smarty_3_1_7/distribution/&quot;
                }
            }
        }
    ]
}
</code></pre>
<blockquote>
<p><strong>Note:</strong> Order is significant here. When looking for a package, Composer
will look from the first to the last repository, and pick the first match.
By default Packagist is added last which means that custom repositories can
override packages from it.</p>
</blockquote>
<p>Using JSON object notation is also possible. However, JSON key/value pairs
are to be considered unordered so consistent behaviour cannot be guaranteed.</p>
<pre><code class="language-json">{
   &quot;repositories&quot;: {
        &quot;foo&quot;: {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;http://packages.foo.com&quot;
        }
   }
}
</code></pre>
<h3 id="config-root-only"><a class="header" href="#config-root-only">config <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>A set of configuration options. It is only used for projects. See
<a href="pt-br/06-config.html">Config</a> for a description of each individual option.</p>
<h3 id="scripts-root-only"><a class="header" href="#scripts-root-only">scripts <span>(<a href="pt-br/04-schema.html#root-package">root-only</a>)</span></a></h3>
<p>Composer allows you to hook into various parts of the installation process
through the use of scripts.</p>
<p>See <a href="pt-br/articles/scripts.html">Scripts</a> for events details and examples.</p>
<h3 id="extra"><a class="header" href="#extra">extra</a></h3>
<p>Arbitrary extra data for consumption by <code>scripts</code>.</p>
<p>This can be virtually anything. To access it from within a script event
handler, you can do:</p>
<pre><code class="language-php">$extra = $event-&gt;getComposer()-&gt;getPackage()-&gt;getExtra();
</code></pre>
<p>Optional.</p>
<h3 id="bin"><a class="header" href="#bin">bin</a></h3>
<p>A set of files that should be treated as binaries and made available
into the <code>bin-dir</code> (from config).</p>
<p>See <a href="pt-br/articles/vendor-binaries.html">Vendor Binaries</a> for more details.</p>
<p>Optional.</p>
<h3 id="archive-1"><a class="header" href="#archive-1">archive</a></h3>
<p>A set of options for creating package archives.</p>
<p>The following options are supported:</p>
<ul>
<li><strong>name:</strong> Allows configuring base name for archive.
By default (if not configured, and <code>--file</code> is not passed as command-line argument),
<code>preg_replace('#[^a-z0-9-_]#i', '-', name)</code> is used.</li>
</ul>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;org/strangeName&quot;,
    &quot;archive&quot;: {
        &quot;name&quot;: &quot;Strange_name&quot;
    }
}
</code></pre>
<ul>
<li><strong>exclude:</strong> Allows configuring a list of patterns for excluded paths. The
pattern syntax matches .gitignore files. A leading exclamation mark (!) will
result in any matching files to be included even if a previous pattern
excluded them. A leading slash will only match at the beginning of the project
relative path. An asterisk will not expand to a directory separator.</li>
</ul>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;archive&quot;: {
        &quot;exclude&quot;: [&quot;/foo/bar&quot;, &quot;baz&quot;, &quot;/*.test&quot;, &quot;!/foo/bar/baz&quot;]
    }
}
</code></pre>
<p>The example will include <code>/dir/foo/bar/file</code>, <code>/foo/bar/baz</code>, <code>/file.php</code>,
<code>/foo/my.test</code> but it will exclude <code>/foo/bar/any</code>, <code>/foo/baz</code>, and <code>/my.test</code>.</p>
<p>Optional.</p>
<h3 id="abandoned"><a class="header" href="#abandoned">abandoned</a></h3>
<p>Indicates whether this package has been abandoned.</p>
<p>It can be boolean or a package name/URL pointing to a recommended alternative.</p>
<p>Examples:</p>
<p>Use <code>&quot;abandoned&quot;: true</code> to indicate this package is abandoned.
Use <code>&quot;abandoned&quot;: &quot;monolog/monolog&quot;</code> to indicate this package is abandoned, and that 
the recommended alternative is <code>monolog/monolog</code>.</p>
<p>Defaults to false.</p>
<p>Optional.</p>
<h3 id="non-feature-branches"><a class="header" href="#non-feature-branches">non-feature-branches</a></h3>
<p>A list of regex patterns of branch names that are non-numeric (e.g. &quot;latest&quot; or something),
that will NOT be handled as feature branches. This is an array of strings.</p>
<p>If you have non-numeric branch names, for example like &quot;latest&quot;, &quot;current&quot;, &quot;latest-stable&quot;
or something, that do not look like a version number, then Composer handles such branches
as feature branches. This means it searches for parent branches, that look like a version
or ends at special branches (like master), and the root package version number becomes the
version of the parent branch or at least master or something.</p>
<p>To handle non-numeric named branches as versions instead of searching for a parent branch
with a valid version or special branch name like master, you can set patterns for branch
names that should be handled as dev version branches.</p>
<p>This is really helpful when you have dependencies using &quot;self.version&quot;, so that not dev-master,
but the same branch is installed (in the example: latest-testing).</p>
<p>An example:</p>
<p>If you have a testing branch, that is heavily maintained during a testing phase and is
deployed to your staging environment, normally <code>composer show -s</code> will give you <code>versions : * dev-master</code>.</p>
<p>If you configure <code>latest-.*</code> as a pattern for non-feature-branches like this:</p>
<pre><code class="language-json">{
    &quot;non-feature-branches&quot;: [&quot;latest-.*&quot;]
}
</code></pre>
<p>Then <code>composer show -s</code> will give you <code>versions : * dev-latest-testing</code>.</p>
<p>Optional.</p>
<p>← <a href="pt-br/03-cli.html">Command-line interface</a>  |  <a href="pt-br/05-repositories.html">Repositories</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="repositories"><a class="header" href="#repositories">Repositories</a></h1>
<p>This chapter will explain the concept of packages and repositories, what kinds
of repositories are available, and how they work.</p>
<h2 id="concepts"><a class="header" href="#concepts">Concepts</a></h2>
<p>Before we look at the different types of repositories that exist, we need to
understand some basic concepts that Composer is built on.</p>
<h3 id="package"><a class="header" href="#package">Package</a></h3>
<p>Composer is a dependency manager. It installs packages locally. A package is
essentially a directory containing something. In this case it is PHP
code, but in theory it could be anything. And it contains a package
description which has a name and a version. The name and the version are used
to identify the package.</p>
<p>In fact, internally Composer sees every version as a separate package. While
this distinction does not matter when you are using Composer, it's quite
important when you want to change it.</p>
<p>In addition to the name and the version, there is useful metadata. The
information most relevant for installation is the source definition, which
describes where to get the package contents. The package data points to the
contents of the package. And there are two options here: dist and source.</p>
<p><strong>Dist:</strong> The dist is a packaged version of the package data. Usually a
released version, usually a stable release.</p>
<p><strong>Source:</strong> The source is used for development. This will usually originate
from a source code repository, such as git. You can fetch this when you want
to modify the downloaded package.</p>
<p>Packages can supply either of these, or even both. Depending on certain
factors, such as user-supplied options and stability of the package, one will
be preferred.</p>
<h3 id="repository"><a class="header" href="#repository">Repository</a></h3>
<p>A repository is a package source. It's a list of packages/versions. Composer
will look in all your repositories to find the packages your project requires.</p>
<p>By default, only the Packagist.org repository is registered in Composer. You can
add more repositories to your project by declaring them in <code>composer.json</code>.</p>
<p>Repositories are only available to the root package and the repositories
defined in your dependencies will not be loaded. Read the
<a href="pt-br/faqs/why-cant-composer-load-repositories-recursively.html">FAQ entry</a> if you
want to learn why.</p>
<p>When resolving dependencies, packages are looked up from repositories from
top to bottom, and by default, as soon as a package is found in one, Composer
stops looking in other repositories. Read the
<a href="pt-br/articles/repository-priorities.html">repository priorities</a> article for more
details and to see how to change this behavior.</p>
<h2 id="types"><a class="header" href="#types">Types</a></h2>
<h3 id="composer-1"><a class="header" href="#composer-1">Composer</a></h3>
<p>The main repository type is the <code>composer</code> repository. It uses a single
<code>packages.json</code> file that contains all of the package metadata.</p>
<p>This is also the repository type that packagist uses. To reference a
<code>composer</code> repository, supply the path before the <code>packages.json</code> file.
In the case of packagist, that file is located at <code>/packages.json</code>, so the URL of
the repository would be <code>repo.packagist.org</code>. For <code>example.org/packages.json</code> the
repository URL would be <code>example.org</code>.</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;
        }
    ]
}
</code></pre>
<h4 id="packages"><a class="header" href="#packages">packages</a></h4>
<p>The only required field is <code>packages</code>. The JSON structure is as follows:</p>
<pre><code class="language-json">{
    &quot;packages&quot;: {
        &quot;vendor/package-name&quot;: {
            &quot;dev-master&quot;: { @composer.json },
            &quot;1.0.x-dev&quot;: { @composer.json },
            &quot;0.0.1&quot;: { @composer.json },
            &quot;1.0.0&quot;: { @composer.json }
        }
    }
}
</code></pre>
<p>The <code>@composer.json</code> marker would be the contents of the <code>composer.json</code> from
that package version including as a minimum:</p>
<ul>
<li>name</li>
<li>version</li>
<li>dist or source</li>
</ul>
<p>Here is a minimal package definition:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;smarty/smarty&quot;,
    &quot;version&quot;: &quot;3.1.7&quot;,
    &quot;dist&quot;: {
        &quot;url&quot;: &quot;https://www.smarty.net/files/Smarty-3.1.7.zip&quot;,
        &quot;type&quot;: &quot;zip&quot;
    }
}
</code></pre>
<p>It may include any of the other fields specified in the <a href="pt-br/04-schema.html">schema</a>.</p>
<h4 id="notify-batch"><a class="header" href="#notify-batch">notify-batch</a></h4>
<p>The <code>notify-batch</code> field allows you to specify a URL that will be called
every time a user installs a package. The URL can be either an absolute path
(that will use the same domain as the repository), or a fully qualified URL.</p>
<p>An example value:</p>
<pre><code class="language-json">{
    &quot;notify-batch&quot;: &quot;/downloads/&quot;
}
</code></pre>
<p>For <code>example.org/packages.json</code> containing a <code>monolog/monolog</code> package, this
would send a <code>POST</code> request to <code>example.org/downloads/</code> with following
JSON request body:</p>
<pre><code class="language-json">{
    &quot;downloads&quot;: [
        {&quot;name&quot;: &quot;monolog/monolog&quot;, &quot;version&quot;: &quot;1.2.1.0&quot;}
    ]
}
</code></pre>
<p>The version field will contain the normalized representation of the version
number.</p>
<p>This field is optional.</p>
<h3 id="metadata-url-available-packages-and-available-package-patterns"><a class="header" href="#metadata-url-available-packages-and-available-package-patterns">metadata-url, available-packages and available-package-patterns</a></h3>
<p>The <code>metadata-url</code> field allows you to provide a URL template to serve all
packages which are in the repository. It must contain the placeholder
<code>%package%</code>.</p>
<p>This field is new in Composer v2, and is prioritised over the
<code>provider-includes</code> and <code>providers-url</code> fields if both are present.
For compatibility with both Composer v1 and v2 you ideally want
to provide both. New repository implementations may only need to
support v2 however.</p>
<p>An example:</p>
<pre><code class="language-json">{
    &quot;metadata-url&quot;: &quot;/p2/%package%.json&quot;
}
</code></pre>
<p>Whenever Composer looks for a package, it will replace <code>%package%</code> by the
package name, and fetch that URL. If dev stability is allowed for the package,
it will also load the URL again with <code>$packageName~dev</code> (e.g.
<code>/p2/foo/bar~dev.json</code> to look for <code>foo/bar</code>'s dev versions).</p>
<p>The <code>foo/bar.json</code> and <code>foo/bar~dev.json</code> files containing package versions
MUST contain only versions for the foo/bar package, as
<code>{&quot;packages&quot;:{&quot;foo/bar&quot;:[ ... versions here ... ]}}</code>.</p>
<p>Caching is done via the use of If-Modified-Since header, so make sure you
return Last-Modified headers and that they are accurate.</p>
<p>The array of versions can also optionally be minified using
<code>Composer\MetadataMinifier\MetadataMinifier::minify()</code> from
<a href="https://packagist.org/packages/composer/metadata-minifier">composer/metadata-minifier</a>.
If you do that, you should add a <code>&quot;minified&quot;: &quot;composer/2.0&quot;</code> key
at the top level to indicate to Composer it must expand the version
list back into the original data. See
https://repo.packagist.org/p2/monolog/monolog.json for an example.</p>
<p>Any requested package which does not exist MUST return a 404 status code,
which will indicate to Composer that this package does not exist in your
repository. Make sure the 404 response is fast to avoid blocking Composer.
Avoid redirects to alternative 404 pages.</p>
<p>If your repository only has a small number of packages, and you want to avoid
the 404-requests, you can also specify an <code>&quot;available-packages&quot;</code> key in
<code>packages.json</code> which should be an array with all the package names that your
repository contains. Alternatively you can specify an
<code>&quot;available-package-patterns&quot;</code> key which is an array of package name patterns
(with <code>*</code> matching any string, e.g. <code>vendor/*</code> would make Composer look up
every matching package name in this repository).</p>
<p>This field is optional.</p>
<h3 id="providers-api"><a class="header" href="#providers-api">providers-api</a></h3>
<p>The <code>providers-api</code> field allows you to provide a URL template to serve all
packages which provide a given package name, but not the package which has
that name. It must contain the placeholder <code>%package%</code>.</p>
<p>For example https://packagist.org/providers/monolog/monolog.json lists some
package which have a &quot;provide&quot; rule for monolog/monolog, but it does not list
monolog/monolog itself.</p>
<pre><code class="language-json">{
    &quot;providers-api&quot;: &quot;https://packagist.org/providers/%package%.json&quot;,
}
</code></pre>
<p>This field is optional.</p>
<h3 id="list"><a class="header" href="#list">list</a></h3>
<p>The <code>list</code> field allows you to return the names of packages which match a
given field (or all names if no filter is present). It should accept an
optional <code>?filter=xx</code> query param, which can contain <code>*</code> as wildcards matching
any substring.</p>
<p>Replace/provide rules should not be considered here.</p>
<p>It must return an array of package names:</p>
<pre><code class="language-json">{
    &quot;packageNames&quot;: [
        &quot;a/b&quot;,
        &quot;c/d&quot;
    ]
}
</code></pre>
<p>See <a href="https://packagist.org/packages/list.json?filter=composer/*">https://packagist.org/packages/list.json?filter=composer/*</a> for example.</p>
<p>This field is optional.</p>
<h4 id="provider-includes-and-providers-url"><a class="header" href="#provider-includes-and-providers-url">provider-includes and providers-url</a></h4>
<p>The <code>provider-includes</code> field allows you to list a set of files that list
package names provided by this repository. The hash should be a sha256 of
the files in this case.</p>
<p>The <code>providers-url</code> describes how provider files are found on the server. It
is an absolute path from the repository root. It must contain the placeholders
<code>%package%</code> and <code>%hash%</code>.</p>
<p>These fields are used by Composer v1, or if your repository does not have the
<code>metadata-url</code> field set.</p>
<p>An example:</p>
<pre><code class="language-json">{
    &quot;provider-includes&quot;: {
        &quot;providers-a.json&quot;: {
            &quot;sha256&quot;: &quot;f5b4bc0b354108ef08614e569c1ed01a2782e67641744864a74e788982886f4c&quot;
        },
        &quot;providers-b.json&quot;: {
            &quot;sha256&quot;: &quot;b38372163fac0573053536f5b8ef11b86f804ea8b016d239e706191203f6efac&quot;
        }
    },
    &quot;providers-url&quot;: &quot;/p/%package%$%hash%.json&quot;
}
</code></pre>
<p>Those files contain lists of package names and hashes to verify the file
integrity, for example:</p>
<pre><code class="language-json">{
    &quot;providers&quot;: {
        &quot;acme/foo&quot;: {
            &quot;sha256&quot;: &quot;38968de1305c2e17f4de33aea164515bc787c42c7e2d6e25948539a14268bb82&quot;
        },
        &quot;acme/bar&quot;: {
            &quot;sha256&quot;: &quot;4dd24c930bd6e1103251306d6336ac813b563a220d9ca14f4743c032fb047233&quot;
        }
    }
}
</code></pre>
<p>The file above declares that acme/foo and acme/bar can be found in this
repository, by loading the file referenced by <code>providers-url</code>, replacing
<code>%package%</code> by the vendor namespaced package name and <code>%hash%</code> by the
sha256 field. Those files themselves contain package definitions as
described <a href="pt-br/05-repositorios.html#packages">above</a>.</p>
<p>These fields are optional. You probably don't need them for your own custom
repository.</p>
<h4 id="curl-or-stream-options"><a class="header" href="#curl-or-stream-options">cURL or stream options</a></h4>
<p>The repository is accessed either using cURL (Composer 2 with ext-curl enabled)
or PHP streams. You can set extra options using the <code>options</code> parameter. For
PHP streams, you can set any valid PHP stream context option. See <a href="https://php.net/manual/en/context.php">Context
options and parameters</a> for more
information. When cURL is used, only a limited set of <code>http</code> and <code>ssl</code> options
can be configured.</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;,
            &quot;options&quot;: {
                &quot;http&quot;: {
                    &quot;timeout&quot;: 60
                }
            }
        }
    ],
    &quot;require&quot;: {
        &quot;acme/package&quot;: &quot;^1.0&quot;
    }
}
</code></pre>
<h3 id="vcs"><a class="header" href="#vcs">VCS</a></h3>
<p>VCS stands for version control system. This includes versioning systems like
git, svn, fossil or hg. Composer has a repository type for installing packages
from these systems.</p>
<h4 id="loading-a-package-from-a-vcs-repository"><a class="header" href="#loading-a-package-from-a-vcs-repository">Loading a package from a VCS repository</a></h4>
<p>There are a few use cases for this. The most common one is maintaining your
own fork of a third party library. If you are using a certain library for your
project, and you decide to change something in the library, you will want your
project to use the patched version. If the library is on GitHub (this is the
case most of the time), you can fork it there and push your changes to
your fork. After that you update the project's <code>composer.json</code>. All you have
to do is add your fork as a repository and update the version constraint to
point to your custom branch. In <code>composer.json</code> only, you should prefix your
custom branch name with <code>&quot;dev-&quot;</code> (without making it part of the actual branch
name). For version constraint naming conventions see
<a href="pt-br/02-libraries.html">Libraries</a> for more information.</p>
<p>Example assuming you patched monolog to fix a bug in the <code>bugfix</code> branch:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;https://github.com/igorw/monolog&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;dev-bugfix&quot;
    }
}
</code></pre>
<p>When you run <code>php composer.phar update</code>, you should get your modified version
of <code>monolog/monolog</code> instead of the one from packagist.</p>
<p>Note that you should not rename the package unless you really intend to fork
it in the long term, and completely move away from the original package.
Composer will correctly pick your package over the original one since the
custom repository has priority over packagist. If you want to rename the
package, you should do so in the default (often master) branch and not in a
feature branch, since the package name is taken from the default branch.</p>
<p>Also note that the override will not work if you change the <code>name</code> property
in your forked repository's <code>composer.json</code> file as this needs to match the
original for the override to work.</p>
<p>If other dependencies rely on the package you forked, it is possible to
inline-alias it so that it matches a constraint that it otherwise would not.
For more information <a href="pt-br/articles/aliases.html">see the aliases article</a>.</p>
<h4 id="using-private-repositories"><a class="header" href="#using-private-repositories">Using private repositories</a></h4>
<p>Exactly the same solution allows you to work with your private repositories at
GitHub and Bitbucket:</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;vendor/my-private-repo&quot;: &quot;dev-master&quot;
    },
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;:  &quot;git@bitbucket.org:vendor/my-private-repo.git&quot;
        }
    ]
}
</code></pre>
<p>The only requirement is the installation of SSH keys for a git client.</p>
<h4 id="git-alternatives"><a class="header" href="#git-alternatives">Git alternatives</a></h4>
<p>Git is not the only version control system supported by the VCS repository.
The following are supported:</p>
<ul>
<li><strong>Git:</strong> <a href="https://git-scm.com">git-scm.com</a></li>
<li><strong>Subversion:</strong> <a href="https://subversion.apache.org">subversion.apache.org</a></li>
<li><strong>Mercurial:</strong> <a href="https://www.mercurial-scm.org">mercurial-scm.org</a></li>
<li><strong>Fossil</strong>: <a href="https://www.fossil-scm.org/">fossil-scm.org</a></li>
</ul>
<p>To get packages from these systems you need to have their respective clients
installed. That can be inconvenient. And for this reason there is special
support for GitHub and Bitbucket that use the APIs provided by these sites, to
fetch the packages without having to install the version control system. The
VCS repository provides <code>dist</code>s for them that fetch the packages as zips.</p>
<ul>
<li><strong>GitHub:</strong> <a href="https://github.com">github.com</a> (Git)</li>
<li><strong>Bitbucket:</strong> <a href="https://bitbucket.org">bitbucket.org</a> (Git)</li>
</ul>
<p>The VCS driver to be used is detected automatically based on the URL. However,
should you need to specify one for whatever reason, you can use <code>bitbucket</code>,
<code>github</code>, <code>gitlab</code>, <code>perforce</code>, <code>fossil</code>, <code>git</code>, <code>svn</code> or <code>hg</code>
as the repository type instead of <code>vcs</code>.</p>
<p>If you set the <code>no-api</code> key to <code>true</code> on a github repository it will clone the
repository as it would with any other git repository instead of using the
GitHub API. But unlike using the <code>git</code> driver directly, Composer will still
attempt to use github's zip files.</p>
<p>Please note:</p>
<ul>
<li><strong>To let Composer choose which driver to use</strong> the repository type needs to be defined as &quot;vcs&quot;</li>
<li><strong>If you already used a private repository</strong>, this means Composer should have cloned it in cache. If you want to install the same package with drivers, remember to launch the command <code>composer clearcache</code> followed by the command <code>composer update</code> to update Composer cache and install the package from dist.</li>
<li>VCS driver <code>git-bitbucket</code> is deprecated in favor of <code>bitbucket</code></li>
</ul>
<h4 id="bitbucket-driver-configuration"><a class="header" href="#bitbucket-driver-configuration">Bitbucket Driver Configuration</a></h4>
<blockquote>
<p><strong>Note that the repository endpoint for Bitbucket needs to be https rather than git.</strong></p>
</blockquote>
<p>After setting up your bitbucket repository, you will also need to
<a href="pt-br/articles/authentication-for-private-packages.html#bitbucket-oauth">set up authentication</a>.</p>
<h4 id="subversion-options"><a class="header" href="#subversion-options">Subversion Options</a></h4>
<p>Since Subversion has no native concept of branches and tags, Composer assumes
by default that code is located in <code>$url/trunk</code>, <code>$url/branches</code> and
<code>$url/tags</code>. If your repository has a different layout you can change those
values. For example if you used capitalized names you could configure the
repository like this:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;http://svn.example.org/projectA/&quot;,
            &quot;trunk-path&quot;: &quot;Trunk&quot;,
            &quot;branches-path&quot;: &quot;Branches&quot;,
            &quot;tags-path&quot;: &quot;Tags&quot;
        }
    ]
}
</code></pre>
<p>If you have no branches or tags directory you can disable them entirely by
setting the <code>branches-path</code> or <code>tags-path</code> to <code>false</code>.</p>
<p>If the package is in a subdirectory, e.g. <code>/trunk/foo/bar/composer.json</code> and
<code>/tags/1.0/foo/bar/composer.json</code>, then you can make Composer access it by
setting the <code>&quot;package-path&quot;</code> option to the sub-directory, in this example it
would be <code>&quot;package-path&quot;: &quot;foo/bar/&quot;</code>.</p>
<p>If you have a private Subversion repository you can save credentials in the
http-basic section of your config (See <a href="pt-br/04-schema.html">Schema</a>):</p>
<pre><code class="language-json">{
    &quot;http-basic&quot;: {
        &quot;svn.example.org&quot;: {
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;
        }
    }
}
</code></pre>
<p>If your Subversion client is configured to store credentials by default these
credentials will be saved for the current user and existing saved credentials
for this server will be overwritten. To change this behavior by setting the
<code>&quot;svn-cache-credentials&quot;</code> option in your repository configuration:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;http://svn.example.org/projectA/&quot;,
            &quot;svn-cache-credentials&quot;: false
        }
    ]
}
</code></pre>
<h3 id="package-1"><a class="header" href="#package-1">Package</a></h3>
<p>If you want to use a project that does not support Composer through any of the
means above, you still can define the package yourself by using a <code>package</code>
repository.</p>
<p>Basically, you define the same information that is included in the <code>composer</code>
repository's <code>packages.json</code>, but only for a single package. Again, the
minimum required fields are <code>name</code>, <code>version</code>, and either of <code>dist</code> or
<code>source</code>.</p>
<p>Here is an example for the smarty template engine:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;package&quot;,
            &quot;package&quot;: {
                &quot;name&quot;: &quot;smarty/smarty&quot;,
                &quot;version&quot;: &quot;3.1.7&quot;,
                &quot;dist&quot;: {
                    &quot;url&quot;: &quot;https://www.smarty.net/files/Smarty-3.1.7.zip&quot;,
                    &quot;type&quot;: &quot;zip&quot;
                },
                &quot;source&quot;: {
                    &quot;url&quot;: &quot;http://smarty-php.googlecode.com/svn/&quot;,
                    &quot;type&quot;: &quot;svn&quot;,
                    &quot;reference&quot;: &quot;tags/Smarty_3_1_7/distribution/&quot;
                },
                &quot;autoload&quot;: {
                    &quot;classmap&quot;: [&quot;libs/&quot;]
                }
            }
        }
    ],
    &quot;require&quot;: {
        &quot;smarty/smarty&quot;: &quot;3.1.*&quot;
    }
}
</code></pre>
<p>Typically, you would leave the source part off, as you don't really need it.</p>
<blockquote>
<p><strong>Note</strong>: This repository type has a few limitations and should be avoided
whenever possible:</p>
<ul>
<li>Composer will not update the package unless you change the <code>version</code> field.</li>
<li>Composer will not update the commit references, so if you use <code>master</code> as
reference you will have to delete the package to force an update, and will
have to deal with an unstable lock file.</li>
</ul>
</blockquote>
<p>The <code>&quot;package&quot;</code> key in a <code>package</code> repository may be set to an array to define multiple versions of a package:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;package&quot;,
            &quot;package&quot;: [
                {
                    &quot;name&quot;: &quot;foo/bar&quot;,
                    &quot;version&quot;: &quot;1.0.0&quot;,
                    ...
                },
                {
                    &quot;name&quot;: &quot;foo/bar&quot;,
                    &quot;version&quot;: &quot;2.0.0&quot;,
                    ...
                }
            ]
        }
    ]
}
</code></pre>
<h2 id="hosting-your-own"><a class="header" href="#hosting-your-own">Hosting your own</a></h2>
<p>While you will probably want to put your packages on packagist most of the
time, there are some use cases for hosting your own repository.</p>
<ul>
<li>
<p><strong>Private company packages:</strong> If you are part of a company that uses Composer
for their packages internally, you might want to keep those packages private.</p>
</li>
<li>
<p><strong>Separate ecosystem:</strong> If you have a project which has its own ecosystem,
and the packages aren't really reusable by the greater PHP community, you
might want to keep them separate to packagist. An example of this would be
wordpress plugins.</p>
</li>
</ul>
<p>For hosting your own packages, a native <code>composer</code> type of repository is
recommended, which provides the best performance.</p>
<p>There are a few tools that can help you create a <code>composer</code> repository.</p>
<h3 id="private-packagist"><a class="header" href="#private-packagist">Private Packagist</a></h3>
<p><a href="https://packagist.com/">Private Packagist</a> is a hosted or self-hosted
application providing private package hosting as well as mirroring of
GitHub, Packagist.org and other package repositories.</p>
<p>Check out <a href="https://packagist.com/">Packagist.com</a> for more information.</p>
<h3 id="satis"><a class="header" href="#satis">Satis</a></h3>
<p>Satis is a static <code>composer</code> repository generator. It is a bit like an ultra-
lightweight, static file-based version of packagist.</p>
<p>You give it a <code>composer.json</code> containing repositories, typically VCS and
package repository definitions. It will fetch all the packages that are
<code>require</code>d and dump a <code>packages.json</code> that is your <code>composer</code> repository.</p>
<p>Check <a href="https://github.com/composer/satis">the satis GitHub repository</a> and
the <a href="pt-br/articles/handling-private-packages.html">handling private packages article</a> for more
information.</p>
<h3 id="artifact"><a class="header" href="#artifact">Artifact</a></h3>
<p>There are some cases, when there is no ability to have one of the previously
mentioned repository types online, even the VCS one. A typical example could be
cross-organisation library exchange through build artifacts. Of course, most
of the time these are private. To use these archives as-is, one can use a
repository of type <code>artifact</code> with a folder containing ZIP or TAR archives of
those private packages:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;artifact&quot;,
            &quot;url&quot;: &quot;path/to/directory/with/zips/&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;private-vendor-one/core&quot;: &quot;15.6.2&quot;,
        &quot;private-vendor-two/connectivity&quot;: &quot;*&quot;,
        &quot;acme-corp/parser&quot;: &quot;10.3.5&quot;
    }
}
</code></pre>
<p>Each zip artifact is a ZIP archive with <code>composer.json</code> in root folder:</p>
<pre><code class="language-sh">unzip -l acme-corp-parser-10.3.5.zip

composer.json
...
</code></pre>
<p>If there are two archives with different versions of a package, they are both
imported. When an archive with a newer version is added in the artifact folder
and you run <code>update</code>, that version will be imported as well and Composer will
update to the latest version.</p>
<h3 id="path"><a class="header" href="#path">Path</a></h3>
<p>In addition to the artifact repository, you can use the path one, which allows
you to depend on a local directory, either absolute or relative. This can be
especially useful when dealing with monolithic repositories.</p>
<p>For instance, if you have the following directory structure in your repository:</p>
<pre><code>...
├── apps
│   └── my-app
│       └── composer.json
├── packages
│   └── my-package
│       └── composer.json
...
</code></pre>
<p>Then, to add the package <code>my/package</code> as a dependency, in your
<code>apps/my-app/composer.json</code> file, you can use the following configuration:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;path&quot;,
            &quot;url&quot;: &quot;../../packages/my-package&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;my/package&quot;: &quot;*&quot;
    }
}
</code></pre>
<p>If the package is a local VCS repository, the version may be inferred by
the branch or tag that is currently checked out. Otherwise, the version should
be explicitly defined in the package's <code>composer.json</code> file. If the version
cannot be resolved by these means, it is assumed to be <code>dev-master</code>.</p>
<p>When the version cannot be inferred from the local VCS repository, or when you
want to override the version, you can use the <code>versions</code> option when declaring
the repository:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;path&quot;,
            &quot;url&quot;: &quot;../../packages/my-package&quot;,
            &quot;options&quot;: {
                &quot;versions&quot;: {
                    &quot;my/package&quot;: &quot;4.2-dev&quot;
                }
            }
        }
    ]
}
</code></pre>
<p>The local package will be symlinked if possible, in which case the output in
the console will read <code>Symlinking from ../../packages/my-package</code>. If symlinking
is <em>not</em> possible the package will be copied. In that case, the console will
output <code>Mirrored from ../../packages/my-package</code>.</p>
<p>Instead of default fallback strategy you can force to use symlink with
<code>&quot;symlink&quot;: true</code> or mirroring with <code>&quot;symlink&quot;: false</code> option. Forcing
mirroring can be useful when deploying or generating package from a
monolithic repository.</p>
<blockquote>
<p><strong>Note:</strong> On Windows, directory symlinks are implemented using NTFS junctions
because they can be created by non-admin users. Mirroring will always be used
on versions below Windows 7 or if <code>proc_open</code> has been disabled.</p>
</blockquote>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;path&quot;,
            &quot;url&quot;: &quot;../../packages/my-package&quot;,
            &quot;options&quot;: {
                &quot;symlink&quot;: false
            }
        }
    ]
}
</code></pre>
<p>Leading tildes are expanded to the current user's home folder, and environment
variables are parsed in both Windows and Linux/Mac notations. For example
<code>~/git/mypackage</code> will automatically load the mypackage clone from
<code>/home/&lt;username&gt;/git/mypackage</code>, equivalent to <code>$HOME/git/mypackage</code> or
<code>%USERPROFILE%/git/mypackage</code>.</p>
<blockquote>
<p><strong>Note:</strong> Repository paths can also contain wildcards like <code>*</code> and <code>?</code>.
For details, see the <a href="https://php.net/glob">PHP glob function</a>.</p>
</blockquote>
<p>You can configure the way the package's dist reference (which appears in
the composer.lock file) is built.</p>
<p>The following modes exist:</p>
<ul>
<li><code>none</code> - reference will be always null. This can help reduce lock file conflicts
in the lock file but reduces clarity as to when the last update happened and whether
the package is in the latest state.</li>
<li><code>config</code> - reference is built based on a hash of the package's composer.json and repo config</li>
<li><code>auto</code> (used by default) - reference is built basing on the hash like with <code>config</code>, but if
the package folder contains a git repository, the HEAD commit's hash is used as reference instead.</li>
</ul>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;path&quot;,
            &quot;url&quot;: &quot;../../packages/my-package&quot;,
            &quot;options&quot;: {
                &quot;reference&quot;: &quot;config&quot;
            }
        }
    ]
}
</code></pre>
<h2 id="disabling-packagistorg"><a class="header" href="#disabling-packagistorg">Disabling Packagist.org</a></h2>
<p>You can disable the default Packagist.org repository by adding this to your
<code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;packagist.org&quot;: false
        }
    ]
}
</code></pre>
<p>You can disable Packagist.org globally by using the global config flag:</p>
<pre><code class="language-bash">php composer.phar config -g repo.packagist false
</code></pre>
<p>← <a href="pt-br/04-schema.html">Schema</a>  |  <a href="pt-br/06-config.html">Config</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="config-1"><a class="header" href="#config-1">Config</a></h1>
<p>This chapter will describe the <code>config</code> section of the <code>composer.json</code>
<a href="pt-br/04-schema.html">schema</a>.</p>
<h2 id="process-timeout"><a class="header" href="#process-timeout">process-timeout</a></h2>
<p>The timeout in seconds for process executions, defaults to 300 (5mins).
The duration processes like git clones can run before
Composer assumes they died out. You may need to make this higher if you have a
slow connection or huge vendors.</p>
<p>To disable the process timeout on a custom command under <code>scripts</code>, a static
helper is available:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: [
            &quot;Composer\\Config::disableProcessTimeout&quot;,
            &quot;phpunit&quot;
        ]
    }
}
</code></pre>
<h2 id="allow-plugins"><a class="header" href="#allow-plugins">allow-plugins</a></h2>
<p>Defaults to <code>null</code> (allow all plugins implicitly) for backwards compatibility until July 2022.
At that point the default will become <code>{}</code> and plugins will not load anymore unless allowed.</p>
<p>As of Composer 2.2.0, the <code>allow-plugins</code> option adds a layer of security
allowing you to restrict which Composer plugins are able to execute code during
a Composer run.</p>
<p>When a new plugin is first activated, which is not yet listed in the config option,
Composer will print a warning. If you run Composer interactively it will
prompt you to decide if you want to execute the plugin or not.</p>
<p>Use this setting to allow only packages you trust to execute code. Set it to
an object with package name patterns as keys. The values are <strong>true</strong> to allow
and <strong>false</strong> to disallow while suppressing further warnings and prompts.</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;allow-plugins&quot;: {
            &quot;third-party/required-plugin&quot;: true,
            &quot;my-organization/*&quot;: true,
            &quot;unnecessary/plugin&quot;: false
        }
    }
}
</code></pre>
<p>You can also set the config option itself to <code>false</code> to disallow all plugins, or <code>true</code> to allow all plugins to run (NOT recommended).</p>
<h2 id="use-include-path"><a class="header" href="#use-include-path">use-include-path</a></h2>
<p>Defaults to <code>false</code>. If <code>true</code>, the Composer autoloader will also look for classes
in the PHP include path.</p>
<h2 id="preferred-install"><a class="header" href="#preferred-install">preferred-install</a></h2>
<p>Defaults to <code>dist</code> and can be any of <code>source</code>, <code>dist</code> or <code>auto</code>. This option
allows you to set the install method Composer will prefer to use. Can
optionally be an object with package name patterns for keys for more granular install preferences.</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;preferred-install&quot;: {
            &quot;my-organization/stable-package&quot;: &quot;dist&quot;,
            &quot;my-organization/*&quot;: &quot;source&quot;,
            &quot;partner-organization/*&quot;: &quot;auto&quot;,
            &quot;*&quot;: &quot;dist&quot;
        }
    }
}
</code></pre>
<ul>
<li><code>source</code> means Composer will install packages from their <code>source</code> if there
is one. This is typically a git clone or equivalent checkout of the version
control system the package uses. This is useful if you want to make a bugfix
to a project and get a local git clone of the dependency directly.</li>
<li><code>auto</code> is the legacy behavior where Composer uses <code>source</code> automatically
for dev versions, and <code>dist</code> otherwise.</li>
<li><code>dist</code> (the default as of Composer 2.1) means Composer installs from <code>dist</code>,
where possible. This is typically a zip file download, which is faster than
cloning the entire repository.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Order matters. More specific patterns should be earlier than
more relaxed patterns. When mixing the string notation with the hash
configuration in global and package configurations the string notation
is translated to a <code>*</code> package pattern.</p>
</blockquote>
<h2 id="use-parent-dir"><a class="header" href="#use-parent-dir">use-parent-dir</a></h2>
<p>When running Composer in a directory where there is no composer.json, if there
is one present in a directory above Composer will by default ask you whether
you want to use that directory's composer.json instead.</p>
<p>If you always want to answer yes to this prompt, you can set this config value
to <code>true</code>. To never be prompted, set it to <code>false</code>. The default is <code>&quot;prompt&quot;</code>.</p>
<blockquote>
<p><strong>Note:</strong> This config must be set in your global user-wide config for it
to work. Use for example <code>php composer.phar config --global use-parent-dir true</code>
to set it.</p>
</blockquote>
<h2 id="store-auths"><a class="header" href="#store-auths">store-auths</a></h2>
<p>What to do after prompting for authentication, one of: <code>true</code> (always store),
<code>false</code> (do not store) and <code>&quot;prompt&quot;</code> (ask every time), defaults to <code>&quot;prompt&quot;</code>.</p>
<h2 id="github-protocols"><a class="header" href="#github-protocols">github-protocols</a></h2>
<p>Defaults to <code>[&quot;https&quot;, &quot;ssh&quot;, &quot;git&quot;]</code>. A list of protocols to use when cloning
from github.com, in priority order. By default <code>git</code> is present but only if <a href="pt-br/06-configuracao.html#secure-http">secure-http</a>
is disabled, as the git protocol is not encrypted. If you want your origin remote
push URLs to be using https and not ssh (<code>git@github.com:...</code>), then set the protocol
list to be only <code>[&quot;https&quot;]</code> and Composer will stop overwriting the push URL to an ssh
URL.</p>
<h2 id="github-oauth"><a class="header" href="#github-oauth">github-oauth</a></h2>
<p>A list of domain names and oauth keys. For example using <code>{&quot;github.com&quot;: &quot;oauthtoken&quot;}</code> as the value of this option will use <code>oauthtoken</code> to access
private repositories on github and to circumvent the low IP-based rate limiting
of their API. Composer may prompt for credentials when needed, but these can also be
manually set. Read more on how to get an OAuth token for GitHub and cli syntax
<a href="pt-br/articles/authentication-for-private-packages.html#github-oauth">here</a>.</p>
<h2 id="gitlab-domains"><a class="header" href="#gitlab-domains">gitlab-domains</a></h2>
<p>Defaults to <code>[&quot;gitlab.com&quot;]</code>. A list of domains of GitLab servers.
This is used if you use the <code>gitlab</code> repository type.</p>
<h2 id="gitlab-oauth"><a class="header" href="#gitlab-oauth">gitlab-oauth</a></h2>
<p>A list of domain names and oauth keys. For example using <code>{&quot;gitlab.com&quot;: &quot;oauthtoken&quot;}</code> as the value of this option will use <code>oauthtoken</code> to access
private repositories on gitlab. Please note: If the package is not hosted at
gitlab.com the domain names must be also specified with the
<a href="pt-br/06-config.html#gitlab-domains"><code>gitlab-domains</code></a> option.
Further info can also be found <a href="pt-br/articles/authentication-for-private-packages.html#gitlab-oauth">here</a></p>
<h2 id="gitlab-token"><a class="header" href="#gitlab-token">gitlab-token</a></h2>
<p>A list of domain names and private tokens. Private token can be either simple
string, or array with username and token. For example using <code>{&quot;gitlab.com&quot;: &quot;privatetoken&quot;}</code> as the value of this option will use <code>privatetoken</code> to access
private repositories on gitlab. Using <code>{&quot;gitlab.com&quot;: {&quot;username&quot;: &quot;gitlabuser&quot;, &quot;token&quot;: &quot;privatetoken&quot;}}</code> will use both username and token for gitlab deploy
token functionality (https://docs.gitlab.com/ee/user/project/deploy_tokens/)
Please note: If the package is not hosted at
gitlab.com the domain names must be also specified with the
<a href="pt-br/06-config.html#gitlab-domains"><code>gitlab-domains</code></a> option. The token must have
<code>api</code> or <code>read_api</code> scope.
Further info can also be found <a href="pt-br/articles/authentication-for-private-packages.html#gitlab-token">here</a></p>
<h2 id="gitlab-protocol"><a class="header" href="#gitlab-protocol">gitlab-protocol</a></h2>
<p>A protocol to force use of when creating a repository URL for the <code>source</code>
value of the package metadata. One of <code>git</code> or <code>http</code>. (<code>https</code> is treated
as a synonym for <code>http</code>.) Helpful when working with projects referencing
private repositories which will later be cloned in GitLab CI jobs with a
<a href="https://docs.gitlab.com/ee/ci/variables/predefined_variables.html#predefined-variables-reference">GitLab CI_JOB_TOKEN</a>
using HTTP basic auth. By default, Composer will generate a git-over-SSH
URL for private repositories and HTTP(S) only for public.</p>
<h2 id="disable-tls"><a class="header" href="#disable-tls">disable-tls</a></h2>
<p>Defaults to <code>false</code>. If set to true all HTTPS URLs will be tried with HTTP
instead and no network level encryption is performed. Enabling this is a
security risk and is NOT recommended. The better way is to enable the
php_openssl extension in php.ini. Enabling this will implicitly disable the
<code>secure-http</code> option.</p>
<h2 id="secure-http"><a class="header" href="#secure-http">secure-http</a></h2>
<p>Defaults to <code>true</code>. If set to true only HTTPS URLs are allowed to be
downloaded via Composer. If you really absolutely need HTTP access to something
then you can disable it, but using <a href="https://letsencrypt.org/">Let's Encrypt</a> to
get a free SSL certificate is generally a better alternative.</p>
<h2 id="bitbucket-oauth"><a class="header" href="#bitbucket-oauth">bitbucket-oauth</a></h2>
<p>A list of domain names and consumers. For example using <code>{&quot;bitbucket.org&quot;: {&quot;consumer-key&quot;: &quot;myKey&quot;, &quot;consumer-secret&quot;: &quot;mySecret&quot;}}</code>.
Read more <a href="pt-br/articles/authentication-for-private-packages.html#bitbucket-oauth">here</a>.</p>
<h2 id="cafile"><a class="header" href="#cafile">cafile</a></h2>
<p>Location of Certificate Authority file on local filesystem. In PHP 5.6+ you
should rather set this via openssl.cafile in php.ini, although PHP 5.6+ should
be able to detect your system CA file automatically.</p>
<h2 id="capath"><a class="header" href="#capath">capath</a></h2>
<p>If cafile is not specified or if the certificate is not found there, the
directory pointed to by capath is searched for a suitable certificate.
capath must be a correctly hashed certificate directory.</p>
<h2 id="http-basic"><a class="header" href="#http-basic">http-basic</a></h2>
<p>A list of domain names and username/passwords to authenticate against them. For
example using <code>{&quot;example.org&quot;: {&quot;username&quot;: &quot;alice&quot;, &quot;password&quot;: &quot;foo&quot;}}</code> as the
value of this option will let Composer authenticate against example.org.
More info can be found <a href="pt-br/articles/authentication-for-private-packages.html#http-basic">here</a>.</p>
<h2 id="bearer"><a class="header" href="#bearer">bearer</a></h2>
<p>A list of domain names and tokens to authenticate against them. For example using
<code>{&quot;example.org&quot;: &quot;foo&quot;}</code> as the value of this option will let Composer authenticate
against example.org using an <code>Authorization: Bearer foo</code> header.</p>
<h2 id="platform"><a class="header" href="#platform">platform</a></h2>
<p>Lets you fake platform packages (PHP and extensions) so that you can emulate a
production env or define your target platform in the config. Example: <code>{&quot;php&quot;: &quot;7.0.3&quot;, &quot;ext-something&quot;: &quot;4.0.3&quot;}</code>.</p>
<p>This will make sure that no package requiring more than PHP 7.0.3 can be installed
regardless of the actual PHP version you run locally. However it also means
the dependencies are not checked correctly anymore, if you run PHP 5.6 it will
install fine as it assumes 7.0.3, but then it will fail at runtime. This also means if
<code>{&quot;php&quot;:&quot;7.4&quot;}</code> is specified; no packages will be used that define <code>7.4.1</code> as minimum.</p>
<p>Therefore if you use this it is recommended, and safer, to also run the
<a href="pt-br/03-cli.html#check-platform-reqs"><code>check-platform-reqs</code></a> command as part of your
deployment strategy.</p>
<p>If a dependency requires some extension that you do not have installed locally
you may ignore it instead by passing <code>--ignore-platform-req=ext-foo</code> to <code>update</code>,
<code>install</code> or <code>require</code>. In the long run though you should install required
extensions as if you ignore one now and a new package you add a month later also
requires it, you may introduce issues in production unknowingly.</p>
<p>If you have an extension installed locally but <em>not</em> on production, you may want
to artificially hide it from Composer using <code>{&quot;ext-foo&quot;: false}</code>.</p>
<h2 id="vendor-dir"><a class="header" href="#vendor-dir">vendor-dir</a></h2>
<p>Defaults to <code>vendor</code>. You can install dependencies into a different directory if
you want to. <code>$HOME</code> and <code>~</code> will be replaced by your home directory's path in
vendor-dir and all <code>*-dir</code> options below.</p>
<h2 id="bin-dir"><a class="header" href="#bin-dir">bin-dir</a></h2>
<p>Defaults to <code>vendor/bin</code>. If a project includes binaries, they will be symlinked
into this directory.</p>
<h2 id="data-dir"><a class="header" href="#data-dir">data-dir</a></h2>
<p>Defaults to <code>C:\Users\&lt;user&gt;\AppData\Roaming\Composer</code> on Windows,
<code>$XDG_DATA_HOME/composer</code> on unix systems that follow the XDG Base Directory
Specifications, and <code>$COMPOSER_HOME</code> on other unix systems. Right now it is only
used for storing past composer.phar files to be able to roll back to older
versions. See also <a href="pt-br/03-cli.html#composer-home">COMPOSER_HOME</a>.</p>
<h2 id="cache-dir"><a class="header" href="#cache-dir">cache-dir</a></h2>
<p>Defaults to <code>C:\Users\&lt;user&gt;\AppData\Local\Composer</code> on Windows,
<code>/Users/&lt;user&gt;/Library/Caches/composer</code> on macOS, <code>$XDG_CACHE_HOME/composer</code>
on unix systems that follow the XDG Base Directory Specifications, and
<code>$COMPOSER_HOME/cache</code> on other unix systems. Stores all the caches used by
Composer. See also <a href="pt-br/03-cli.html#composer-home">COMPOSER_HOME</a>.</p>
<h2 id="cache-files-dir"><a class="header" href="#cache-files-dir">cache-files-dir</a></h2>
<p>Defaults to <code>$cache-dir/files</code>. Stores the zip archives of packages.</p>
<h2 id="cache-repo-dir"><a class="header" href="#cache-repo-dir">cache-repo-dir</a></h2>
<p>Defaults to <code>$cache-dir/repo</code>. Stores repository metadata for the <code>composer</code>
type and the VCS repos of type <code>svn</code>, <code>fossil</code>, <code>github</code> and <code>bitbucket</code>.</p>
<h2 id="cache-vcs-dir"><a class="header" href="#cache-vcs-dir">cache-vcs-dir</a></h2>
<p>Defaults to <code>$cache-dir/vcs</code>. Stores VCS clones for loading VCS repository
metadata for the <code>git</code>/<code>hg</code> types and to speed up installs.</p>
<h2 id="cache-files-ttl"><a class="header" href="#cache-files-ttl">cache-files-ttl</a></h2>
<p>Defaults to <code>15552000</code> (6 months). Composer caches all dist (zip, tar, ...)
packages that it downloads. Those are purged after six months of being unused by
default. This option allows you to tweak this duration (in seconds) or disable
it completely by setting it to 0.</p>
<h2 id="cache-files-maxsize"><a class="header" href="#cache-files-maxsize">cache-files-maxsize</a></h2>
<p>Defaults to <code>300MiB</code>. Composer caches all dist (zip, tar, ...) packages that it
downloads. When the garbage collection is periodically ran, this is the maximum
size the cache will be able to use. Older (less used) files will be removed
first until the cache fits.</p>
<h2 id="cache-read-only"><a class="header" href="#cache-read-only">cache-read-only</a></h2>
<p>Defaults to <code>false</code>. Whether to use the Composer cache in read-only mode.</p>
<h2 id="bin-compat"><a class="header" href="#bin-compat">bin-compat</a></h2>
<p>Defaults to <code>auto</code>. Determines the compatibility of the binaries to be installed.
If it is <code>auto</code> then Composer only installs .bat proxy files when on Windows or WSL. If
set to <code>full</code> then both .bat files for Windows and scripts for Unix-based
operating systems will be installed for each binary. This is mainly useful if you
run Composer inside a linux VM but still want the <code>.bat</code> proxies available for use
in the Windows host OS. If set to <code>proxy</code> Composer will only create bash/Unix-style
proxy files and no .bat files even on Windows/WSL.</p>
<h2 id="prepend-autoloader"><a class="header" href="#prepend-autoloader">prepend-autoloader</a></h2>
<p>Defaults to <code>true</code>. If <code>false</code>, the Composer autoloader will not be prepended to
existing autoloaders. This is sometimes required to fix interoperability issues
with other autoloaders.</p>
<h2 id="autoloader-suffix"><a class="header" href="#autoloader-suffix">autoloader-suffix</a></h2>
<p>Defaults to <code>null</code>. Non-empty string to be used as a suffix for the generated
Composer autoloader. When null a random one will be generated.</p>
<h2 id="optimize-autoloader"><a class="header" href="#optimize-autoloader">optimize-autoloader</a></h2>
<p>Defaults to <code>false</code>. If <code>true</code>, always optimize when dumping the autoloader.</p>
<h2 id="sort-packages"><a class="header" href="#sort-packages">sort-packages</a></h2>
<p>Defaults to <code>false</code>. If <code>true</code>, the <code>require</code> command keeps packages sorted
by name in <code>composer.json</code> when adding a new package.</p>
<h2 id="classmap-authoritative"><a class="header" href="#classmap-authoritative">classmap-authoritative</a></h2>
<p>Defaults to <code>false</code>. If <code>true</code>, the Composer autoloader will only load classes
from the classmap. Implies <code>optimize-autoloader</code>.</p>
<h2 id="apcu-autoloader"><a class="header" href="#apcu-autoloader">apcu-autoloader</a></h2>
<p>Defaults to <code>false</code>. If <code>true</code>, the Composer autoloader will check for APCu and
use it to cache found/not-found classes when the extension is enabled.</p>
<h2 id="github-domains"><a class="header" href="#github-domains">github-domains</a></h2>
<p>Defaults to <code>[&quot;github.com&quot;]</code>. A list of domains to use in github mode. This is
used for GitHub Enterprise setups.</p>
<h2 id="github-expose-hostname"><a class="header" href="#github-expose-hostname">github-expose-hostname</a></h2>
<p>Defaults to <code>true</code>. If <code>false</code>, the OAuth tokens created to access the
github API will have a date instead of the machine hostname.</p>
<h2 id="use-github-api"><a class="header" href="#use-github-api">use-github-api</a></h2>
<p>Defaults to <code>true</code>.  Similar to the <code>no-api</code> key on a specific repository,
setting <code>use-github-api</code> to <code>false</code> will define the global behavior for all
GitHub repositories to clone the repository as it would with any other git
repository instead of using the GitHub API. But unlike using the <code>git</code>
driver directly, Composer will still attempt to use GitHub's zip files.</p>
<h2 id="notify-on-install"><a class="header" href="#notify-on-install">notify-on-install</a></h2>
<p>Defaults to <code>true</code>. Composer allows repositories to define a notification URL,
so that they get notified whenever a package from that repository is installed.
This option allows you to disable that behavior.</p>
<h2 id="discard-changes"><a class="header" href="#discard-changes">discard-changes</a></h2>
<p>Defaults to <code>false</code> and can be any of <code>true</code>, <code>false</code> or <code>&quot;stash&quot;</code>. This option
allows you to set the default style of handling dirty updates when in
non-interactive mode. <code>true</code> will always discard changes in vendors, while
<code>&quot;stash&quot;</code> will try to stash and reapply. Use this for CI servers or deploy
scripts if you tend to have modified vendors.</p>
<h2 id="archive-format"><a class="header" href="#archive-format">archive-format</a></h2>
<p>Defaults to <code>tar</code>. Overrides the default format used by the archive command.</p>
<h2 id="archive-dir"><a class="header" href="#archive-dir">archive-dir</a></h2>
<p>Defaults to <code>.</code>. Default destination for archives created by the archive
command.</p>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;archive-dir&quot;: &quot;/home/user/.composer/repo&quot;
    }
}
</code></pre>
<h2 id="htaccess-protect"><a class="header" href="#htaccess-protect">htaccess-protect</a></h2>
<p>Defaults to <code>true</code>. If set to <code>false</code>, Composer will not create <code>.htaccess</code> files
in the Composer home, cache, and data directories.</p>
<h2 id="lock"><a class="header" href="#lock">lock</a></h2>
<p>Defaults to <code>true</code>. If set to <code>false</code>, Composer will not create a <code>composer.lock</code>
file and will ignore it if one is present.</p>
<h2 id="platform-check"><a class="header" href="#platform-check">platform-check</a></h2>
<p>Defaults to <code>php-only</code> which only checks the PHP version. Set to <code>true</code> to also
check the presence of extension. If set to <code>false</code>, Composer will not create and
require a <code>platform_check.php</code> file as part of the autoloader bootstrap.</p>
<h2 id="secure-svn-domains"><a class="header" href="#secure-svn-domains">secure-svn-domains</a></h2>
<p>Defaults to <code>[]</code>. Lists domains which should be trusted/marked as using a secure
Subversion/SVN transport. By default svn:// protocol is seen as insecure and will
throw, but you can set this config option to <code>[&quot;example.org&quot;]</code> to allow using svn
URLs on that hostname. This is a better/safer alternative to disabling <code>secure-http</code>
altogether.</p>
<p>← <a href="pt-br/05-repositories.html">Repositories</a>  |  <a href="pt-br/07-runtime.html">Runtime</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="runtime-composer-utilities"><a class="header" href="#runtime-composer-utilities">Runtime Composer utilities</a></h1>
<p>While Composer is mostly used around your project to install its dependencies,
there are a few things which are made available to you at runtime.</p>
<p>If you need to rely on some of these in a specific version, you can require
the <code>composer-runtime-api</code> package.</p>
<h2 id="autoload-1"><a class="header" href="#autoload-1">Autoload</a></h2>
<p>The autoloader is the most used one, and is already covered in our
<a href="pt-br/01-basic-usage.html#autoloading">basic usage guide</a>. It is available in all
Composer versions.</p>
<h2 id="installed-versions"><a class="header" href="#installed-versions">Installed versions</a></h2>
<p>composer-runtime-api 2.0 introduced a new <code>Composer\InstalledVersions</code> class which offers
a few static methods to inspect which versions are currently installed. This is
automatically available to your code as long as you include the Composer autoloader.</p>
<p>The main use cases for this class are the following:</p>
<h3 id="knowing-whether-package-x-or-virtual-package-is-present"><a class="header" href="#knowing-whether-package-x-or-virtual-package-is-present">Knowing whether package X (or virtual package) is present</a></h3>
<pre><code class="language-php">\Composer\InstalledVersions::isInstalled('vendor/package'); // returns bool
\Composer\InstalledVersions::isInstalled('psr/log-implementation'); // returns bool
</code></pre>
<p>As of Composer 2.1, you may also check if something was installed via require-dev or not by
passing false as second argument:</p>
<pre><code class="language-php">\Composer\InstalledVersions::isInstalled('vendor/package'); // returns true assuming this package is installed
\Composer\InstalledVersions::isInstalled('vendor/package', false); // returns true if vendor/package is in require, false if in require-dev
</code></pre>
<p>Note that this can not be used to check whether platform packages are installed.</p>
<h3 id="knowing-whether-package-x-is-installed-in-version-y"><a class="header" href="#knowing-whether-package-x-is-installed-in-version-y">Knowing whether package X is installed in version Y</a></h3>
<blockquote>
<p><strong>Note:</strong> To use this, your package must require <code>&quot;composer/semver&quot;: &quot;^3.0&quot;</code>.</p>
</blockquote>
<pre><code class="language-php">use Composer\Semver\VersionParser;

\Composer\InstalledVersions::satisfies(new VersionParser, 'vendor/package', '2.0.*');
\Composer\InstalledVersions::satisfies(new VersionParser, 'psr/log-implementation', '^1.0');
</code></pre>
<p>This will return true if e.g. vendor/package is installed in a version matching
<code>2.0.*</code>, but also if the given package name is replaced or provided by some other
package.</p>
<h3 id="knowing-the-version-of-package-x"><a class="header" href="#knowing-the-version-of-package-x">Knowing the version of package X</a></h3>
<blockquote>
<p><strong>Note:</strong> This will return <code>null</code> if the package name you ask for is not itself installed
but merely provided or replaced by another package. We therefore recommend using satisfies()
in library code at least. In application code you have a bit more control and it is less
important.</p>
</blockquote>
<pre><code class="language-php">// returns a normalized version (e.g. 1.2.3.0) if vendor/package is installed,
// or null if it is provided/replaced,
// or throws OutOfBoundsException if the package is not installed at all
\Composer\InstalledVersions::getVersion('vendor/package');
</code></pre>
<pre><code class="language-php">// returns the original version (e.g. v1.2.3) if vendor/package is installed,
// or null if it is provided/replaced,
// or throws OutOfBoundsException if the package is not installed at all
\Composer\InstalledVersions::getPrettyVersion('vendor/package');
</code></pre>
<pre><code class="language-php">// returns the package dist or source reference (e.g. a git commit hash) if vendor/package is installed,
// or null if it is provided/replaced,
// or throws OutOfBoundsException if the package is not installed at all
\Composer\InstalledVersions::getReference('vendor/package');
</code></pre>
<h3 id="knowing-a-packages-own-installed-version"><a class="header" href="#knowing-a-packages-own-installed-version">Knowing a package's own installed version</a></h3>
<p>If you are only interested in getting a package's own version, e.g. in the source of acme/foo you want
to know which version acme/foo is currently running to display that to the user, then it is
acceptable to use getVersion/getPrettyVersion/getReference.</p>
<p>The warning in the section above does not apply in this case as you are sure the package is present
and not being replaced if your code is running.</p>
<p>It is nonetheless a good idea to make sure you handle the <code>null</code> return value as gracefully as
possible for safety.</p>
<hr />
<p>A few other methods are available for more complex usages, please refer to the
source/docblocks of <a href="https://github.com/composer/composer/blob/main/src/Composer/InstalledVersions.php">the class itself</a>.</p>
<h3 id="knowing-the-path-in-which-a-package-is-installed"><a class="header" href="#knowing-the-path-in-which-a-package-is-installed">Knowing the path in which a package is installed</a></h3>
<p>The <code>getInstallPath</code> method to retrieve a package's absolute install path.</p>
<pre><code class="language-php">// returns an absolute path to the package installation location if vendor/package is installed,
// or null if it is provided/replaced, or the package is a metapackage
// or throws OutOfBoundsException if the package is not installed at all
\Composer\InstalledVersions::getInstallPath('vendor/package');
</code></pre>
<blockquote>
<p>Available as of Composer 2.1 (i.e. <code>composer-runtime-api ^2.1</code>)</p>
</blockquote>
<h3 id="knowing-which-packages-of-a-given-type-are-installed"><a class="header" href="#knowing-which-packages-of-a-given-type-are-installed">Knowing which packages of a given type are installed</a></h3>
<p>The <code>getInstalledPackagesByType</code> method accepts a package type (e.g. foo-plugin) and lists
the packages of that type which are installed. You can then use the methods above to retrieve
more information about each package if needed.</p>
<p>This method should alleviate the need for custom installers placing plugins in a specific path
instead of leaving them in the vendor dir. You can then find plugins to initialize at runtime
via InstalledVersions, including their paths via getInstallPath if needed.</p>
<pre><code class="language-php">\Composer\InstalledVersions::getInstalledPackagesByType('foo-plugin');
</code></pre>
<blockquote>
<p>Available as of Composer 2.1 (i.e. <code>composer-runtime-api ^2.1</code>)</p>
</blockquote>
<h2 id="platform-check-1"><a class="header" href="#platform-check-1">Platform check</a></h2>
<p>composer-runtime-api 2.0 introduced a new <code>vendor/composer/platform_check.php</code> file, which
is included automatically when you include the Composer autoloader.</p>
<p>It verifies that platform requirements (i.e. php and php extensions) are fulfilled
by the PHP process currently running. If the requirements are not met, the script
prints a warning with the missing requirements and exits with code 104.</p>
<p>To avoid an unexpected white page of death with some obscure PHP extension warning in
production, you can run <code>composer check-platform-reqs</code> as part of your
deployment/build and if that returns a non-0 code you should abort.</p>
<p>The default value is <code>php-only</code> which only checks the PHP version.</p>
<p>If you for some reason do not want to use this safety check, and would rather
risk runtime errors when your code executes, you can disable this by setting the
<a href="pt-br/06-config.html#platform-check"><code>platform-check</code></a> config option to <code>false</code>.</p>
<p>If you want the check to include verifying the presence of PHP extensions,
set the config option to <code>true</code>. <code>ext-*</code> requirements will then be verified
but for performance reasons Composer only checks the extension is present,
not its exact version.</p>
<p><code>lib-*</code> requirements are never supported/checked by the platform check feature.</p>
<h2 id="autoloader-path-in-binaries"><a class="header" href="#autoloader-path-in-binaries">Autoloader path in binaries</a></h2>
<p>composer-runtime-api 2.2 introduced a new <code>$_composer_autoload_path</code> global
variable set when running binaries installed with Composer. Read more
about this <a href="pt-br/articles/vendor-binaries.html#finding-the-composer-autoloader-from-a-binary">on the vendor binaries docs</a>.</p>
<p>This is set by the binary proxy and as such is not made available to projects
by Composer's <code>vendor/autoload.php</code>, which would be useless as it would point back
to itself.</p>
<h2 id="binary-bin-dir-path-in-binaries"><a class="header" href="#binary-bin-dir-path-in-binaries">Binary (bin-dir) path in binaries</a></h2>
<p>composer-runtime-api 2.2.2 introduced a new <code>$_composer_bin_dir</code> global
variable set when running binaries installed with Composer. Read more
about this <a href="pt-br/articles/vendor-binaries.html#finding-the-composer-bin-dir-from-a-binary">on the vendor binaries docs</a>.</p>
<p>This is set by the binary proxy and as such is not made available to projects
by Composer's <code>vendor/autoload.php</code>.</p>
<p>← <a href="pt-br/06-config.html">Config</a>  |  <a href="pt-br/08-community.html">Community</a> →</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comunidade"><a class="header" href="#comunidade">Comunidade</a></h1>
<p>Há várias pessoas que já usam Composer, e uma boa parte delas contribui com o
projeto.</p>
<h2 id="como-contribuir"><a class="header" href="#como-contribuir">Como contribuir</a></h2>
<p>Caso queira contribuir com Composer, leia os documentos
<a href="https://github.com/composer/composer">README</a> e
<a href="https://github.com/composer/composer/blob/main/.github/CONTRIBUTING.md">CONTRIBUTING</a> (em inglês).</p>
<p>As principais diretrizes são as seguintes:</p>
<blockquote>
<p>Todas as contribuições com código - includindo as de pessoas que têm permissão
de commit - deverão passar por um pull request e ser aprovadas por uma pessoa
desenvolvedora do time antes de ser incorporada ao repositório principal. Isto
garante uma boa revisão de todo o código.</p>
<p>Faça um fork do projeto, crie um branch e nos envie um pull request.</p>
<p>Para garantir um código consistente, siga as diretrizes dos
<a href="https://www.php-fig.org/psr/psr-2/">padrões de codificação PSR-2</a>.</p>
</blockquote>
<h2 id="suporte"><a class="header" href="#suporte">Suporte</a></h2>
<p>O canal IRC fica disponível em irc.libera.chat: <a href="ircs://irc.libera.chat:6697/composer">#composer</a>.</p>
<p>Tanto o <a href="https://stackoverflow.com/questions/tagged/composer-php">Stack Overflow</a> quanto
<a href="https://github.com/composer/composer/discussions">GitHub Discussions</a> possuem uma coleção
de perguntas relacionadas a Composer.</p>
<p>Para receber suporte pago, a Packagist oferece suporte relacionado a Composer
via chat e email a clientes
<a href="https://packagist.com">Private Packagist</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Alias branch names to versions
-->
<h1 id="aliases"><a class="header" href="#aliases">Aliases</a></h1>
<h2 id="why-aliases"><a class="header" href="#why-aliases">Why aliases?</a></h2>
<p>When you are using a VCS repository, you will only get comparable versions for
branches that look like versions, such as <code>2.0</code> or <code>2.0.x</code>. For your <code>master</code> branch, you
will get a <code>dev-master</code> version. For your <code>bugfix</code> branch, you will get a
<code>dev-bugfix</code> version.</p>
<p>If your <code>master</code> branch is used to tag releases of the <code>1.0</code> development line,
i.e. <code>1.0.1</code>, <code>1.0.2</code>, <code>1.0.3</code>, etc., any package depending on it will
probably require version <code>1.0.*</code>.</p>
<p>If anyone wants to require the latest <code>dev-master</code>, they have a problem: Other
packages may require <code>1.0.*</code>, so requiring that dev version will lead to
conflicts, since <code>dev-master</code> does not match the <code>1.0.*</code> constraint.</p>
<p>Enter aliases.</p>
<h2 id="branch-alias"><a class="header" href="#branch-alias">Branch alias</a></h2>
<p>The <code>dev-master</code> branch is one in your main VCS repo. It is rather common that
someone will want the latest master dev version. Thus, Composer allows you to
alias your <code>dev-master</code> branch to a <code>1.0.x-dev</code> version. It is done by
specifying a <code>branch-alias</code> field under <code>extra</code> in <code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;extra&quot;: {
        &quot;branch-alias&quot;: {
            &quot;dev-master&quot;: &quot;1.0.x-dev&quot;
        }
    }
}
</code></pre>
<p>If you alias a non-comparable version (such as dev-develop) <code>dev-</code> must prefix the
branch name. You may also alias a comparable version (i.e. start with numbers,
and end with <code>.x-dev</code>), but only as a more specific version.
For example, 1.x-dev could be aliased as 1.2.x-dev.</p>
<p>The alias must be a comparable dev version, and the <code>branch-alias</code> must be present on
the branch that it references. For <code>dev-master</code>, you need to commit it on the
<code>master</code> branch.</p>
<p>As a result, anyone can now require <code>1.0.*</code> and it will happily install
<code>dev-master</code>.</p>
<p>In order to use branch aliasing, you must own the repository of the package
being aliased. If you want to alias a third party package without maintaining
a fork of it, use inline aliases as described below.</p>
<h2 id="require-inline-alias"><a class="header" href="#require-inline-alias">Require inline alias</a></h2>
<p>Branch aliases are great for aliasing main development lines. But in order to
use them you need to have control over the source repository, and you need to
commit changes to version control.</p>
<p>This is not really fun when you want to try a bugfix of some library that
is a dependency of your local project.</p>
<p>For this reason, you can alias packages in your <code>require</code> and <code>require-dev</code>
fields. Let's say you found a bug in the <code>monolog/monolog</code> package. You cloned
<a href="https://github.com/Seldaek/monolog">Monolog</a> on GitHub and fixed the issue in
a branch named <code>bugfix</code>. Now you want to install that version of monolog in your
local project.</p>
<p>You are using <code>symfony/monolog-bundle</code> which requires <code>monolog/monolog</code> version
<code>1.*</code>. So you need your <code>dev-bugfix</code> to match that constraint.</p>
<p>Add this to your project's root <code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;https://github.com/you/monolog&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;symfony/monolog-bundle&quot;: &quot;2.0&quot;,
        &quot;monolog/monolog&quot;: &quot;dev-bugfix as 1.0.x-dev&quot;
    }
}
</code></pre>
<p>Or let Composer add it for you with:</p>
<pre><code>php composer.phar require &quot;monolog/monolog:dev-bugfix as 1.0.x-dev&quot;
</code></pre>
<p>That will fetch the <code>dev-bugfix</code> version of <code>monolog/monolog</code> from your GitHub
and alias it to <code>1.0.x-dev</code>.</p>
<blockquote>
<p><strong>Note:</strong> Inline aliasing is a root-only feature. If a package with inline
aliases is required, the alias (right of the <code>as</code>) is used as the version
constraint. The part left of the <code>as</code> is discarded. As a consequence, if
A requires B and B requires <code>monolog/monolog</code> version <code>dev-bugfix as 1.0.x-dev</code>,
installing A will make B require <code>1.0.x-dev</code>, which may exist as a branch
alias or an actual <code>1.0</code> branch. If it does not, it must be
inline-aliased again in A's <code>composer.json</code>.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> Inline aliasing should be avoided, especially for published
packages/libraries. If you found a bug, try to get your fix merged upstream.
This helps to avoid issues for users of your package.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Access privately hosted packages/repositories
-->
<h1 id="authentication-for-privately-hosted-packages-and-repositories"><a class="header" href="#authentication-for-privately-hosted-packages-and-repositories">Authentication for privately hosted packages and repositories</a></h1>
<p>Your <a href="en/articles/handling-private-packages.html">private package server</a> or version control system is probably secured with one
or more authentication options. In order to allow your project to have access to these
packages and repositories you will have to tell Composer how to authenticate with the server that hosts them.</p>
<h1 id="authentication-principles"><a class="header" href="#authentication-principles">Authentication principles</a></h1>
<p>Whenever Composer encounters a protected Composer repository it will try to authenticate
using already defined credentials first. When none of those credentials apply it will prompt
for credentials and save them (or a token if Composer is able to retrieve one).</p>
<table><thead><tr><th>type</th><th>Generated by Prompt?</th></tr></thead><tbody>
<tr><td><a href="en/articles/authentication-for-private-packages.html#http-basic">http-basic</a></td><td>yes</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#inline-http-basic">Inline http-basic</a></td><td>no</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#custom-token-authentication">Custom header</a></td><td>no</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#gitlab-oauth">gitlab-oauth</a></td><td>yes</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#gitlab-token">gitlab-token</a></td><td>yes</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#github-oauth">github-oauth</a></td><td>yes</td></tr>
<tr><td><a href="en/articles/authentication-for-private-packages.html#bitbucket-oauth">bitbucket-oauth</a></td><td>yes</td></tr>
</tbody></table>
<p>Sometimes automatic authentication is not possible, or you may want to predefine
authentication credentials.</p>
<p>Credentials can be stored on 3 different places; in an <code>auth.json</code> for the project, a global
<code>auth.json</code> or in the <code>composer.json</code> itself.</p>
<h2 id="authentication-in-authjson-per-project"><a class="header" href="#authentication-in-authjson-per-project">Authentication in auth.json per project</a></h2>
<p>In this authentication storage method, an <code>auth.json</code> file will be present in the same folder
as the projects' <code>composer.json</code> file. You can either create and edit this file using the
command line or manually edit or create it.</p>
<blockquote>
<p><strong>Note: Make sure the <code>auth.json</code> file is in <code>.gitignore</code></strong> to avoid
leaking credentials into your git history.</p>
</blockquote>
<h2 id="global-authentication-credentials"><a class="header" href="#global-authentication-credentials">Global authentication credentials</a></h2>
<p>If you don't want to supply credentials for every project you work on, storing your credentials
globally might be a better idea. These credentials are stored in a global <code>auth.json</code> in your
Composer home directory.</p>
<h3 id="command-line-global-credential-editing"><a class="header" href="#command-line-global-credential-editing">Command line global credential editing</a></h3>
<p>For all authentication methods it is possible to edit them using the command line;</p>
<ul>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-http-basic">http-basic</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-inline-http-basic">Inline http-basic</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-gitlab-oauth">gitlab-oauth</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-gitlab-token">gitlab-token</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-github-oauth">github-oauth</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#command-line-bitbucket-oauth">bitbucket-oauth</a></li>
</ul>
<h3 id="manually-editing-global-authentication-credentials"><a class="header" href="#manually-editing-global-authentication-credentials">Manually editing global authentication credentials</a></h3>
<blockquote>
<p><strong>Note:</strong> It is not recommended to manually edit your authentication options as this might
result in invalid json. Instead preferably use <a href="en/articles/authentication-for-private-packages.html#command-line-global-credential-editing">the command line</a>.</p>
</blockquote>
<p>To manually edit it, run:</p>
<pre><code class="language-sh">php composer.phar config --global --editor [--auth]
</code></pre>
<p>For specific authentication implementations, see their sections;</p>
<ul>
<li><a href="en/articles/authentication-for-private-packages.html#manual-http-basic">http-basic</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-inline-http-basic">Inline http-basic</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-custom-token-authentication">custom header</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-gitlab-oauth">gitlab-oauth</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-gitlab-token">gitlab-token</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-github-oauth">github-oauth</a></li>
<li><a href="en/articles/authentication-for-private-packages.html#manual-bitbucket-oauth">bitbucket-oauth</a></li>
</ul>
<p>Manually editing this file instead of using the command line may result in invalid json errors.
To fix this you need to open the file in an editor and fix the error. To find the location of
your global <code>auth.json</code>, execute:</p>
<pre><code class="language-sh">php composer.phar config --global home
</code></pre>
<p>The folder will contain your global <code>auth.json</code> if it exists.</p>
<p>You can open this file in your favorite editor and fix the error.</p>
<h2 id="authentication-in-composerjson-file-itself"><a class="header" href="#authentication-in-composerjson-file-itself">Authentication in composer.json file itself</a></h2>
<blockquote>
<p><strong>Note:</strong> <strong>This is not recommended</strong> as these credentials are visible
to anyone who has access to the composer.json, either when it is shared through
a version control system like git or when an attacker gains (read) access to
your production server files.</p>
</blockquote>
<p>It is also possible to add credentials to a <code>composer.json</code> on a per-project basis in the <code>config</code>
section or directly in the repository definition.</p>
<h2 id="authentication-using-the-composer_auth-environment-variable"><a class="header" href="#authentication-using-the-composer_auth-environment-variable">Authentication using the COMPOSER_AUTH environment variable</a></h2>
<blockquote>
<p><strong>Note:</strong> Using the command line environment variable method also has security implications.
These credentials will most likely be stored in memory,
and on be persisted to a file like <code>~/.bash_history</code>(linux) or <code>ConsoleHost_history.txt</code>
(PowerShell on Windows) when closing a session.</p>
</blockquote>
<p>The final option to supply Composer with credentials is to use the <code>COMPOSER_AUTH</code> environment variable.
These variables can be either passed as command line variables or set in actual environment variables.
Read more about the usage of this environment variable <a href="en/articles/../03-cli.html#composer-auth">here</a>.</p>
<h1 id="authentication-methods"><a class="header" href="#authentication-methods">Authentication methods</a></h1>
<h2 id="http-basic-1"><a class="header" href="#http-basic-1">http-basic</a></h2>
<h3 id="command-line-http-basic"><a class="header" href="#command-line-http-basic">Command line http-basic</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] http-basic.example.org username password
</code></pre>
<h3 id="manual-http-basic"><a class="header" href="#manual-http-basic">Manual http-basic</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor --auth
</code></pre>
<pre><code class="language-json">{
    &quot;http-basic&quot;: {
        &quot;example.org&quot;: {
            &quot;username&quot;: &quot;username&quot;,
            &quot;password&quot;: &quot;password&quot;
        }
    }
}
</code></pre>
<h2 id="inline-http-basic"><a class="header" href="#inline-http-basic">Inline http-basic</a></h2>
<p>For the inline http-basic authentication method the credentials are not stored in a separate
<code>auth.json</code> in the project or globally, but in the <code>composer.json</code> or global configuration
in the same place where the Composer repository definition is defined.</p>
<p>Make sure that the username and password are encoded according to <a href="http://www.faqs.org/rfcs/rfc3986.html">RFC 3986</a> (2.1. Percent-Encoding).
If the username e.g. is an email address it needs to be passed as <code>name%40example.com</code>.</p>
<h3 id="command-line-inline-http-basic"><a class="header" href="#command-line-inline-http-basic">Command line inline http-basic</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] repositories composer.unique-name https://username:password@repo.example.org
</code></pre>
<h3 id="manual-inline-http-basic"><a class="header" href="#manual-inline-http-basic">Manual inline http-basic</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor
</code></pre>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://username:password@example.org&quot;
        }
    ]
}
</code></pre>
<h2 id="custom-token-authentication"><a class="header" href="#custom-token-authentication">Custom token authentication</a></h2>
<h3 id="manual-custom-token-authentication"><a class="header" href="#manual-custom-token-authentication">Manual custom token authentication</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor
</code></pre>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;,
            &quot;options&quot;:  {
              &quot;http&quot;: {
                &quot;header&quot;: [
                  &quot;API-TOKEN: YOUR-API-TOKEN&quot;
                ]
              }
            }
        }
    ]
}
</code></pre>
<h2 id="gitlab-oauth-1"><a class="header" href="#gitlab-oauth-1">gitlab-oauth</a></h2>
<blockquote>
<p><strong>Note:</strong> For the gitlab authentication to work on private gitlab instances, the
<a href="en/articles/../06-config.html#gitlab-domains"><code>gitlab-domains</code></a> section should also contain the url.</p>
</blockquote>
<h3 id="command-line-gitlab-oauth"><a class="header" href="#command-line-gitlab-oauth">Command line gitlab-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] gitlab-oauth.example.org token
</code></pre>
<h3 id="manual-gitlab-oauth"><a class="header" href="#manual-gitlab-oauth">Manual gitlab-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor --auth
</code></pre>
<pre><code class="language-json">{
    &quot;gitlab-oauth&quot;: {
        &quot;example.org&quot;: &quot;token&quot;
    }
}
</code></pre>
<h2 id="gitlab-token-1"><a class="header" href="#gitlab-token-1">gitlab-token</a></h2>
<blockquote>
<p><strong>Note:</strong> For the gitlab authentication to work on private gitlab instances, the
<a href="en/articles/../06-config.html#gitlab-domains"><code>gitlab-domains</code></a> section should also contain the url.</p>
</blockquote>
<p>To create a new access token, go to your <a href="https://gitlab.com/-/profile/personal_access_tokens">access tokens section on GitLab</a>
(or the equivalent URL on your private instance) and create a new token. See also <a href="https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html#creating-a-personal-access-token">the GitLab access token documentation</a> for more information.</p>
<p>When creating a gitlab token manually, make sure it has either the <code>read_api</code> or <code>api</code> scope.</p>
<h3 id="command-line-gitlab-token"><a class="header" href="#command-line-gitlab-token">Command line gitlab-token</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] gitlab-token.example.org token
</code></pre>
<h3 id="manual-gitlab-token"><a class="header" href="#manual-gitlab-token">Manual gitlab-token</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor --auth
</code></pre>
<pre><code class="language-json">{
    &quot;gitlab-token&quot;: {
        &quot;example.org&quot;: &quot;token&quot;
    }
}
</code></pre>
<h2 id="github-oauth-1"><a class="header" href="#github-oauth-1">github-oauth</a></h2>
<p>To create a new access token, head to your <a href="https://github.com/settings/tokens">token settings section on Github</a> and <a href="https://github.com/settings/tokens/new">generate a new token</a>.</p>
<p>For public repositories when rate limited, a token <em>without</em> any particular scope is sufficient (see <code>(no scope)</code> in the <a href="https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps">scopes documentation</a>). Such tokens grant read-only access to public information.</p>
<p>For private repositories, the <code>repo</code> scope is needed. Note that the token will be given broad read/write access to all of your private repositories and much more - see the <a href="https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps">scopes documentation</a> for a complete list. As of writing (November 2021), it seems not to be possible to further limit permissions for such tokens.</p>
<p>Read more about <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">Personal Access Tokens</a>, or subscribe to the <a href="https://github.com/github/roadmap/issues/184">roadmap item for better scoped tokens in GitHub</a>.</p>
<h3 id="command-line-github-oauth"><a class="header" href="#command-line-github-oauth">Command line github-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] github-oauth.github.com token
</code></pre>
<h3 id="manual-github-oauth"><a class="header" href="#manual-github-oauth">Manual github-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor --auth
</code></pre>
<pre><code class="language-json">{
    &quot;github-oauth&quot;: {
        &quot;github.com&quot;: &quot;token&quot;
    }
}
</code></pre>
<h2 id="bitbucket-oauth-1"><a class="header" href="#bitbucket-oauth-1">bitbucket-oauth</a></h2>
<p>The BitBucket driver uses OAuth to access your private repositories via the BitBucket REST APIs, and you will need to create an OAuth consumer to use the driver, please refer to <a href="https://support.atlassian.com/bitbucket-cloud/docs/use-oauth-on-bitbucket-cloud/">Atlassian's Documentation</a>. You will need to fill the callback url with something to satisfy BitBucket, but the address does not need to go anywhere and is not used by Composer.</p>
<h3 id="command-line-bitbucket-oauth"><a class="header" href="#command-line-bitbucket-oauth">Command line bitbucket-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] bitbucket-oauth.bitbucket.org consumer-key consumer-secret
</code></pre>
<h3 id="manual-bitbucket-oauth"><a class="header" href="#manual-bitbucket-oauth">Manual bitbucket-oauth</a></h3>
<pre><code class="language-sh">php composer.phar config [--global] --editor --auth
</code></pre>
<pre><code class="language-json">{
    &quot;bitbucket-oauth&quot;: {
        &quot;bitbucket.org&quot;: {
             &quot;consumer-key&quot;: &quot;key&quot;,
             &quot;consumer-secret&quot;: &quot;secret&quot;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: How to reduce the performance impact of the autoloader
-->
<h1 id="autoloader-optimization"><a class="header" href="#autoloader-optimization">Autoloader optimization</a></h1>
<p>By default, the Composer autoloader runs relatively fast. However, due to the way
PSR-4 and PSR-0 autoloading rules are set up, it needs to check the filesystem
before resolving a classname conclusively. This slows things down quite a bit,
but it is convenient in development environments because when you add a new class
it can immediately be discovered/used without having to rebuild the autoloader
configuration.</p>
<p>The problem however is in production you generally want things to happen as fast
as possible, as you can rebuild the configuration every time you deploy and
new classes do not appear at random between deploys.</p>
<p>For this reason, Composer offers a few strategies to optimize the autoloader.</p>
<blockquote>
<p><strong>Note:</strong> You <strong>should not</strong> enable any of these optimizations in <strong>development</strong> as
they all will cause various problems when adding/removing classes. The performance
gains are not worth the trouble in a development setting.</p>
</blockquote>
<h2 id="optimization-level-1-class-map-generation"><a class="header" href="#optimization-level-1-class-map-generation">Optimization Level 1: Class map generation</a></h2>
<h3 id="how-to-run-it"><a class="header" href="#how-to-run-it">How to run it?</a></h3>
<p>There are a few options to enable this:</p>
<ul>
<li>Set <code>&quot;optimize-autoloader&quot;: true</code> inside the config key of composer.json</li>
<li>Call <code>install</code> or <code>update</code> with <code>-o</code> / <code>--optimize-autoloader</code></li>
<li>Call <code>dump-autoload</code> with <code>-o</code> / <code>--optimize</code></li>
</ul>
<h3 id="what-does-it-do"><a class="header" href="#what-does-it-do">What does it do?</a></h3>
<p>Class map generation essentially converts PSR-4/PSR-0 rules into classmap rules.
This makes everything quite a bit faster as for known classes the class map
returns instantly the path, and Composer can guarantee the class is in there so
there is no filesystem check needed.</p>
<p>On PHP 5.6+, the class map is also cached in opcache which improves the initialization
time greatly. If you make sure opcache is enabled, then the class map should load
almost instantly and then class loading is fast.</p>
<h3 id="trade-offs"><a class="header" href="#trade-offs">Trade-offs</a></h3>
<p>There are no real trade-offs with this method. It should always be enabled in
production.</p>
<p>The only issue is it does not keep track of autoload misses (i.e. when
it cannot find a given class), so those fallback to PSR-4 rules and can still
result in slow filesystem checks. To solve this issue two Level 2 optimization
options exist, and you can decide to enable either if you have a lot of
class_exists checks that are done for classes that do not exist in your project.</p>
<h2 id="optimization-level-2a-authoritative-class-maps"><a class="header" href="#optimization-level-2a-authoritative-class-maps">Optimization Level 2/A: Authoritative class maps</a></h2>
<h3 id="how-to-run-it-1"><a class="header" href="#how-to-run-it-1">How to run it?</a></h3>
<p>There are a few options to enable this:</p>
<ul>
<li>Set <code>&quot;classmap-authoritative&quot;: true</code> inside the config key of composer.json</li>
<li>Call <code>install</code> or <code>update</code> with <code>-a</code> / <code>--classmap-authoritative</code></li>
<li>Call <code>dump-autoload</code> with <code>-a</code> / <code>--classmap-authoritative</code></li>
</ul>
<h3 id="what-does-it-do-1"><a class="header" href="#what-does-it-do-1">What does it do?</a></h3>
<p>Enabling this automatically enables Level 1 class map optimizations.</p>
<p>This option says that if something is not found in the classmap,
then it does not exist and the autoloader should not attempt to look on the
filesystem according to PSR-4 rules.</p>
<h3 id="trade-offs-1"><a class="header" href="#trade-offs-1">Trade-offs</a></h3>
<p>This option makes the autoloader always return very quickly. On the flipside it
also means that in case a class is generated at runtime for some reason, it will
not be allowed to be autoloaded. If your project or any of your dependencies does that
then you might experience &quot;class not found&quot; issues in production. Enable this with care.</p>
<blockquote>
<p>Note: This cannot be combined with Level 2/B optimizations. You have to choose one as
they address the same issue in different ways.</p>
</blockquote>
<h2 id="optimization-level-2b-apcu-cache"><a class="header" href="#optimization-level-2b-apcu-cache">Optimization Level 2/B: APCu cache</a></h2>
<h3 id="how-to-run-it-2"><a class="header" href="#how-to-run-it-2">How to run it?</a></h3>
<p>There are a few options to enable this:</p>
<ul>
<li>Set <code>&quot;apcu-autoloader&quot;: true</code> inside the config key of composer.json</li>
<li>Call <code>install</code> or <code>update</code> with <code>--apcu-autoloader</code></li>
<li>Call <code>dump-autoload</code> with <code>--apcu</code></li>
</ul>
<h3 id="what-does-it-do-2"><a class="header" href="#what-does-it-do-2">What does it do?</a></h3>
<p>This option adds an APCu cache as a fallback for the class map. It will not
automatically generate the class map though, so you should still enable Level 1
optimizations manually if you so desire.</p>
<p>Whether a class is found or not, that fact is always cached in APCu, so it can be
returned quickly on the next request.</p>
<h3 id="trade-offs-2"><a class="header" href="#trade-offs-2">Trade-offs</a></h3>
<p>This option requires APCu which may or may not be available to you. It also
uses APCu memory for autoloading purposes, but it is safe to use and cannot
result in classes not being found like the authoritative class map
optimization above.</p>
<blockquote>
<p>Note: This cannot be combined with Level 2/A optimizations. You have to choose one as
they address the same issue in different ways.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Making your package depend on specific Composer versions
-->
<h1 id="composer-platform-dependencies"><a class="header" href="#composer-platform-dependencies">Composer platform dependencies</a></h1>
<h2 id="what-are-platform-dependencies"><a class="header" href="#what-are-platform-dependencies">What are platform dependencies</a></h2>
<p>Composer makes information about the environment Composer runs in available as virtual packages. This allows other
packages to define dependencies (<a href="en/articles/../04-schema.html#require">require</a>, <a href="en/articles/../04-schema.html#conflict">conflict</a>,
<a href="en/articles/../04-schema.html#provide">provide</a>, <a href="en/articles/../04-schema.html#replace">replace</a>) on different aspects of the platform, like PHP,
extensions or system libraries, including version constraints.</p>
<p>When you require one of the platform packages no code is installed. The version numbers of platform packages are
derived from the environment Composer is executed in and they cannot be updated or removed. They can however be
overwritten for the purposes of dependency resolution with a <a href="en/articles/../06-config.html#platform">platform configuration</a>.</p>
<p><strong>For example:</strong> If you are executing <code>composer update</code> with a PHP interpreter in version
<code>7.4.42</code>, then Composer automatically adds a package to the pool of available packages
called <code>php</code> and assigns version <code>7.4.42</code> to it.</p>
<p>That's how packages can add a dependency on the used PHP version:</p>
<pre><code class="language-json">{
    &quot;require&quot; : {
        &quot;php&quot; : &quot;&gt;=7.4&quot;
    }
}
</code></pre>
<p>Composer will check this requirement against the currently used PHP version when running the composer command.</p>
<h3 id="different-types-of-platform-packages"><a class="header" href="#different-types-of-platform-packages">Different types of platform packages</a></h3>
<p>The following types of platform packages exist and can be depended on:</p>
<ol>
<li>PHP (<code>php</code> and the subtypes: <code>php-64bit</code>, <code>php-ipv6</code>, <code>php-zts</code> <code>php-debug</code>)</li>
<li>PHP Extensions (<code>ext-*</code>, e.g. <code>ext-mbstring</code>)</li>
<li>PHP Libraries (<code>lib-*</code>, e.g. <code>lib-curl</code>)</li>
<li>Composer (<code>composer</code>, <code>composer-plugin-api</code>, <code>composer-runtime-api</code>)</li>
</ol>
<p>To see the complete list of platform packages available in your environment
you can run <code>php composer.phar show --platform</code> (or <code>show -p</code> for short).</p>
<p>The differences between the various Composer platform packages are explained further in this document.</p>
<h2 id="plugin-package-composer-plugin-api"><a class="header" href="#plugin-package-composer-plugin-api">Plugin package <code>composer-plugin-api</code></a></h2>
<p>You can modify Composer's behavior with <a href="en/articles/plugins.html">plugin</a> packages. Composer provides a set of versioned APIs for
plugins. Because internal Composer changes may <strong>not</strong> change the plugin APIs, the API version may not increase every
time the Composer version increases. E.g. In Composer version <code>2.3.12</code>, the <code>composer-plugin-api</code> version could still
be <code>2.2.0</code>.</p>
<h2 id="runtime-package-composer-runtime-api"><a class="header" href="#runtime-package-composer-runtime-api">Runtime package <code>composer-runtime-api</code></a></h2>
<p>When applications which were installed with Composer are run (either on CLI or through a web request), they require the
<code>vendor/autoload.php</code> file, typically as one of the first lines of executed code. Invocations of the Composer
autoloader are considered the application &quot;runtime&quot;.</p>
<p>Starting with version 2.0, Composer makes <a href="en/articles/../07-runtime.html">additional features</a> (besides registering the class autoloader) available to the application runtime environment.</p>
<p>Similar to <code>composer-plugin-api</code>, not every Composer release adds new runtime features,
thus the version of <code>composer-runtimeapi</code> is also increased independently from Composer's version. </p>
<h2 id="composer-package-composer"><a class="header" href="#composer-package-composer">Composer package <code>composer</code></a></h2>
<p>Starting with Composer 2.2.0, a new platform package called <code>composer</code> is available, which represents the exact
Composer version that is executed. Packages depending on this platform package can therefore depend on (or conflict
with) individual Composer versions to cover edge cases where neither the <code>composer-runtime-api</code> version nor the
<code>composer-plugin-api</code> was changed.</p>
<p>Because this option was introduced with Composer 2.2.0, it is recommended to add a <code>composer-plugin-api</code> dependency on
at least <code>&gt;=2.2.0</code> to provide a more meaningful error message for users running older Composer versions.</p>
<p>In general, depending on <code>composer-plugin-api</code> or <code>composer-runtime-api</code> is always recommended
over depending on concrete Composer versions with the <code>composer</code> platform package.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Modify the way certain types of packages are installed
-->
<h1 id="setting-up-and-using-custom-installers"><a class="header" href="#setting-up-and-using-custom-installers">Setting up and using custom installers</a></h1>
<h2 id="synopsis"><a class="header" href="#synopsis">Synopsis</a></h2>
<p>At times, it may be necessary for a package to require additional actions during
installation, such as installing packages outside of the default <code>vendor</code>
library.</p>
<p>In these cases you could consider creating a Custom Installer to handle your
specific logic.</p>
<h2 id="alternative-to-custom-installers-with-composer-21"><a class="header" href="#alternative-to-custom-installers-with-composer-21">Alternative to custom installers with Composer 2.1+</a></h2>
<p>As of Composer 2.1, the <code>Composer\InstalledVersions</code> class has a
<a href="https://getcomposer.org/doc/07-runtime.md#knowing-which-packages-of-a-given-type-are-installed"><code>getInstalledPackagesByType</code></a>
method which can let you figure out at runtime which plugins/modules/extensions are installed.</p>
<p>It is highly recommended to use that instead of building new custom
installers if you are building a new application. This has the advantage of leaving
all vendor code in the vendor directory, and not requiring custom installer code.</p>
<h2 id="calling-a-custom-installer"><a class="header" href="#calling-a-custom-installer">Calling a Custom Installer</a></h2>
<p>Suppose that your project already has a Custom Installer for specific modules
then invoking that installer is a matter of defining the correct <a href="en/articles/../04-schema.html#type">type</a> in
your package file.</p>
<blockquote>
<p><em>See the next chapter for an instruction how to create Custom Installers.</em></p>
</blockquote>
<p>Every Custom Installer defines which <a href="en/articles/../04-schema.html#type">type</a> string it will recognize. Once
recognized it will completely override the default installer and only apply its
own logic.</p>
<p>An example use-case would be:</p>
<blockquote>
<p>phpDocumentor features Templates that need to be installed outside of the
default /vendor folder structure. As such they have chosen to adopt the
<code>phpdocumentor-template</code> <a href="en/articles/../04-schema.html#type">type</a> and create a plugin providing the Custom
Installer to send these templates to the correct folder.</p>
</blockquote>
<p>An example composer.json of such a template package would be:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;phpdocumentor/template-responsive&quot;,
    &quot;type&quot;: &quot;phpdocumentor-template&quot;,
    &quot;require&quot;: {
        &quot;phpdocumentor/template-installer-plugin&quot;: &quot;*&quot;
    }
}
</code></pre>
<blockquote>
<p><strong>IMPORTANT</strong>: to make sure that the template installer is present at the
time the template package is installed, template packages should require
the plugin package.</p>
</blockquote>
<h2 id="creating-an-installer"><a class="header" href="#creating-an-installer">Creating an Installer</a></h2>
<p>A Custom Installer is defined as a class that implements the
<a href="https://github.com/composer/composer/blob/main/src/Composer/Installer/InstallerInterface.php"><code>Composer\Installer\InstallerInterface</code></a> and is usually distributed in a
Composer Plugin.</p>
<p>A basic Installer Plugin would thus compose of three files:</p>
<ol>
<li>the package file: composer.json</li>
<li>The Plugin class, e.g.: <code>My\Project\Composer\Plugin.php</code>, containing a class that implements <code>Composer\Plugin\PluginInterface</code>.</li>
<li>The Installer class, e.g.: <code>My\Project\Composer\Installer.php</code>, containing a class that implements <code>Composer\Installer\InstallerInterface</code>.</li>
</ol>
<h3 id="composerjson"><a class="header" href="#composerjson">composer.json</a></h3>
<p>The package file is the same as any other package file but with the following
requirements:</p>
<ol>
<li>the <a href="en/articles/../04-schema.html#type">type</a> attribute must be <code>composer-plugin</code>.</li>
<li>the <a href="en/articles/../04-schema.html#extra">extra</a> attribute must contain an element <code>class</code> defining the
class name of the plugin (including namespace). If a package contains
multiple plugins, this can be an array of class names.</li>
</ol>
<p>Example:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;phpdocumentor/template-installer-plugin&quot;,
    &quot;type&quot;: &quot;composer-plugin&quot;,
    &quot;license&quot;: &quot;MIT&quot;,
    &quot;autoload&quot;: {
        &quot;psr-0&quot;: {&quot;phpDocumentor\\Composer&quot;: &quot;src/&quot;}
    },
    &quot;extra&quot;: {
        &quot;class&quot;: &quot;phpDocumentor\\Composer\\TemplateInstallerPlugin&quot;
    },
    &quot;require&quot;: {
        &quot;composer-plugin-api&quot;: &quot;^1.0&quot;
    },
    &quot;require-dev&quot;: {
        &quot;composer/composer&quot;: &quot;^1.3&quot;
    }
}
</code></pre>
<p>The example above has Composer itself in its require-dev, which allows you to use
the Composer classes in your test suite for example.</p>
<h3 id="the-plugin-class"><a class="header" href="#the-plugin-class">The Plugin class</a></h3>
<p>The class defining the Composer plugin must implement the
<a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/PluginInterface.php"><code>Composer\Plugin\PluginInterface</code></a>. It can then register the Custom
Installer in its <code>activate()</code> method.</p>
<p>The class may be placed in any location and have any name, as long as it is
autoloadable and matches the <code>extra.class</code> element in the package definition.</p>
<p>Example:</p>
<pre><code class="language-php">&lt;?php

namespace phpDocumentor\Composer;

use Composer\Composer;
use Composer\IO\IOInterface;
use Composer\Plugin\PluginInterface;

class TemplateInstallerPlugin implements PluginInterface
{
    public function activate(Composer $composer, IOInterface $io)
    {
        $installer = new TemplateInstaller($io, $composer);
        $composer-&gt;getInstallationManager()-&gt;addInstaller($installer);
    }
}
</code></pre>
<h3 id="the-custom-installer-class"><a class="header" href="#the-custom-installer-class">The Custom Installer class</a></h3>
<p>The class that executes the custom installation should implement the
<a href="https://github.com/composer/composer/blob/main/src/Composer/Installer/InstallerInterface.php"><code>Composer\Installer\InstallerInterface</code></a> (or extend another installer that
implements that interface). It defines the <a href="en/articles/../04-schema.html#type">type</a> string as it will be
recognized by packages that will use this installer in the <code>supports()</code> method.</p>
<blockquote>
<p><strong>NOTE</strong>: <em>choose your <a href="en/articles/../04-schema.html#type">type</a> name carefully, it is recommended to follow
the format: <code>vendor-type</code></em>. For example: <code>phpdocumentor-template</code>.</p>
</blockquote>
<p>The InstallerInterface class defines the following methods (please see the
source for the exact signature):</p>
<ul>
<li><strong>supports()</strong>, here you test whether the passed <a href="en/articles/../04-schema.html#type">type</a> matches the name
that you declared for this installer (see the example).</li>
<li><strong>isInstalled()</strong>, determines whether a supported package is installed or not.</li>
<li><strong>install()</strong>, here you can determine the actions that need to be executed
upon installation.</li>
<li><strong>update()</strong>, here you define the behavior that is required when Composer is
invoked with the update argument.</li>
<li><strong>uninstall()</strong>, here you can determine the actions that need to be executed
when the package needs to be removed.</li>
<li><strong>getInstallPath()</strong>, this method should return the location where the
package is to be installed, <em>relative from the location of composer.json.</em>
The path <em>must not end with a slash.</em></li>
</ul>
<p>Example:</p>
<pre><code class="language-php">&lt;?php

namespace phpDocumentor\Composer;

use Composer\Package\PackageInterface;
use Composer\Installer\LibraryInstaller;

class TemplateInstaller extends LibraryInstaller
{
    /**
     * @inheritDoc
     */
    public function getInstallPath(PackageInterface $package)
    {
        $prefix = substr($package-&gt;getPrettyName(), 0, 23);
        if ('phpdocumentor/template-' !== $prefix) {
            throw new \InvalidArgumentException(
                'Unable to install template, phpdocumentor templates '
                .'should always start their package name with '
                .'&quot;phpdocumentor/template-&quot;'
            );
        }

        return 'data/templates/'.substr($package-&gt;getPrettyName(), 23);
    }

    /**
     * @inheritDoc
     */
    public function supports($packageType)
    {
        return 'phpdocumentor-template' === $packageType;
    }
}
</code></pre>
<p>The example demonstrates that it is possible to extend the
<a href="https://github.com/composer/composer/blob/main/src/Composer/Installer/LibraryInstaller.php"><code>Composer\Installer\LibraryInstaller</code></a> class to strip a prefix
(<code>phpdocumentor/template-</code>) and use the remaining part to assemble a completely
different installation path.</p>
<blockquote>
<p><em>Instead of being installed in <code>/vendor</code> any package installed using this
Installer will be put in the <code>/data/templates/&lt;stripped name&gt;</code> folder.</em></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Hosting and installing private Composer packages
-->
<h1 id="handling-private-packages"><a class="header" href="#handling-private-packages">Handling private packages</a></h1>
<h1 id="private-packagist-1"><a class="header" href="#private-packagist-1">Private Packagist</a></h1>
<p><a href="https://packagist.com">Private Packagist</a> is a commercial package hosting product
offering professional support and web based management of private and public packages,
and granular access permissions. Private Packagist provides mirroring for packages' zip
files which makes installs faster and independent from third party systems - e.g.
you can deploy even if GitHub is down because your zip files are mirrored.</p>
<p>Private Packagist is available as a hosted SaaS solution or as an on-premise self-hosted
package, providing an interactive set up experience.</p>
<p>Some of Private Packagist's revenue is used to pay for Composer and Packagist.org
development and hosting so using it is a good way to support the maintenance of
these open source projects financially. You can find more information about how to
set up your own package archive on <a href="https://packagist.com">Packagist.com</a>.</p>
<h1 id="satis-1"><a class="header" href="#satis-1">Satis</a></h1>
<p>Satis on the other hand is open source but only a static <code>composer</code> repository
generator. It is a bit like an ultra-lightweight, static file-based version of
packagist and can be used to host the metadata of your company's private
packages, or your own. You can get it from
<a href="https://github.com/composer/satis">GitHub</a> or install via CLI:</p>
<pre><code>php composer.phar create-project composer/satis --stability=dev --keep-vcs
</code></pre>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>For example let's assume you have a few packages you want to reuse across your
company but don't really want to open-source. You would first define a Satis
configuration: a json file with an arbitrary name that lists your curated
<a href="en/articles/../05-repositories.html">repositories</a>.</p>
<p>Here is an example configuration, you see that it holds a few VCS repositories,
but those could be any types of <a href="en/articles/../05-repositories.html">repositories</a>. Then it
uses <code>&quot;require-all&quot;: true</code> which selects all versions of all packages in the
repositories you defined.</p>
<p>The default file Satis looks for is <code>satis.json</code> in the root of the repository.</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;My Repository&quot;,
  &quot;homepage&quot;: &quot;http://packages.example.org&quot;,
  &quot;repositories&quot;: [
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo&quot; },
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;http://svn.example.org/private/repo&quot; },
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo2&quot; }
  ],
  &quot;require-all&quot;: true
}
</code></pre>
<p>If you want to cherry pick which packages you want, you can list all the
packages you want to have in your satis repository inside the classic composer
<code>require</code> key, using a <code>&quot;*&quot;</code> constraint to make sure all versions are selected,
or another constraint if you want really specific versions.</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo&quot; },
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;http://svn.example.org/private/repo&quot; },
    { &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo2&quot; }
  ],
  &quot;require&quot;: {
    &quot;company/package&quot;: &quot;*&quot;,
    &quot;company/package2&quot;: &quot;*&quot;,
    &quot;company/package3&quot;: &quot;2.0.0&quot;
  }
}
</code></pre>
<p>Once you've done this, you run:</p>
<pre><code>php bin/satis build &lt;configuration file&gt; &lt;build dir&gt;
</code></pre>
<p>When you ironed out that process, what you would typically do is run this
command as a cron job on a server. It would then update all your package info
much like Packagist does.</p>
<p>Note that if your private packages are hosted on GitHub, your server should
have an ssh key that gives it access to those packages, and then you should add
the <code>--no-interaction</code> (or <code>-n</code>) flag to the command to make sure it falls back
to ssh key authentication instead of prompting for a password. This is also a
good trick for continuous integration servers.</p>
<p>Set up a virtual-host that points to that <code>web/</code> directory, let's say it is
<code>packages.example.org</code>. Alternatively, with PHP &gt;= 5.4.0, you can use the
built-in CLI server <code>php -S localhost:port -t satis-output-dir/</code> for a
temporary solution.</p>
<h3 id="partial-updates"><a class="header" href="#partial-updates">Partial Updates</a></h3>
<p>You can tell Satis to selectively update only particular packages or process
only a repository with a given URL. This cuts down the time it takes to rebuild
the <code>package.json</code> file and is helpful if you use (custom) webhooks to trigger
rebuilds whenever code is pushed into one of your repositories.</p>
<p>To rebuild only particular packages, pass the package names on the command line
like so:</p>
<pre><code>php bin/satis build satis.json web/ this/package that/other-package
</code></pre>
<p>Note that this will still need to pull and scan all of your VCS repositories
because any VCS repository might contain (on any branch) one of the selected
packages.</p>
<p>If you want to scan only the selected package and not all VCS repositories you need
to declare a <em>name</em> for all your package (this only work on VCS repositories type) :</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [
    { &quot;name&quot;: &quot;company/privaterepo&quot;, &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo&quot; },
    { &quot;name&quot;: &quot;private/repo&quot;, &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;http://svn.example.org/private/repo&quot; },
    { &quot;name&quot;: &quot;mycompany/privaterepo2&quot;, &quot;type&quot;: &quot;vcs&quot;, &quot;url&quot;: &quot;https://github.com/mycompany/privaterepo2&quot; }
  ]
}
</code></pre>
<p>If you want to scan only a single repository and update all packages found in
it, pass the VCS repository URL as an optional argument:</p>
<pre><code>php bin/satis build --repository-url https://only.my/repo.git satis.json web/
</code></pre>
<h2 id="usage-1"><a class="header" href="#usage-1">Usage</a></h2>
<p>In your projects all you need to add now is your own Composer repository using
the <code>packages.example.org</code> as URL, then you can require your private packages
and everything should work smoothly. You don't need to copy all your
repositories in every project anymore. Only that one unique repository that
will update itself.</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [ { &quot;type&quot;: &quot;composer&quot;, &quot;url&quot;: &quot;http://packages.example.org/&quot; } ],
  &quot;require&quot;: {
    &quot;company/package&quot;: &quot;1.2.0&quot;,
    &quot;company/package2&quot;: &quot;1.5.2&quot;,
    &quot;company/package3&quot;: &quot;dev-master&quot;
  }
}
</code></pre>
<h3 id="security"><a class="header" href="#security">Security</a></h3>
<p>To secure your private repository you can host it over SSH or SSL using a client
certificate. In your project you can use the <code>options</code> parameter to specify the
connection options for the server.</p>
<p>Example using a custom repository using SSH (requires the SSH2 PECL extension):</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [{
    &quot;type&quot;: &quot;composer&quot;,
    &quot;url&quot;: &quot;ssh2.sftp://example.org&quot;,
    &quot;options&quot;: {
      &quot;ssh2&quot;: {
        &quot;username&quot;: &quot;composer&quot;,
        &quot;pubkey_file&quot;: &quot;/home/composer/.ssh/id_rsa.pub&quot;,
        &quot;privkey_file&quot;: &quot;/home/composer/.ssh/id_rsa&quot;
      }
    }
  }]
}
</code></pre>
<blockquote>
<p><strong>Tip:</strong> See <a href="https://secure.php.net/manual/en/wrappers.ssh2.php#refsect1-wrappers.ssh2-options">ssh2 context options</a> for more information.</p>
</blockquote>
<p>Example using SSL/TLS (HTTPS) using a client certificate:</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [{
     &quot;type&quot;: &quot;composer&quot;,
     &quot;url&quot;: &quot;https://example.org&quot;,
     &quot;options&quot;: {
       &quot;ssl&quot;: {
         &quot;local_cert&quot;: &quot;/home/composer/.ssl/composer.pem&quot;
       }
     }
  }]
}
</code></pre>
<blockquote>
<p><strong>Tip:</strong> See <a href="https://secure.php.net/manual/en/context.ssl.php">ssl context options</a> for more information.</p>
</blockquote>
<p>Example using a custom HTTP Header field for token authentication:</p>
<pre><code class="language-json">{
  &quot;repositories&quot;: [{
    &quot;type&quot;: &quot;composer&quot;,
    &quot;url&quot;: &quot;https://example.org&quot;,
    &quot;options&quot;:  {
      &quot;http&quot;: {
        &quot;header&quot;: [
          &quot;API-TOKEN: YOUR-API-TOKEN&quot;
        ]
      }
    }
  }]
}
</code></pre>
<h3 id="authentication"><a class="header" href="#authentication">Authentication</a></h3>
<p>Authentication can be handled in <a href="en/articles/authentication-for-private-packages.html">several different ways</a>.</p>
<h3 id="downloads"><a class="header" href="#downloads">Downloads</a></h3>
<p>When GitHub, GitLab or BitBucket repositories are mirrored on your local satis, the
build process will include the location of the downloads these platforms make
available. This means that the repository and your setup depend on the
availability of these services.</p>
<p>At the same time, this implies that all code which is hosted somewhere else (on
another service or for example in Subversion) will not have downloads available
and thus installations usually take a lot longer.</p>
<p>To enable your satis installation to create downloads for all (Git, Mercurial
and Subversion) your packages, add the following to your <code>satis.json</code>:</p>
<pre><code class="language-json">{
  &quot;archive&quot;: {
    &quot;directory&quot;: &quot;dist&quot;,
    &quot;format&quot;: &quot;tar&quot;,
    &quot;prefix-url&quot;: &quot;https://amazing.cdn.example.org&quot;,
    &quot;skip-dev&quot;: true
  }
}
</code></pre>
<h4 id="options-explained"><a class="header" href="#options-explained">Options explained</a></h4>
<ul>
<li><code>directory</code>: required, the location of the dist files (inside the
<code>output-dir</code>)</li>
<li><code>format</code>: optional, <code>zip</code> (default) or <code>tar</code></li>
<li><code>prefix-url</code>: optional, location of the downloads, homepage (from
<code>satis.json</code>) followed by <code>directory</code> by default</li>
<li><code>skip-dev</code>: optional, <code>false</code> by default, when enabled (<code>true</code>) satis will
not create downloads for branches</li>
<li><code>absolute-directory</code>: optional, a <em>local</em> directory where the dist files are
dumped instead of <code>output-dir</code>/<code>directory</code></li>
<li><code>whitelist</code>: optional, if set as a list of package names, satis will only
dump the dist files of these packages</li>
<li><code>blacklist</code>: optional, if set as a list of package names, satis will not
dump the dist files of these packages</li>
<li><code>checksum</code>: optional, <code>true</code> by default, when disabled (<code>false</code>) satis will
not provide the sha1 checksum for the dist files</li>
</ul>
<p>Once enabled, all downloads (include those from GitHub and BitBucket) will be
replaced with a <em>local</em> version.</p>
<h4 id="prefix-url"><a class="header" href="#prefix-url">prefix-url</a></h4>
<p>Prefixing the URL with another host is especially helpful if the downloads end
up in a private Amazon S3 bucket or on a CDN host. A CDN would drastically
improve download times and therefore package installation.</p>
<p>Example: A <code>prefix-url</code> of <code>https://my-bucket.s3.amazonaws.com</code> (and
<code>directory</code> set to <code>dist</code>) creates download URLs which look like the following:
<code>https://my-bucket.s3.amazonaws.com/dist/vendor-package-version-ref.zip</code>.</p>
<h3 id="web-outputs"><a class="header" href="#web-outputs">Web outputs</a></h3>
<ul>
<li><code>output-html</code>: optional, <code>true</code> by default, when disabled (<code>false</code>) satis
will not generate the <code>output-dir</code>/index.html page.</li>
<li><code>twig-template</code>: optional, a path to a personalized <a href="https://twig.sensiolabs.org/">Twig</a> template for
the <code>output-dir</code>/index.html page.</li>
</ul>
<h3 id="abandoned-packages"><a class="header" href="#abandoned-packages">Abandoned packages</a></h3>
<p>To enable your satis installation to indicate that some packages are abandoned,
add the following to your <code>satis.json</code>:</p>
<pre><code class="language-json">{
  &quot;abandoned&quot;: {
    &quot;company/package&quot;: true,
    &quot;company/package2&quot;: &quot;company/newpackage&quot;
  }
}
</code></pre>
<p>The <code>true</code> value indicates that the package is truly abandoned while the
<code>&quot;company/newpackage&quot;</code> value specifies that the package is replaced by the
<code>company/newpackage</code> package.</p>
<p>Note that all packages set as abandoned in their own <code>composer.json</code> file will
be marked abandoned as well.</p>
<h3 id="resolving-dependencies"><a class="header" href="#resolving-dependencies">Resolving dependencies</a></h3>
<p>It is possible to make satis automatically resolve and add all dependencies for
your projects. This can be used with the Downloads functionality to have a
complete local mirror of packages. Add the following to your <code>satis.json</code>:</p>
<pre><code class="language-json">{
  &quot;require-dependencies&quot;: true,
  &quot;require-dev-dependencies&quot;: true
}
</code></pre>
<p>When searching for packages, satis will attempt to resolve all the required
packages from the listed repositories.  Therefore, if you are requiring a
package from Packagist, you will need to define it in your <code>satis.json</code>.</p>
<p>Dev dependencies are packaged only if the <code>require-dev-dependencies</code> parameter
is set to true.</p>
<h3 id="other-options"><a class="header" href="#other-options">Other options</a></h3>
<ul>
<li><code>providers</code>: optional, <code>false</code> by default, when enabled (<code>true</code>) each
package will be dumped into a separate include file which will be only
loaded by Composer when the package is really required. Speeds up composer
handling for repositories with huge number of packages like f.i. packagist.</li>
<li><code>output-dir</code>: optional, defines where to output the repository files if not
provided as an argument when calling the <code>build</code> command.</li>
<li><code>config</code>: optional, lets you define all config options from composer, except
<code>archive-format</code> and <code>archive-dir</code> as the configuration is done through
<a href="en/articles/handling-private-packages.html#downloads">archive</a> instead. See docs on <a href="https://getcomposer.org/doc/04-schema.md#config">config schema</a> for more details.</li>
<li><code>notify-batch</code>: optional, specify a URL that will be called every time a
user installs a package. See <a href="https://getcomposer.org/doc/05-repositories.md#notify-batch">notify-batch</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Modify and extend Composer's functionality
-->
<h1 id="setting-up-and-using-plugins"><a class="header" href="#setting-up-and-using-plugins">Setting up and using plugins</a></h1>
<h2 id="synopsis-1"><a class="header" href="#synopsis-1">Synopsis</a></h2>
<p>You may wish to alter or expand Composer's functionality with your own. For
example if your environment poses special requirements on the behaviour of
Composer which do not apply to the majority of its users or if you wish to
accomplish something with Composer in a way that is not desired by most users.</p>
<p>In these cases you could consider creating a plugin to handle your
specific logic.</p>
<h2 id="creating-a-plugin"><a class="header" href="#creating-a-plugin">Creating a Plugin</a></h2>
<p>A plugin is a regular Composer package which ships its code as part of the
package and may also depend on further packages.</p>
<h3 id="plugin-package"><a class="header" href="#plugin-package">Plugin Package</a></h3>
<p>The package file is the same as any other package file but with the following
requirements:</p>
<ol>
<li>The <a href="en/articles/../04-schema.html#type">type</a> attribute must be <code>composer-plugin</code>.</li>
<li>The <a href="en/articles/../04-schema.html#extra">extra</a> attribute must contain an element <code>class</code> defining the
class name of the plugin (including namespace). If a package contains
multiple plugins, this can be an array of class names.</li>
<li>You must require the special package called <code>composer-plugin-api</code>
to define which Plugin API versions your plugin is compatible with.
Requiring this package doesn't actually include any extra dependencies,
it only specifies which version of the plugin API to use.</li>
</ol>
<blockquote>
<p><strong>Note:</strong> When developing a plugin, although not required, it's useful to add
a require-dev dependency on <code>composer/composer</code> to have IDE autocompletion on Composer classes.</p>
</blockquote>
<p>The required version of the <code>composer-plugin-api</code> follows the same <a href="en/articles/../01-basic-usage.html#package-versions">rules</a>
as a normal package's rules.</p>
<p>The current Composer plugin API version is <code>2.3.0</code>.</p>
<p>An example of a valid plugin <code>composer.json</code> file (with the autoloading
part omitted and an optional require-dev dependency on <code>composer/composer</code> for IDE auto completion):</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my/plugin-package&quot;,
    &quot;type&quot;: &quot;composer-plugin&quot;,
    &quot;require&quot;: {
        &quot;composer-plugin-api&quot;: &quot;^2.0&quot;
    },
    &quot;require-dev&quot;: {
        &quot;composer/composer&quot;: &quot;^2.0&quot;
    },
    &quot;extra&quot;: {
        &quot;class&quot;: &quot;My\\Plugin&quot;
    }
}
</code></pre>
<h3 id="plugin-class"><a class="header" href="#plugin-class">Plugin Class</a></h3>
<p>Every plugin has to supply a class which implements the
<a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/PluginInterface.php"><code>Composer\Plugin\PluginInterface</code></a>. The <code>activate()</code> method of the plugin
is called after the plugin is loaded and receives an instance of
<a href="https://github.com/composer/composer/blob/main/src/Composer/Composer.php"><code>Composer\Composer</code></a> as well as an instance of
<a href="https://github.com/composer/composer/blob/main/src/Composer/IO/IOInterface.php"><code>Composer\IO\IOInterface</code></a>. Using these two objects all configuration can
be read and all internal objects and state can be manipulated as desired.</p>
<p>Example:</p>
<pre><code class="language-php">&lt;?php

namespace phpDocumentor\Composer;

use Composer\Composer;
use Composer\IO\IOInterface;
use Composer\Plugin\PluginInterface;

class TemplateInstallerPlugin implements PluginInterface
{
    public function activate(Composer $composer, IOInterface $io)
    {
        $installer = new TemplateInstaller($io, $composer);
        $composer-&gt;getInstallationManager()-&gt;addInstaller($installer);
    }
}
</code></pre>
<h2 id="event-handler"><a class="header" href="#event-handler">Event Handler</a></h2>
<p>Furthermore plugins may implement the
<a href="https://github.com/composer/composer/blob/main/src/Composer/EventDispatcher/EventSubscriberInterface.php"><code>Composer\EventDispatcher\EventSubscriberInterface</code></a> in order to have its
event handlers automatically registered with the <code>EventDispatcher</code> when the
plugin is loaded.</p>
<p>To register a method to an event, implement the method <code>getSubscribedEvents()</code>
and have it return an array. The array key must be the
<a href="https://getcomposer.org/doc/articles/scripts.md#event-names">event name</a>
and the value is the name of the method in this class to be called.</p>
<blockquote>
<p><strong>Note:</strong> If you don't know which event to listen to, you can run a Composer
command with the COMPOSER_DEBUG_EVENTS=1 environment variable set, which might
help you identify what event you are looking for.</p>
</blockquote>
<pre><code class="language-php">public static function getSubscribedEvents()
{
    return array(
        'post-autoload-dump' =&gt; 'methodToBeCalled',
        // ^ event name ^         ^ method name ^
    );
}
</code></pre>
<p>By default, the priority of an event handler is set to 0. The priority can be
changed by attaching a tuple where the first value is the method name, as
before, and the second value is an integer representing the priority.
Higher integers represent higher priorities. Priority 2 is called before
priority 1, etc.</p>
<pre><code class="language-php">public static function getSubscribedEvents()
{
    return array(
        // Will be called before events with priority 0
        'post-autoload-dump' =&gt; array('methodToBeCalled', 1)
    );
}
</code></pre>
<p>If multiple methods should be called, then an array of tuples can be attached
to each event. The tuples do not need to include the priority. If it is
omitted, it will default to 0.</p>
<pre><code class="language-php">public static function getSubscribedEvents()
{
    return array(
        'post-autoload-dump' =&gt; array(
            array('methodToBeCalled'      ), // Priority defaults to 0
            array('someOtherMethodName', 1), // This fires first
        )
    );
}
</code></pre>
<p>Here's a complete example:</p>
<pre><code class="language-php">&lt;?php

namespace Naderman\Composer\AWS;

use Composer\Composer;
use Composer\EventDispatcher\EventSubscriberInterface;
use Composer\IO\IOInterface;
use Composer\Plugin\PluginInterface;
use Composer\Plugin\PluginEvents;
use Composer\Plugin\PreFileDownloadEvent;

class AwsPlugin implements PluginInterface, EventSubscriberInterface
{
    protected $composer;
    protected $io;

    public function activate(Composer $composer, IOInterface $io)
    {
        $this-&gt;composer = $composer;
        $this-&gt;io = $io;
    }

    public function deactivate(Composer $composer, IOInterface $io)
    {
    }

    public function uninstall(Composer $composer, IOInterface $io)
    {
    }

    public static function getSubscribedEvents()
    {
        return array(
            PluginEvents::PRE_FILE_DOWNLOAD =&gt; array(
                array('onPreFileDownload', 0)
            ),
        );
    }

    public function onPreFileDownload(PreFileDownloadEvent $event)
    {
        $protocol = parse_url($event-&gt;getProcessedUrl(), PHP_URL_SCHEME);

        if ($protocol === 's3') {
            // ...
        }
    }
}
</code></pre>
<h2 id="plugin-capabilities"><a class="header" href="#plugin-capabilities">Plugin capabilities</a></h2>
<p>Composer defines a standard set of capabilities which may be implemented by plugins.
Their goal is to make the plugin ecosystem more stable as it reduces the need to mess
with <a href="https://github.com/composer/composer/blob/main/src/Composer/Composer.php"><code>Composer\Composer</code></a>'s internal state, by providing explicit extension points
for common plugin requirements.</p>
<p>Capable Plugins classes must implement the <a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/Capable.php"><code>Composer\Plugin\Capable</code></a> interface
and declare their capabilities in the <code>getCapabilities()</code> method.
This method must return an array, with the <em>key</em> as a Composer Capability class name,
and the <em>value</em> as the Plugin's own implementation class name of said Capability:</p>
<pre><code class="language-php">&lt;?php

namespace My\Composer;

use Composer\Composer;
use Composer\IO\IOInterface;
use Composer\Plugin\PluginInterface;
use Composer\Plugin\Capable;

class Plugin implements PluginInterface, Capable
{
    public function activate(Composer $composer, IOInterface $io)
    {
    }

    public function getCapabilities()
    {
        return array(
            'Composer\Plugin\Capability\CommandProvider' =&gt; 'My\Composer\CommandProvider',
        );
    }
}
</code></pre>
<h3 id="command-provider"><a class="header" href="#command-provider">Command provider</a></h3>
<p>The <a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/Capability/CommandProvider.php"><code>Composer\Plugin\Capability\CommandProvider</code></a> capability allows to register
additional commands for Composer:</p>
<pre><code class="language-php">&lt;?php

namespace My\Composer;

use Composer\Plugin\Capability\CommandProvider as CommandProviderCapability;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use Composer\Command\BaseCommand;

class CommandProvider implements CommandProviderCapability
{
    public function getCommands()
    {
        return array(new Command);
    }
}

class Command extends BaseCommand
{
    protected function configure(): void
    {
        $this-&gt;setName('custom-plugin-command');
    }

    protected function execute(InputInterface $input, OutputInterface $output): int
    {
        $output-&gt;writeln('Executing');
    }
}
</code></pre>
<p>Now the <code>custom-plugin-command</code> is available alongside Composer commands.</p>
<blockquote>
<p><em>Composer commands are based on the <a href="https://symfony.com/doc/current/components/console.html">Symfony Console Component</a>.</em></p>
</blockquote>
<h2 id="running-plugins-manually"><a class="header" href="#running-plugins-manually">Running plugins manually</a></h2>
<p>Plugins for an event can be run manually by the <code>run-script</code> command. This works the same way as
<a href="en/articles/scripts.html#running-scripts-manually">running scripts manually</a>.</p>
<h2 id="using-plugins"><a class="header" href="#using-plugins">Using Plugins</a></h2>
<p>Plugin packages are automatically loaded as soon as they are installed and will
be loaded when Composer starts up if they are found in the current project's
list of installed packages. Additionally all plugin packages installed in the
<code>COMPOSER_HOME</code> directory using the Composer global command are loaded before
local project plugins are loaded.</p>
<blockquote>
<p>You may pass the <code>--no-plugins</code> option to Composer commands to disable all
installed plugins. This may be particularly helpful if any of the plugins
causes errors and you wish to update or uninstall it.</p>
</blockquote>
<h2 id="plugin-helpers"><a class="header" href="#plugin-helpers">Plugin Helpers</a></h2>
<p>As of Composer 2, due to the fact that DownloaderInterface can sometimes return Promises
and have been split up in more steps than they used to, we provide a <a href="https://github.com/composer/composer/blob/main/src/Composer/Util/SyncHelper.php">SyncHelper</a>
to make downloading and installing packages easier.</p>
<h2 id="plugin-extra-attributes"><a class="header" href="#plugin-extra-attributes">Plugin Extra Attributes</a></h2>
<p>A few special plugin capabilities can be unlocked using extra attributes in the plugin's composer.json.</p>
<h3 id="class"><a class="header" href="#class">class</a></h3>
<p><a href="en/articles/plugins.html#plugin-package">See above</a> for an explanation of the class attribute and how it works.</p>
<h3 id="plugin-modifies-downloads"><a class="header" href="#plugin-modifies-downloads">plugin-modifies-downloads</a></h3>
<p>Some special plugins need to update package download URLs before they get downloaded.</p>
<p>As of Composer 2.0, all packages are downloaded before they get installed. This means
on the first installation, your plugin is not yet installed when the download occurs,
and it does not get a chance to update the URLs on time.</p>
<p>Specifying <code>{&quot;extra&quot;: {&quot;plugin-modifies-downloads&quot;: true}}</code> in your composer.json will
hint to Composer that the plugin should be installed on its own before proceeding with
the rest of the package downloads. This slightly slows down the overall installation
process however, so do not use it in plugins which do not absolutely require it.</p>
<h3 id="plugin-modifies-install-path"><a class="header" href="#plugin-modifies-install-path">plugin-modifies-install-path</a></h3>
<p>Some special plugins modify the install path of packages.</p>
<p>As of Composer 2.2.9, you can specify <code>{&quot;extra&quot;: {&quot;plugin-modifies-install-path&quot;: true}}</code>
in your composer.json to hint to Composer that the plugin should be activated as soon
as possible to prevent any bad side-effects from Composer assuming packages are installed
in another location than they actually are.</p>
<h2 id="plugin-autoloading"><a class="header" href="#plugin-autoloading">Plugin Autoloading</a></h2>
<p>Due to plugins being loaded by Composer at runtime, and to ensure that plugins which
depend on other packages can function correctly, a runtime autoloader is created whenever
a plugin is loaded. That autoloader is only configured to load with the plugin dependencies,
so you may not have access to all the packages which are installed.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Configure which packages are found in which repositories
-->
<h1 id="repository-priorities"><a class="header" href="#repository-priorities">Repository priorities</a></h1>
<h2 id="canonical-repositories"><a class="header" href="#canonical-repositories">Canonical repositories</a></h2>
<p>When Composer resolves dependencies, it will look up a given package in the
topmost repository. If that repository does not contain the package, it
goes on to the next one, until one repository contains it and the process ends.</p>
<p>Canonical repositories are better for a few reasons:</p>
<ul>
<li>Performance wise, it is more efficient to stop looking for a package once it
has been found somewhere. It also avoids loading duplicate packages in case
the same package is present in several of your repositories.</li>
<li>Security wise, it is safer to treat them canonically as it means that packages you
expect to come from your most important repositories will never be loaded from
another repository instead. Let's
say you have a private repository which is not canonical, and you require your
private package <code>foo/bar ^2.0</code> for example. Now if someone publishes
<code>foo/bar 2.999</code> to packagist.org, suddenly Composer will pick that package as it
has a higher version than your latest release (say 2.4.3), and you end up installing
something you may not have meant to. However, if the private repository is canonical,
that 2.999 version from packagist.org will not be considered at all.</li>
</ul>
<p>There are however a few cases where you may want to specifically load some packages
from a given repository, but not all. Or you may want a given repository to not be
canonical, and to be only preferred if it has higher package versions than the
repositories defined below.</p>
<h2 id="default-behavior"><a class="header" href="#default-behavior">Default behavior</a></h2>
<p>By default in Composer 2.x all repositories are canonical. Composer 1.x treated
all repositories as non-canonical.</p>
<p>Another default is that the packagist.org repository is always added implicitly
as the last repository, unless you <a href="en/articles/../05-repositories.html#disabling-packagist-org">disable it</a>.</p>
<h2 id="making-repositories-non-canonical"><a class="header" href="#making-repositories-non-canonical">Making repositories non-canonical</a></h2>
<p>You can add the canonical option to any repository to disable this default behavior
and make sure Composer keeps looking in other repositories, even if that repository
contains a given package.</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;,
            &quot;canonical&quot;: false
        }
    ]
}
</code></pre>
<h2 id="filtering-packages"><a class="header" href="#filtering-packages">Filtering packages</a></h2>
<p>You can also filter packages which a repository will be able to load, either by
selecting which ones you want, or by excluding those you do not want.</p>
<p>For example here we want to pick only the package <code>foo/bar</code> and all the packages from
<code>some-vendor/</code> from this Composer repository.</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;,
            &quot;only&quot;: [&quot;foo/bar&quot;, &quot;some-vendor/*&quot;]
        }
    ]
}
</code></pre>
<p>And in this other example we exclude <code>toy/package</code> from a repository, which
we may not want to load in this project.</p>
<pre><code class="language-json">{
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;composer&quot;,
            &quot;url&quot;: &quot;https://example.org&quot;,
            &quot;exclude&quot;: [&quot;toy/package&quot;]
        }
    ]
}
</code></pre>
<p>Both <code>only</code> and <code>exclude</code> should be arrays of package names, which can also
contain wildcards (<code>*</code>), which will match any character.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: On gracefully resolving conflicts while merging
-->
<h1 id="resolving-merge-conflicts"><a class="header" href="#resolving-merge-conflicts">Resolving merge conflicts</a></h1>
<p>When working as a team on the same Composer project, you will eventually run into a scenario
where multiple people added, updated or removed something in the <code>composer.json</code> and
<code>composer.lock</code> files in multiple branches. When those branches are eventually merged
together, you will get merge conflicts. Resolving these merge conflicts is not as straight
forward as on other files, especially not regarding the <code>composer.lock</code> file.</p>
<blockquote>
<p><strong>Note:</strong> It might not immediately be obvious why text based merging is not possible for
lock files, so let's imagine the following example where we want to merge two branches;</p>
<ul>
<li>Branch 1 has added package A which requires package B. Package B is locked at version <code>1.0.0</code>.</li>
<li>Branch 2 has added package C which conflicts with all versions below <code>1.2.0</code> of package B.</li>
</ul>
<p>A text based merge would result in package A version <code>1.0.0</code>, package B version <code>1.0.0</code>
and package C version <code>1.0.0</code>. This is an invalid result, as the conflict of package C
was not considered and would require an upgrade of package B.</p>
</blockquote>
<h2 id="1-reapplying-changes"><a class="header" href="#1-reapplying-changes">1. Reapplying changes</a></h2>
<p>The safest method to merge Composer files is to accept the version from one branch and apply
the changes from the other branch.</p>
<p>An example where we have two branches:</p>
<ol>
<li>Package 'A' has been added</li>
<li>Package 'B' has been removed and package 'C' is added.</li>
</ol>
<p>To resolve the conflict when we merge these two branches:</p>
<ul>
<li>We choose the branch that has the most changes, and accept the <code>composer.json</code> and <code>composer.lock</code>
files from that branch. In this case, we choose the Composer files from branch 2.</li>
<li>We reapply the changes from the other branch (branch 1). In this case we have to run
<code>composer require package/A</code> again.</li>
</ul>
<h2 id="2-validating-your-merged-files"><a class="header" href="#2-validating-your-merged-files">2. Validating your merged files</a></h2>
<p>Before committing, make sure the resulting <code>composer.json</code> and <code>composer.lock</code> files are valid.
To do this, run the following commands:</p>
<pre><code class="language-sh">php composer.phar validate
php composer.phar install [--dry-run]
</code></pre>
<h2 id="important-considerations"><a class="header" href="#important-considerations">Important considerations</a></h2>
<p>Keep in mind that whenever merge conflicts occur on the lock file, the information, about the exact version
new packages were locked on for one of the branches, is lost. When package A in branch 1 is constrained
as <code>^1.2.0</code> and locked as <code>1.2.0</code>, it might get updated when branch 2 is used as baseline and a new
<code>composer require package/A:^1.2.0</code> is executed, as that will use the most recent version that the
constraint allows when possible. There might be a version 1.3.0 for that package available by now, which
will now be used instead.</p>
<p>Choosing the correct <a href="en/articles/../articles/versions.html">version constraints</a> and making sure the packages adhere
to <a href="https://semver.org/">semantic versioning</a> when using
<a href="en/articles/versions.html#next-significant-release-operators">next significant release operators</a> should make sure
that merging branches does not break anything by accidentally updating a dependency.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Script are callbacks that are called before/after installing packages
-->
<h1 id="scripts"><a class="header" href="#scripts">Scripts</a></h1>
<h2 id="what-is-a-script"><a class="header" href="#what-is-a-script">What is a script?</a></h2>
<p>A script, in Composer's terms, can either be a PHP callback (defined as a
static method) or any command-line executable command. Scripts are useful
for executing a package's custom code or package-specific commands during
the Composer execution process.</p>
<blockquote>
<p><strong>Note:</strong> Only scripts defined in the root package's <code>composer.json</code> are
executed. If a dependency of the root package specifies its own scripts,
Composer does not execute those additional scripts.</p>
</blockquote>
<h2 id="event-names"><a class="header" href="#event-names">Event names</a></h2>
<p>Composer fires the following named events during its execution process:</p>
<h3 id="command-events"><a class="header" href="#command-events">Command Events</a></h3>
<ul>
<li><strong>pre-install-cmd</strong>: occurs before the <code>install</code> command is executed with a
lock file present.</li>
<li><strong>post-install-cmd</strong>: occurs after the <code>install</code> command has been executed
with a lock file present.</li>
<li><strong>pre-update-cmd</strong>: occurs before the <code>update</code> command is executed, or before
the <code>install</code> command is executed without a lock file present.</li>
<li><strong>post-update-cmd</strong>: occurs after the <code>update</code> command has been executed, or
after the <code>install</code> command has been executed without a lock file present.</li>
<li><strong>pre-status-cmd</strong>: occurs before the <code>status</code> command is executed.</li>
<li><strong>post-status-cmd</strong>: occurs after the <code>status</code> command has been executed.</li>
<li><strong>pre-archive-cmd</strong>: occurs before the <code>archive</code> command is executed.</li>
<li><strong>post-archive-cmd</strong>: occurs after the <code>archive</code> command has been executed.</li>
<li><strong>pre-autoload-dump</strong>: occurs before the autoloader is dumped, either during
<code>install</code>/<code>update</code>, or via the <code>dump-autoload</code> command.</li>
<li><strong>post-autoload-dump</strong>: occurs after the autoloader has been dumped, either
during <code>install</code>/<code>update</code>, or via the <code>dump-autoload</code> command.</li>
<li><strong>post-root-package-install</strong>: occurs after the root package has been
installed during the <code>create-project</code> command (but before its
dependencies are installed).</li>
<li><strong>post-create-project-cmd</strong>: occurs after the <code>create-project</code> command has
been executed.</li>
</ul>
<h3 id="installer-events"><a class="header" href="#installer-events">Installer Events</a></h3>
<ul>
<li><strong>pre-operations-exec</strong>: occurs before the install/upgrade/.. operations
are executed when installing a lock file. Plugins that need to hook into
this event will need to be installed globally to be usable, as otherwise
they would not be loaded yet when a fresh install of a project happens.</li>
</ul>
<h3 id="package-events"><a class="header" href="#package-events">Package Events</a></h3>
<ul>
<li><strong>pre-package-install</strong>: occurs before a package is installed.</li>
<li><strong>post-package-install</strong>: occurs after a package has been installed.</li>
<li><strong>pre-package-update</strong>: occurs before a package is updated.</li>
<li><strong>post-package-update</strong>: occurs after a package has been updated.</li>
<li><strong>pre-package-uninstall</strong>: occurs before a package is uninstalled.</li>
<li><strong>post-package-uninstall</strong>: occurs after a package has been uninstalled.</li>
</ul>
<h3 id="plugin-events"><a class="header" href="#plugin-events">Plugin Events</a></h3>
<ul>
<li><strong>init</strong>: occurs after a Composer instance is done being initialized.</li>
<li><strong>command</strong>: occurs before any Composer Command is executed on the CLI. It
provides you with access to the input and output objects of the program.</li>
<li><strong>pre-file-download</strong>: occurs before files are downloaded and allows
you to manipulate the <code>HttpDownloader</code> object prior to downloading files
based on the URL to be downloaded.</li>
<li><strong>post-file-download</strong>: occurs after package dist files are downloaded and
allows you to perform additional checks on the file if required.</li>
<li><strong>pre-command-run</strong>: occurs before a command is executed and allows you to
manipulate the <code>InputInterface</code> object's options and arguments to tweak
a command's behavior.</li>
<li><strong>pre-pool-create</strong>: occurs before the Pool of packages is created, and lets
you filter the list of packages that is going to enter the Solver.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Composer makes no assumptions about the state of your dependencies
prior to <code>install</code> or <code>update</code>. Therefore, you should not specify scripts
that require Composer-managed dependencies in the <code>pre-update-cmd</code> or
<code>pre-install-cmd</code> event hooks. If you need to execute scripts prior to
<code>install</code> or <code>update</code> please make sure they are self-contained within your
root package.</p>
</blockquote>
<h2 id="defining-scripts"><a class="header" href="#defining-scripts">Defining scripts</a></h2>
<p>The root JSON object in <code>composer.json</code> should have a property called
<code>&quot;scripts&quot;</code>, which contains pairs of named events and each event's
corresponding scripts. An event's scripts can be defined as either a string
(only for a single script) or an array (for single or multiple scripts.)</p>
<p>For any given event:</p>
<ul>
<li>Scripts execute in the order defined when their corresponding event is fired.</li>
<li>An array of scripts wired to a single event can contain both PHP callbacks
and command-line executable commands.</li>
<li>PHP classes containing defined callbacks must be autoloadable via Composer's
autoload functionality.</li>
<li>Callbacks can only autoload classes from psr-0, psr-4 and classmap
definitions. If a defined callback relies on functions defined outside of a
class, the callback itself is responsible for loading the file containing these
functions.</li>
</ul>
<p>Script definition example:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;post-update-cmd&quot;: &quot;MyVendor\\MyClass::postUpdate&quot;,
        &quot;post-package-install&quot;: [
            &quot;MyVendor\\MyClass::postPackageInstall&quot;
        ],
        &quot;post-install-cmd&quot;: [
            &quot;MyVendor\\MyClass::warmCache&quot;,
            &quot;phpunit -c app/&quot;
        ],
        &quot;post-autoload-dump&quot;: [
            &quot;MyVendor\\MyClass::postAutoloadDump&quot;
        ],
        &quot;post-create-project-cmd&quot;: [
            &quot;php -r \&quot;copy('config/local-example.php', 'config/local.php');\&quot;&quot;
        ]
    }
}
</code></pre>
<p>Using the previous definition example, here's the class <code>MyVendor\MyClass</code>
that might be used to execute the PHP callbacks:</p>
<pre><code class="language-php">&lt;?php

namespace MyVendor;

use Composer\Script\Event;
use Composer\Installer\PackageEvent;

class MyClass
{
    public static function postUpdate(Event $event)
    {
        $composer = $event-&gt;getComposer();
        // do stuff
    }

    public static function postAutoloadDump(Event $event)
    {
        $vendorDir = $event-&gt;getComposer()-&gt;getConfig()-&gt;get('vendor-dir');
        require $vendorDir . '/autoload.php';

        some_function_from_an_autoloaded_file();
    }

    public static function postPackageInstall(PackageEvent $event)
    {
        $installedPackage = $event-&gt;getOperation()-&gt;getPackage();
        // do stuff
    }

    public static function warmCache(Event $event)
    {
        // make cache toasty
    }
}
</code></pre>
<p><strong>Note:</strong> During a Composer <code>install</code> or <code>update</code> command run, a variable named
<code>COMPOSER_DEV_MODE</code> will be added to the environment. If the command was run
with the <code>--no-dev</code> flag, this variable will be set to 0, otherwise it will be
set to 1. The variable is also available while <code>dump-autoload</code> runs, and it
will be set to the same as the last <code>install</code> or <code>update</code> was run in.</p>
<h2 id="event-classes"><a class="header" href="#event-classes">Event classes</a></h2>
<p>When an event is fired, your PHP callback receives as first argument a
<code>Composer\EventDispatcher\Event</code> object. This object has a <code>getName()</code> method
that lets you retrieve the event name.</p>
<p>Depending on the <a href="en/articles/scripts.html#event-names">script types</a> you will get various event
subclasses containing various getters with relevant data and associated
objects:</p>
<ul>
<li>Base class: <a href="https://github.com/composer/composer/blob/main/src/Composer/EventDispatcher/Event.php"><code>Composer\EventDispatcher\Event</code></a></li>
<li>Command Events: <a href="https://github.com/composer/composer/blob/main/src/Composer/Script/Event.php"><code>Composer\Script\Event</code></a></li>
<li>Installer Events: <a href="https://github.com/composer/composer/blob/main/src/Composer/Installer/InstallerEvent.php"><code>Composer\Installer\InstallerEvent</code></a></li>
<li>Package Events: <a href="https://github.com/composer/composer/blob/main/src/Composer/Installer/PackageEvent.php"><code>Composer\Installer\PackageEvent</code></a></li>
<li>Plugin Events:
<ul>
<li>init: <a href="https://github.com/composer/composer/blob/main/src/Composer/EventDispatcher/Event.php"><code>Composer\EventDispatcher\Event</code></a></li>
<li>command: <a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/CommandEvent.php"><code>Composer\Plugin\CommandEvent</code></a></li>
<li>pre-file-download: <a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/PreFileDownloadEvent.php"><code>Composer\Plugin\PreFileDownloadEvent</code></a></li>
<li>post-file-download: <a href="https://github.com/composer/composer/blob/main/src/Composer/Plugin/PostFileDownloadEvent.php"><code>Composer\Plugin\PostFileDownloadEvent</code></a></li>
</ul>
</li>
</ul>
<h2 id="running-scripts-manually"><a class="header" href="#running-scripts-manually">Running scripts manually</a></h2>
<p>If you would like to run the scripts for an event manually, the syntax is:</p>
<pre><code class="language-sh">php composer.phar run-script [--dev] [--no-dev] script
</code></pre>
<p>For example <code>composer run-script post-install-cmd</code> will run any
<strong>post-install-cmd</strong> scripts and <a href="en/articles/plugins.html">plugins</a> that have been defined.</p>
<p>You can also give additional arguments to the script handler by appending <code>--</code>
followed by the handler arguments. e.g.
<code>composer run-script post-install-cmd -- --check</code> will pass<code>--check</code> along to
the script handler. Those arguments are received as CLI arg by CLI handlers,
and can be retrieved as an array via <code>$event-&gt;getArguments()</code> by PHP handlers.</p>
<h2 id="writing-custom-commands"><a class="header" href="#writing-custom-commands">Writing custom commands</a></h2>
<p>If you add custom scripts that do not fit one of the predefined event name
above, you can either run them with run-script or also run them as native
Composer commands. For example the handler defined below is executable by
running <code>composer test</code>:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: &quot;phpunit&quot;
    }
}
</code></pre>
<p>Similar to the <code>run-script</code> command you can give additional arguments to scripts,
e.g. <code>composer test -- --filter &lt;pattern&gt;</code> will pass <code>--filter &lt;pattern&gt;</code> along
to the <code>phpunit</code> script.</p>
<blockquote>
<p><strong>Note:</strong> Before executing scripts, Composer's bin-dir is temporarily pushed
on top of the PATH environment variable so that binaries of dependencies
are directly accessible. In this example no matter if the <code>phpunit</code> binary is
actually in <code>vendor/bin/phpunit</code> or <code>bin/phpunit</code> it will be found and executed.</p>
</blockquote>
<p>Although Composer is not intended to manage long-running processes and other
such aspects of PHP projects, it can sometimes be handy to disable the process
timeout on custom commands. This timeout defaults to 300 seconds and can be
overridden in a variety of ways depending on the desired effect:</p>
<ul>
<li>disable it for all commands using the config key <code>process-timeout</code>,</li>
<li>disable it for the current or future invocations of composer using the
environment variable <code>COMPOSER_PROCESS_TIMEOUT</code>,</li>
<li>for a specific invocation using the <code>--timeout</code> flag of the <code>run-script</code> command,</li>
<li>using a static helper for specific scripts.</li>
</ul>
<p>To disable the timeout for specific scripts with the static helper directly in
composer.json:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: [
            &quot;Composer\\Config::disableProcessTimeout&quot;,
            &quot;phpunit&quot;
        ]
    }
}
</code></pre>
<p>To disable the timeout for every script on a given project, you can use the
composer.json configuration:</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;process-timeout&quot;: 0
    }
}
</code></pre>
<p>It's also possible to set the global environment variable to disable the timeout
of all following scripts in the current terminal environment:</p>
<pre><code>export COMPOSER_PROCESS_TIMEOUT=0
</code></pre>
<p>To disable the timeout of a single script call, you must use the <code>run-script</code> composer
command and specify the <code>--timeout</code> parameter:</p>
<pre><code>php composer.phar run-script --timeout=0 test
</code></pre>
<h2 id="referencing-scripts"><a class="header" href="#referencing-scripts">Referencing scripts</a></h2>
<p>To enable script re-use and avoid duplicates, you can call a script from another
one by prefixing the command name with <code>@</code>:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: [
            &quot;@clearCache&quot;,
            &quot;phpunit&quot;
        ],
        &quot;clearCache&quot;: &quot;rm -rf cache/*&quot;
    }
}
</code></pre>
<p>You can also refer a script and pass it new arguments:</p>
<pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;tests&quot;: &quot;phpunit&quot;,
    &quot;testsVerbose&quot;: &quot;@tests -vvv&quot;
  }
}
</code></pre>
<h2 id="calling-composer-commands"><a class="header" href="#calling-composer-commands">Calling Composer commands</a></h2>
<p>To call Composer commands, you can use <code>@composer</code> which will automatically
resolve to whatever composer.phar is currently being used:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: [
            &quot;@composer install&quot;,
            &quot;phpunit&quot;
        ]
    }
}
</code></pre>
<p>One limitation of this is that you can not call multiple composer commands in
a row like <code>@composer install &amp;&amp; @composer foo</code>. You must split them up in a
JSON array of commands.</p>
<h2 id="executing-php-scripts"><a class="header" href="#executing-php-scripts">Executing PHP scripts</a></h2>
<p>To execute PHP scripts, you can use <code>@php</code> which will automatically
resolve to whatever php process is currently being used:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;test&quot;: [
            &quot;@php script.php&quot;,
            &quot;phpunit&quot;
        ]
    }
}
</code></pre>
<p>One limitation of this is that you can not call multiple commands in
a row like <code>@php install &amp;&amp; @php foo</code>. You must split them up in a
JSON array of commands.</p>
<p>You can also call a shell/bash script, which will have the path to
the PHP executable available in it as a <code>PHP_BINARY</code> env var.</p>
<h2 id="setting-environment-variables"><a class="header" href="#setting-environment-variables">Setting environment variables</a></h2>
<p>To set an environment variable in a cross-platform way, you can use <code>@putenv</code>:</p>
<pre><code class="language-json">{
    &quot;scripts&quot;: {
        &quot;install-phpstan&quot;: [
            &quot;@putenv COMPOSER=phpstan-composer.json&quot;,
            &quot;composer install --prefer-dist&quot;
        ]
    }
}
</code></pre>
<h2 id="custom-descriptions"><a class="header" href="#custom-descriptions">Custom descriptions.</a></h2>
<p>You can set custom script descriptions with the following in your <code>composer.json</code>:</p>
<pre><code class="language-json">{
    &quot;scripts-descriptions&quot;: {
        &quot;test&quot;: &quot;Run all tests!&quot;
    }
}
</code></pre>
<p>The descriptions are used in <code>composer list</code> or <code>composer run -l</code> commands to
describe what the scripts do when the command is run.</p>
<blockquote>
<p><strong>Note:</strong> You can only set custom descriptions of custom commands.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Solving problems
-->
<h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<p>This is a list of common pitfalls on using Composer, and how to avoid them.</p>
<h2 id="general"><a class="header" href="#general">General</a></h2>
<ol>
<li>
<p>When facing any kind of problems using Composer, be sure to <strong>work with the
latest version</strong>. See <a href="en/articles/../03-cli.html#self-update">self-update</a> for details.</p>
</li>
<li>
<p>Before asking anyone, run <a href="en/articles/../03-cli.html#diagnose"><code>composer diagnose</code></a> to check
for common problems. If it all checks out, proceed to the next steps.</p>
</li>
<li>
<p>Make sure you have no problems with your setup by running the installer's
checks via <code>curl -sS https://getcomposer.org/installer | php -- --check</code>.</p>
</li>
<li>
<p>Try clearing Composer's cache by running <code>composer clear-cache</code>.</p>
</li>
<li>
<p>Ensure you're <strong>installing vendors straight from your <code>composer.json</code></strong> via
<code>rm -rf vendor &amp;&amp; composer update -v</code> when troubleshooting, excluding any
possible interferences with existing vendor installations or <code>composer.lock</code>
entries.</p>
</li>
</ol>
<h2 id="package-not-found"><a class="header" href="#package-not-found">Package not found</a></h2>
<ol>
<li>
<p>Double-check you <strong>don't have typos</strong> in your <code>composer.json</code> or repository
branches and tag names.</p>
</li>
<li>
<p>Be sure to <strong>set the right
<a href="en/articles/../04-schema.html#minimum-stability">minimum-stability</a></strong>. To get started or be
sure this is no issue, set <code>minimum-stability</code> to &quot;dev&quot;.</p>
</li>
<li>
<p>Packages <strong>not coming from <a href="https://packagist.org/">Packagist</a></strong> should
always be <strong>defined in the root package</strong> (the package depending on all
vendors).</p>
</li>
<li>
<p>Use the <strong>same vendor and package name</strong> throughout all branches and tags of
your repository, especially when maintaining a third party fork and using
<code>replace</code>.</p>
</li>
<li>
<p>If you are updating to a recently published version of a package, be aware that
Packagist has a delay of up to 1 minute before new packages are visible to Composer.</p>
</li>
<li>
<p>If you are updating a single package, it may depend on newer versions itself.
In this case add the <code>--with-dependencies</code> argument <strong>or</strong> add all dependencies which
need an update to the command.</p>
</li>
</ol>
<h2 id="package-is-not-updating-to-the-expected-version"><a class="header" href="#package-is-not-updating-to-the-expected-version">Package is not updating to the expected version</a></h2>
<p>Try running <code>php composer.phar why-not [package-name] [expected-version]</code>.</p>
<h2 id="dependencies-on-the-root-package"><a class="header" href="#dependencies-on-the-root-package">Dependencies on the root package</a></h2>
<p>When your root package depends on a package which ends up depending (directly or
indirectly) back on the root package itself, issues can occur in two cases:</p>
<ol>
<li>
<p>During development, if you are on a branch like <code>dev-main</code> and the branch has no
<a href="en/articles/aliases.html#branch-alias">branch-alias</a> defined, and the dependency on the root package
requires version <code>^2.0</code> for example, the <code>dev-main</code> version will not satisfy it.
The best solution here is to make sure you first define a branch alias.</p>
</li>
<li>
<p>In CI (Continuous Integration) runs, the problem might be that Composer is not able
to detect the version of the root package properly. If it is a git clone it is
generally alright and Composer will detect the version of the current branch,
but some CIs do shallow clones so that process can fail when testing pull requests
and feature branches. In these cases the branch alias may then not be recognized.
The best solution is to define the version you are on via an environment variable
called COMPOSER_ROOT_VERSION. You set it to <code>dev-main</code> for example to define
the root package's version as <code>dev-main</code>.
Use for example: <code>COMPOSER_ROOT_VERSION=dev-main composer install</code> to export
the variable only for the call to composer, or you can define it globally in the
CI env vars.</p>
</li>
</ol>
<h2 id="package-not-found-in-a-jenkins-build"><a class="header" href="#package-not-found-in-a-jenkins-build">Package not found in a Jenkins-build</a></h2>
<ol>
<li>
<p>Check the <a href="en/articles/troubleshooting.html#package-not-found">&quot;Package not found&quot;</a> item above.</p>
</li>
<li>
<p>The git-clone / checkout within Jenkins leaves the branch in a &quot;detached HEAD&quot;-state. As
a result, Composer may not able to identify the version of the current checked out branch
and may not be able to resolve a <a href="en/articles/troubleshooting.html#dependencies-on-the-root-package">dependency on the root package</a>.
To solve this problem, you can use the &quot;Additional Behaviours&quot; -&gt; &quot;Check out to specific local
branch&quot; in your Git-settings for your Jenkins-job, where your &quot;local branch&quot; shall be the same
branch as you are checking out. Using this, the checkout will not be in detached state any more
and the dependency on the root package should become satisfied.</p>
</li>
</ol>
<h2 id="i-have-a-dependency-which-contains-a-repositories-definition-in-its-composerjson-but-it-seems-to-be-ignored"><a class="header" href="#i-have-a-dependency-which-contains-a-repositories-definition-in-its-composerjson-but-it-seems-to-be-ignored">I have a dependency which contains a &quot;repositories&quot; definition in its composer.json, but it seems to be ignored.</a></h2>
<p>The <a href="en/articles/../04-schema.html#repositories"><code>repositories</code></a> configuration property is defined as <a href="en/articles/../04-schema.html#root-package">root-only</a>. It is not inherited. You can read more about the reasons behind this in the &quot;<a href="en/articles/../faqs/why-cant-composer-load-repositories-recursively.html">why can't
Composer load repositories recursively?</a>&quot; article.
The simplest work-around to this limitation, is moving or duplicating the <code>repositories</code> definition into your root
composer.json.</p>
<h2 id="i-have-locked-a-dependency-to-a-specific-commit-but-get-unexpected-results"><a class="header" href="#i-have-locked-a-dependency-to-a-specific-commit-but-get-unexpected-results">I have locked a dependency to a specific commit but get unexpected results.</a></h2>
<p>While Composer supports locking dependencies to a specific commit using the <code>#commit-ref</code> syntax, there are certain
caveats that one should take into account. The most important one is <a href="en/articles/../04-schema.html#package-links">documented</a>, but
frequently overlooked:</p>
<blockquote>
<p><strong>Note:</strong> While this is convenient at times, it should not be how you use
packages in the long term because it comes with a technical limitation. The
composer.json metadata will still be read from the branch name you specify
before the hash. Because of that in some cases it will not be a practical
workaround, and you should always try to switch to tagged releases as soon
as you can.</p>
</blockquote>
<p>There is no simple work-around to this limitation. It is therefore strongly recommended that you do not use it.</p>
<h2 id="need-to-override-a-package-version"><a class="header" href="#need-to-override-a-package-version">Need to override a package version</a></h2>
<p>Let's say your project depends on package A, which in turn depends on a specific
version of package B (say 0.1). But you need a different version of said package B (say 0.11).</p>
<p>You can fix this by aliasing version 0.11 to 0.1:</p>
<p>composer.json:</p>
<pre><code class="language-json">{
    &quot;require&quot;: {
        &quot;A&quot;: &quot;0.2&quot;,
        &quot;B&quot;: &quot;0.11 as 0.1&quot;
    }
}
</code></pre>
<p>See <a href="en/articles/aliases.html">aliases</a> for more information.</p>
<h2 id="figuring-out-where-a-config-value-came-from"><a class="header" href="#figuring-out-where-a-config-value-came-from">Figuring out where a config value came from</a></h2>
<p>Use <code>php composer.phar config --list --source</code> to see where each config value originated from.</p>
<h2 id="memory-limit-errors"><a class="header" href="#memory-limit-errors">Memory limit errors</a></h2>
<p>The first thing to do is to make sure you are running Composer 2, and if possible 2.2.0 or above.</p>
<p>Composer 1 used much more memory and upgrading to the latest version will give you much better and faster results.</p>
<p>Composer may sometimes fail on some commands with this message:</p>
<p><code>PHP Fatal error:  Allowed memory size of XXXXXX bytes exhausted &lt;...&gt;</code></p>
<p>In this case, the PHP <code>memory_limit</code> should be increased.</p>
<blockquote>
<p><strong>Note:</strong> Composer internally increases the <code>memory_limit</code> to <code>1.5G</code>.</p>
</blockquote>
<p>To get the current <code>memory_limit</code> value, run:</p>
<pre><code class="language-sh">php -r &quot;echo ini_get('memory_limit').PHP_EOL;&quot;
</code></pre>
<p>Try increasing the limit in your <code>php.ini</code> file (ex. <code>/etc/php5/cli/php.ini</code> for
Debian-like systems):</p>
<pre><code class="language-ini">; Use -1 for unlimited or define an explicit value like 2G
memory_limit = -1
</code></pre>
<p>Composer also respects a memory limit defined by the <code>COMPOSER_MEMORY_LIMIT</code> environment variable:</p>
<pre><code class="language-sh">COMPOSER_MEMORY_LIMIT=-1 composer.phar &lt;...&gt;
</code></pre>
<p>Or, you can increase the limit with a command-line argument:</p>
<pre><code class="language-sh">php -d memory_limit=-1 composer.phar &lt;...&gt;
</code></pre>
<p>This issue can also happen on cPanel instances, when the shell fork bomb protection is activated. For more information, see the <a href="https://documentation.cpanel.net/display/68Docs/Shell+Fork+Bomb+Protection">documentation</a> of the fork bomb feature on the cPanel site.</p>
<h2 id="xdebug-impact-on-composer"><a class="header" href="#xdebug-impact-on-composer">Xdebug impact on Composer</a></h2>
<p>To improve performance when the Xdebug extension is enabled, Composer automatically restarts PHP without it.
You can override this behavior by using an environment variable: <code>COMPOSER_ALLOW_XDEBUG=1</code>.</p>
<p>Composer will always show a warning if Xdebug is being used, but you can override this with an environment variable:
<code>COMPOSER_DISABLE_XDEBUG_WARN=1</code>. If you see this warning unexpectedly, then the restart process has failed:
please report this <a href="https://github.com/composer/composer/issues">issue</a>.</p>
<h2 id="the-system-cannot-find-the-path-specified-windows"><a class="header" href="#the-system-cannot-find-the-path-specified-windows">&quot;The system cannot find the path specified&quot; (Windows)</a></h2>
<ol>
<li>Open regedit.</li>
<li>Search for an <code>AutoRun</code> key inside <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor</code>,
<code>HKEY_CURRENT_USER\Software\Microsoft\Command Processor</code>
or <code>HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Command Processor</code>.</li>
<li>Check if it contains any path to a non-existent file, if it's the case, remove them.</li>
</ol>
<h2 id="api-rate-limit-and-oauth-tokens"><a class="header" href="#api-rate-limit-and-oauth-tokens">API rate limit and OAuth tokens</a></h2>
<p>Because of GitHub's rate limits on their API it can happen that Composer prompts
for authentication asking your username and password so it can go ahead with its work.</p>
<p>If you would prefer not to provide your GitHub credentials to Composer you can
manually create a token using the <a href="en/articles/authentication-for-private-packages.html#github-oauth">procedure documented here</a>.</p>
<p>Now Composer should install/update without asking for authentication.</p>
<h2 id="proc_open-fork-failed-errors"><a class="header" href="#proc_open-fork-failed-errors">proc_open(): fork failed errors</a></h2>
<p>If Composer shows proc_open() fork failed on some commands:</p>
<p><code>PHP Fatal error: Uncaught exception 'ErrorException' with message 'proc_open(): fork failed - Cannot allocate memory' in phar</code></p>
<p>This could be happening because the VPS runs out of memory and has no Swap space enabled.</p>
<pre><code class="language-sh">free -m

total used free shared buffers cached
Mem: 2048 357 1690 0 0 237
-/+ buffers/cache: 119 1928
Swap: 0 0 0
</code></pre>
<p>To enable the swap you can use for example:</p>
<pre><code class="language-sh">/bin/dd if=/dev/zero of=/var/swap.1 bs=1M count=1024
/sbin/mkswap /var/swap.1
/bin/chmod 0600 /var/swap.1
/sbin/swapon /var/swap.1
</code></pre>
<p>You can make a permanent swap file following this <a href="https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-ubuntu-14-04">tutorial</a>.</p>
<h2 id="proc_open-failed-to-open-stream-errors-windows"><a class="header" href="#proc_open-failed-to-open-stream-errors-windows">proc_open(): failed to open stream errors (Windows)</a></h2>
<p>If Composer shows proc_open(NUL) errors on Windows:</p>
<p><code>proc_open(NUL): failed to open stream: No such file or directory</code></p>
<p>This could be happening because you are working in a <em>OneDrive</em> directory and
using a version of PHP that does not support the file system semantics of this
service. The issue was fixed in PHP 7.2.23 and 7.3.10.</p>
<p>Alternatively it could be because the Windows Null Service is not enabled. For
more information, see this <a href="https://github.com/composer/composer/issues/7186#issuecomment-373134916">issue</a>.</p>
<h2 id="degraded-mode"><a class="header" href="#degraded-mode">Degraded Mode</a></h2>
<p>Due to some intermittent issues on Travis and other systems, we introduced a
degraded network mode which helps Composer finish successfully but disables
a few optimizations. This is enabled automatically when an issue is first
detected. If you see this issue sporadically you probably don't have to worry
(a slow or overloaded network can also cause those time outs), but if it
appears repeatedly you might want to look at the options below to identify
and resolve it.</p>
<p>If you have been pointed to this page, you want to check a few things:</p>
<ul>
<li>If you are using ESET antivirus, go in &quot;Advanced Settings&quot; and disable &quot;HTTP-scanner&quot;
under &quot;web access protection&quot;</li>
<li>If you are using IPv6, try disabling it. If that solves your issues, get in touch
with your ISP or server host, the problem is not at the Packagist level but in the
routing rules between you and Packagist (i.e. the internet at large). The best way to get
these fixed is to raise awareness to the network engineers that have the power to fix it.
Take a look at the next section for IPv6 workarounds.</li>
<li>If none of the above helped, please report the error.</li>
</ul>
<h2 id="operation-timed-out-ipv6-issues"><a class="header" href="#operation-timed-out-ipv6-issues">Operation timed out (IPv6 issues)</a></h2>
<p>You may run into errors if IPv6 is not configured correctly. A common error is:</p>
<pre><code>The &quot;https://getcomposer.org/version&quot; file could not be downloaded: failed to
open stream: Operation timed out
</code></pre>
<p>We recommend you fix your IPv6 setup. If that is not possible, you can try the
following workarounds:</p>
<p><strong>Workaround Linux:</strong></p>
<p>On linux, it seems that running this command helps to make ipv4 traffic have a
higher priority than ipv6, which is a better alternative than disabling ipv6 entirely:</p>
<pre><code class="language-bash">sudo sh -c &quot;echo 'precedence ::ffff:0:0/96 100' &gt;&gt; /etc/gai.conf&quot;
</code></pre>
<p><strong>Workaround Windows:</strong></p>
<p>On windows the only way is to disable ipv6 entirely I am afraid (either in windows or in your home router).</p>
<p><strong>Workaround Mac OS X:</strong></p>
<p>Get name of your network device:</p>
<pre><code class="language-bash">networksetup -listallnetworkservices
</code></pre>
<p>Disable IPv6 on that device (in this case &quot;Wi-Fi&quot;):</p>
<pre><code class="language-bash">networksetup -setv6off Wi-Fi
</code></pre>
<p>Run Composer ...</p>
<p>You can enable IPv6 again with:</p>
<pre><code class="language-bash">networksetup -setv6automatic Wi-Fi
</code></pre>
<p>That said, if this fixes your problem, please talk to your ISP about it to
try to resolve the routing errors. That's the best way to get things resolved
for everyone.</p>
<h2 id="composer-hangs-with-ssh-controlmaster"><a class="header" href="#composer-hangs-with-ssh-controlmaster">Composer hangs with SSH ControlMaster</a></h2>
<p>When you try to install packages from a Git repository and you use the <code>ControlMaster</code>
setting for your SSH connection, Composer might hang endlessly and you see a <code>sh</code>
process in the <code>defunct</code> state in your process list.</p>
<p>The reason for this is a SSH Bug: https://bugzilla.mindrot.org/show_bug.cgi?id=1988</p>
<p>As a workaround, open a SSH connection to your Git host before running Composer:</p>
<pre><code class="language-bash">ssh -t git@mygitserver.tld
php composer.phar update
</code></pre>
<p>See also https://github.com/composer/composer/issues/4180 for more information.</p>
<h2 id="zip-archives-are-not-unpacked-correctly"><a class="header" href="#zip-archives-are-not-unpacked-correctly">Zip archives are not unpacked correctly.</a></h2>
<p>Composer can unpack zipballs using either a system-provided <code>unzip</code> or <code>7z</code> (7-Zip) utility, or PHP's
native <code>ZipArchive</code> class. On OSes where ZIP files can contain permissions and symlinks, we recommend
installing <code>unzip</code> or <code>7z</code> as these features are not supported by <code>ZipArchive</code>.</p>
<h2 id="disabling-the-pool-optimizer"><a class="header" href="#disabling-the-pool-optimizer">Disabling the pool optimizer</a></h2>
<p>In Composer, the <code>Pool</code> class contains all the packages that are relevant for the dependency
resolving process. That is what is used to generate all the rules which are then
passed on to the dependency solver.
In order to improve performance, Composer tries to optimize this <code>Pool</code> by removing useless
package information early on.</p>
<p>If all goes well, you should never notice any issues with it but in case you run into
an unexpected result such as an unresolvable set of dependencies or conflicts where you
think Composer is wrong, you might want to disable the optimizer by using the environment
variable <code>COMPOSER_POOL_OPTIMIZER</code> and run the update again like so:</p>
<pre><code class="language-bash">COMPOSER_POOL_OPTIMIZER=0 php composer.phar update
</code></pre>
<p>Now double check if the result is still the same. It will take significantly longer and use
a lot more memory to run the dependency resolving process.</p>
<p>If the result is different, you likely hit a problem in the pool optimizer.
Please <a href="https://github.com/composer/composer/issues">report this issue</a> so it can be fixed.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Expose command-line scripts from packages
-->
<h1 id="vendor-binaries-and-the-vendorbin-directory"><a class="header" href="#vendor-binaries-and-the-vendorbin-directory">Vendor binaries and the <code>vendor/bin</code> directory</a></h1>
<h2 id="what-is-a-vendor-binary"><a class="header" href="#what-is-a-vendor-binary">What is a vendor binary?</a></h2>
<p>Any command line script that a Composer package would like to pass along
to a user who installs the package should be listed as a vendor binary.</p>
<p>If a package contains other scripts that are not needed by the package
users (like build or compile scripts) that code should not be listed
as a vendor binary.</p>
<h2 id="how-is-it-defined"><a class="header" href="#how-is-it-defined">How is it defined?</a></h2>
<p>It is defined by adding the <code>bin</code> key to a project's <code>composer.json</code>.
It is specified as an array of files so multiple binaries can be added
for any given project.</p>
<pre><code class="language-json">{
    &quot;bin&quot;: [&quot;bin/my-script&quot;, &quot;bin/my-other-script&quot;]
}
</code></pre>
<h2 id="what-does-defining-a-vendor-binary-in-composerjson-do"><a class="header" href="#what-does-defining-a-vendor-binary-in-composerjson-do">What does defining a vendor binary in composer.json do?</a></h2>
<p>It instructs Composer to install the package's binaries to <code>vendor/bin</code>
for any project that <strong>depends</strong> on that project.</p>
<p>This is a convenient way to expose useful scripts that would
otherwise be hidden deep in the <code>vendor/</code> directory.</p>
<h2 id="what-happens-when-composer-is-run-on-a-composerjson-that-defines-vendor-binaries"><a class="header" href="#what-happens-when-composer-is-run-on-a-composerjson-that-defines-vendor-binaries">What happens when Composer is run on a composer.json that defines vendor binaries?</a></h2>
<p>For the binaries that a package defines directly, nothing happens.</p>
<h2 id="what-happens-when-composer-is-run-on-a-composerjson-that-has-dependencies-with-vendor-binaries-listed"><a class="header" href="#what-happens-when-composer-is-run-on-a-composerjson-that-has-dependencies-with-vendor-binaries-listed">What happens when Composer is run on a composer.json that has dependencies with vendor binaries listed?</a></h2>
<p>Composer looks for the binaries defined in all of the dependencies. A
proxy file (or two on Windows/WSL) is created from each dependency's
binaries to <code>vendor/bin</code>.</p>
<p>Say package <code>my-vendor/project-a</code> has binaries setup like this:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my-vendor/project-a&quot;,
    &quot;bin&quot;: [&quot;bin/project-a-bin&quot;]
}
</code></pre>
<p>Running <code>composer install</code> for this <code>composer.json</code> will not do
anything with <code>bin/project-a-bin</code>.</p>
<p>Say project <code>my-vendor/project-b</code> has requirements setup like this:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my-vendor/project-b&quot;,
    &quot;require&quot;: {
        &quot;my-vendor/project-a&quot;: &quot;*&quot;
    }
}
</code></pre>
<p>Running <code>composer install</code> for this <code>composer.json</code> will look at
all of project-a's binaries and install them to <code>vendor/bin</code>.</p>
<p>In this case, Composer will make <code>vendor/my-vendor/project-a/bin/project-a-bin</code>
available as <code>vendor/bin/project-a-bin</code>.</p>
<h2 id="finding-the-composer-autoloader-from-a-binary"><a class="header" href="#finding-the-composer-autoloader-from-a-binary">Finding the Composer autoloader from a binary</a></h2>
<p>As of Composer 2.2, a new <code>$_composer_autoload_path</code> global variable
is defined by the bin proxy file, so that when your binary gets executed
it can use it to easily locate the project's autoloader.</p>
<p>This global will not be available however when running binaries defined
by the root package itself, so you need to have a fallback in place.</p>
<p>This can look like this for example:</p>
<pre><code class="language-php">&lt;?php

include $_composer_autoload_path ?? __DIR__ . '/../vendor/autoload.php';
</code></pre>
<p>If you want to rely on this in your package you should however make sure to
also require <code>&quot;composer-runtime-api&quot;: &quot;^2.2&quot;</code> to ensure that the package
gets installed with a Composer version supporting the feature.</p>
<h2 id="finding-the-composer-bin-dir-from-a-binary"><a class="header" href="#finding-the-composer-bin-dir-from-a-binary">Finding the Composer bin-dir from a binary</a></h2>
<p>As of Composer 2.2.2, a new <code>$_composer_bin_dir</code> global variable
is defined by the bin proxy file, so that when your binary gets executed
it can use it to easily locate the project's Composer bin directory.</p>
<p>For non-PHP binaries, as of Composer 2.2.6, the bin proxy sets a
<code>COMPOSER_RUNTIME_BIN_DIR</code> environment variable.</p>
<p>This global variable will not be available however when running binaries defined
by the root package itself, so you need to have a fallback in place.</p>
<p>This can look like this for example:</p>
<pre><code class="language-php">&lt;?php

$binDir = $_composer_bin_dir ?? __DIR__ . '/../vendor/bin';
</code></pre>
<pre><code class="language-php">#!/bin/bash

if [[ -z &quot;$COMPOSER_RUNTIME_BIN_DIR&quot; ]]; then
  BIN_DIR=&quot;$( cd &quot;$( dirname &quot;${BASH_SOURCE[0]}&quot; )&quot; &amp;&amp; pwd )&quot;
else
  BIN_DIR=&quot;$COMPOSER_RUNTIME_BIN_DIR&quot;
fi
</code></pre>
<p>If you want to rely on this in your package you should however make sure to
also require <code>&quot;composer-runtime-api&quot;: &quot;^2.2.2&quot;</code> to ensure that the package
gets installed with a Composer version supporting the feature.</p>
<h2 id="what-about-windows-and-bat-files"><a class="header" href="#what-about-windows-and-bat-files">What about Windows and .bat files?</a></h2>
<p>Packages managed entirely by Composer do not <em>need</em> to contain any
<code>.bat</code> files for Windows compatibility. Composer handles installation
of binaries in a special way when run in a Windows environment:</p>
<ul>
<li>A <code>.bat</code> file is generated automatically to reference the binary</li>
<li>A Unix-style proxy file with the same name as the binary is also
generated, which is useful for WSL, Linux VMs, etc.</li>
</ul>
<p>Packages that need to support workflows that may not include Composer
are welcome to maintain custom <code>.bat</code> files. In this case, the package
should <strong>not</strong> list the <code>.bat</code> file as a binary as it is not needed.</p>
<h2 id="can-vendor-binaries-be-installed-somewhere-other-than-vendorbin"><a class="header" href="#can-vendor-binaries-be-installed-somewhere-other-than-vendorbin">Can vendor binaries be installed somewhere other than vendor/bin?</a></h2>
<p>Yes, there are two ways an alternate vendor binary location can be specified:</p>
<ol>
<li>Setting the <code>bin-dir</code> configuration setting in <code>composer.json</code></li>
<li>Setting the environment variable <code>COMPOSER_BIN_DIR</code></li>
</ol>
<p>An example of the former looks like this:</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;bin-dir&quot;: &quot;scripts&quot;
    }
}
</code></pre>
<p>Running <code>composer install</code> for this <code>composer.json</code> will result in
all of the vendor binaries being installed in <code>scripts/</code> instead of
<code>vendor/bin/</code>.</p>
<p>You can set <code>bin-dir</code> to <code>./</code> to put binaries in your project root.</p>
<div style="break-before: page; page-break-before: always;"></div><!--
    tagline: Versions explained.
-->
<h1 id="versions-and-constraints"><a class="header" href="#versions-and-constraints">Versions and constraints</a></h1>
<h2 id="composer-versions-vs-vcs-versions"><a class="header" href="#composer-versions-vs-vcs-versions">Composer Versions vs VCS Versions</a></h2>
<p>Because Composer is heavily geared toward utilizing version control systems
like git, the term &quot;version&quot; can be a little ambiguous. In the sense of a
version control system, a &quot;version&quot; is a specific set of files that contain
specific data. In git terminology, this is a &quot;ref&quot;, or a specific commit,
which may be represented by a branch HEAD or a tag. When you check out that
version in your VCS -- for example, tag <code>v1.1</code> or commit <code>e35fa0d</code> --, you're
asking for a single, known set of files, and you always get the same files back.</p>
<p>In Composer, what's often referred to casually as a version -- that is,
the string that follows the package name in a require line (e.g., <code>~1.1</code> or
<code>1.2.*</code>) -- is actually more specifically a version constraint. Composer
uses version constraints to figure out which refs in a VCS it should be
checking out (or to verify that a given library is acceptable in
the case of a statically-maintained library with a <code>version</code> specification
in <code>composer.json</code>).</p>
<h2 id="vcs-tags-and-branches"><a class="header" href="#vcs-tags-and-branches">VCS Tags and Branches</a></h2>
<p><em>For the following discussion, let's assume the following sample library
repository:</em></p>
<pre><code class="language-sh">~/my-library$ git branch
v1
v2
my-feature
another-feature

~/my-library$ git tag
v1.0
v1.0.1
v1.0.2
v1.1-BETA
v1.1-RC1
v1.1-RC2
v1.1
v1.1.1
v2.0-BETA
v2.0-RC1
v2.0
v2.0.1
v2.0.2
</code></pre>
<h3 id="tags"><a class="header" href="#tags">Tags</a></h3>
<p>Normally, Composer deals with tags (as opposed to branches -- if you don't
know what this means, read up on
<a href="https://en.wikipedia.org/wiki/Version_control#Common_terminology">version control systems</a>).
When you write a version constraint, it may reference a specific tag (e.g.,
<code>1.1</code>) or it may reference a valid range of tags (e.g., <code>&gt;=1.1 &lt;2.0</code>, or
<code>~4.0</code>). To resolve these constraints, Composer first asks the VCS to list
all available tags, then creates an internal list of available versions based
on these tags. In the above example, composer's internal list includes versions
<code>1.0</code>, <code>1.0.1</code>, <code>1.0.2</code>, the beta release of <code>1.1</code>, the first and second
release candidates of <code>1.1</code>, the final release version <code>1.1</code>, etc.... (Note
that Composer automatically removes the 'v' prefix in the actual tagname to
get a valid final version number.)</p>
<p>When Composer has a complete list of available versions from your VCS, it then
finds the highest version that matches all version constraints in your project
(it's possible that other packages require more specific versions of the
library than you do, so the version it chooses may not always be the highest
available version) and it downloads a zip archive of that tag to unpack in the
correct location in your <code>vendor</code> directory.</p>
<h3 id="branches"><a class="header" href="#branches">Branches</a></h3>
<p>If you want Composer to check out a branch instead of a tag, you need to point it to the branch using the special <code>dev-*</code> prefix (or sometimes suffix; see below). If you're checking out a branch, it's assumed that you want to <em>work</em> on the branch and Composer actually clones the repo into the correct place in your <code>vendor</code> directory. For tags, it copies the right files without actually cloning the repo. (You can modify this behavior with --prefer-source and --prefer-dist, see <a href="en/articles/../03-cli.html#install">install options</a>.)</p>
<p>In the above example, if you wanted to check out the <code>my-feature</code> branch, you would specify <code>dev-my-feature</code> as the version constraint in your <code>require</code> clause. This would result in Composer cloning the <code>my-library</code> repository into my <code>vendor</code> directory and checking out the <code>my-feature</code> branch.</p>
<p>When branch names look like versions, we have to clarify for Composer that we're trying to check out a branch and not a tag. In the above example, we have two version branches: <code>v1</code> and <code>v2</code>. To get Composer to check out one of these branches, you must specify a version constraint that looks like this: <code>v1.x-dev</code>. The <code>.x</code> is an arbitrary string that Composer requires to tell it that we're talking about the <code>v1</code> branch and not a <code>v1</code> tag (alternatively, you can name the branch <code>v1.x</code> instead of <code>v1</code>). In the case of a branch with a version-like name (<code>v1</code>, in this case), you append <code>-dev</code> as a suffix, rather than using <code>dev-</code> as a prefix.</p>
<h3 id="stabilities"><a class="header" href="#stabilities">Stabilities</a></h3>
<p>Composer recognizes the following stabilities (in order of stability): dev,
alpha, beta, RC, and stable where RC stands for release candidate. The stability
of a version is defined by its suffix e.g version <code>v1.1-BETA</code> has a stability of
<code>beta</code> and <code>v1.1-RC1</code> has a stability of <code>RC</code>. If such a suffix is missing
e.g. version <code>v1.1</code> then Composer considers that version <code>stable</code>. In addition
to that Composer automatically adds a <code>-dev</code> suffix to all numeric branches and
prefixes all other branches imported from a VCS repository with <code>dev-</code>. In both
cases the stability <code>dev</code> gets assigned.</p>
<p>Keeping this in mind will help you in the next section.</p>
<h3 id="minimum-stability"><a class="header" href="#minimum-stability">Minimum Stability</a></h3>
<p>There's one more thing that will affect which files are checked out of a library's VCS and added to your project: Composer allows you to specify stability constraints to limit which tags are considered valid. In the above example, note that the library released a beta and two release candidates for version <code>1.1</code> before the final official release. To receive these versions when running <code>composer install</code> or <code>composer update</code>, we have to explicitly tell Composer that we are ok with release candidates and beta releases (and alpha releases, if we want those). This can be done using either a project-wide <code>minimum-stability</code> value in <code>composer.json</code> or using &quot;stability flags&quot; in version constraints. Read more on the <a href="en/articles/../04-schema.html#minimum-stability">schema page</a>.</p>
<h2 id="writing-version-constraints"><a class="header" href="#writing-version-constraints">Writing Version Constraints</a></h2>
<p>Now that you have an idea of how Composer sees versions, let's talk about how
to specify version constraints for your project dependencies.</p>
<h3 id="exact-version-constraint"><a class="header" href="#exact-version-constraint">Exact Version Constraint</a></h3>
<p>You can specify the exact version of a package. This will tell Composer to
install this version and this version only. If other dependencies require
a different version, the solver will ultimately fail and abort any install
or update procedures.</p>
<p>Example: <code>1.0.2</code></p>
<h3 id="version-range"><a class="header" href="#version-range">Version Range</a></h3>
<p>By using comparison operators you can specify ranges of valid versions. Valid
operators are <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>!=</code>.</p>
<p>You can define multiple ranges. Ranges separated by a space (<code> </code>)
or comma (<code>,</code>) will be treated as a <strong>logical AND</strong>. A double pipe (<code>||</code>)
will be treated as a <strong>logical OR</strong>. AND has higher precedence than OR.</p>
<blockquote>
<p><strong>Note:</strong> Be careful when using unbounded ranges as you might end up
unexpectedly installing versions that break backwards compatibility.
Consider using the <a href="en/articles/versions.html#caret-version-range-">caret</a> operator instead for safety.</p>
</blockquote>
<!--blank line followed by comment markup to separate the block quotes-->
<blockquote>
<p><strong>Note:</strong> In older versions of Composer the single pipe (<code>|</code>) was the
recommended alternative to the <strong>logical OR</strong>. Thus for backwards compatibility
the single pipe (<code>|</code>) will still be treated as a <strong>logical OR</strong>.</p>
</blockquote>
<p>Examples:</p>
<ul>
<li><code>&gt;=1.0</code></li>
<li><code>&gt;=1.0 &lt;2.0</code></li>
<li><code>&gt;=1.0 &lt;1.1 || &gt;=1.2</code></li>
</ul>
<h3 id="hyphenated-version-range--"><a class="header" href="#hyphenated-version-range--">Hyphenated Version Range (<code>-</code>)</a></h3>
<p>Inclusive set of versions. Partial versions on the right include are completed
with a wildcard. For example <code>1.0 - 2.0</code> is equivalent to <code>&gt;=1.0.0 &lt;2.1</code> as the
<code>2.0</code> becomes <code>2.0.*</code>. On the other hand <code>1.0.0 - 2.1.0</code> is equivalent to
<code>&gt;=1.0.0 &lt;=2.1.0</code>.</p>
<p>Example: <code>1.0 - 2.0</code></p>
<h3 id="wildcard-version-range-"><a class="header" href="#wildcard-version-range-">Wildcard Version Range (<code>.*</code>)</a></h3>
<p>You can specify a pattern with a <code>*</code> wildcard. <code>1.0.*</code> is the equivalent of
<code>&gt;=1.0 &lt;1.1</code>.</p>
<p>Example: <code>1.0.*</code></p>
<h2 id="next-significant-release-operators"><a class="header" href="#next-significant-release-operators">Next Significant Release Operators</a></h2>
<h3 id="tilde-version-range-"><a class="header" href="#tilde-version-range-">Tilde Version Range (<code>~</code>)</a></h3>
<p>The <code>~</code> operator is best explained by example: <code>~1.2</code> is equivalent to
<code>&gt;=1.2 &lt;2.0.0</code>, while <code>~1.2.3</code> is equivalent to <code>&gt;=1.2.3 &lt;1.3.0</code>. As you can see
it is mostly useful for projects respecting <a href="https://semver.org/">semantic
versioning</a>. A common usage would be to mark the minimum
minor version you depend on, like <code>~1.2</code> (which allows anything up to, but not
including, 2.0). Since in theory there should be no backwards compatibility
breaks until 2.0, that works well. Another way of looking at it is that using
<code>~</code> specifies a minimum version, but allows the last digit specified to go up.</p>
<p>Example: <code>~1.2</code></p>
<blockquote>
<p><strong>Note:</strong> Although <code>2.0-beta.1</code> is strictly before <code>2.0</code>, a version constraint
like <code>~1.2</code> would not install it. As said above <code>~1.2</code> only means the <code>.2</code>
can change but the <code>1.</code> part is fixed.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> The <code>~</code> operator has an exception on its behavior for the major
release number. This means for example that <code>~1</code> is the same as <code>~1.0</code> as
it will not allow the major number to increase trying to keep backwards
compatibility.</p>
</blockquote>
<h3 id="caret-version-range-"><a class="header" href="#caret-version-range-">Caret Version Range (<code>^</code>)</a></h3>
<p>The <code>^</code> operator behaves very similarly, but it sticks closer to semantic
versioning, and will always allow non-breaking updates. For example <code>^1.2.3</code>
is equivalent to <code>&gt;=1.2.3 &lt;2.0.0</code> as none of the releases until 2.0 should
break backwards compatibility. For pre-1.0 versions it also acts with safety
in mind and treats <code>^0.3</code> as <code>&gt;=0.3.0 &lt;0.4.0</code> and <code>^0.0.3</code> as <code>&gt;=0.0.3 &lt;0.0.4</code>.</p>
<p>This is the recommended operator for maximum interoperability when writing
library code.</p>
<p>Example: <code>^1.2.3</code></p>
<h2 id="stability-constraints"><a class="header" href="#stability-constraints">Stability Constraints</a></h2>
<p>If you are using a constraint that does not explicitly define a stability,
Composer will default internally to <code>-dev</code> or <code>-stable</code>, depending on the
operator(s) used. This happens transparently.</p>
<p>If you wish to explicitly consider only the stable release in the comparison,
add the suffix <code>-stable</code>.</p>
<p>Examples:</p>
<table><thead><tr><th>Constraint</th><th>Internally</th></tr></thead><tbody>
<tr><td><code>1.2.3</code></td><td><code>=1.2.3.0-stable</code></td></tr>
<tr><td><code>&gt;1.2</code></td><td><code>&gt;1.2.0.0-stable</code></td></tr>
<tr><td><code>&gt;=1.2</code></td><td><code>&gt;=1.2.0.0-dev</code></td></tr>
<tr><td><code>&gt;=1.2-stable</code></td><td><code>&gt;=1.2.0.0-stable</code></td></tr>
<tr><td><code>&lt;1.3</code></td><td><code>&lt;1.3.0.0-dev</code></td></tr>
<tr><td><code>&lt;=1.3</code></td><td><code>&lt;=1.3.0.0-stable</code></td></tr>
<tr><td><code>1 - 2</code></td><td><code>&gt;=1.0.0.0-dev &lt;3.0.0.0-dev</code></td></tr>
<tr><td><code>~1.3</code></td><td><code>&gt;=1.3.0.0-dev &lt;2.0.0.0-dev</code></td></tr>
<tr><td><code>1.4.*</code></td><td><code>&gt;=1.4.0.0-dev &lt;1.5.0.0-dev</code></td></tr>
</tbody></table>
<p>To allow various stabilities without enforcing them at the constraint level
however, you may use <a href="en/articles/../04-schema.html#package-links">stability-flags</a> like
<code>@&lt;stability&gt;</code> (e.g. <code>@dev</code>) to let Composer know that a given package
can be installed in a different stability than your default minimum-stability
setting. All available stability flags are listed on the minimum-stability
section of the <a href="en/articles/../04-schema.html#minimum-stability">schema page</a>.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<pre><code class="language-jsonc">&quot;require&quot;: {
    &quot;vendor/package&quot;: &quot;1.3.2&quot;, // exactly 1.3.2

    // &gt;, &lt;, &gt;=, &lt;= | specify upper / lower bounds
    &quot;vendor/package&quot;: &quot;&gt;=1.3.2&quot;, // anything above or equal to 1.3.2
    &quot;vendor/package&quot;: &quot;&lt;1.3.2&quot;, // anything below 1.3.2

    // * | wildcard
    &quot;vendor/package&quot;: &quot;1.3.*&quot;, // &gt;=1.3.0 &lt;1.4.0

    // ~ | allows last digit specified to go up
    &quot;vendor/package&quot;: &quot;~1.3.2&quot;, // &gt;=1.3.2 &lt;1.4.0
    &quot;vendor/package&quot;: &quot;~1.3&quot;, // &gt;=1.3.0 &lt;2.0.0

    // ^ | doesn't allow breaking changes (major version fixed - following semver)
    &quot;vendor/package&quot;: &quot;^1.3.2&quot;, // &gt;=1.3.2 &lt;2.0.0
    &quot;vendor/package&quot;: &quot;^0.3.2&quot;, // &gt;=0.3.2 &lt;0.4.0 // except if major version is 0
}
</code></pre>
<h2 id="testing-version-constraints"><a class="header" href="#testing-version-constraints">Testing Version Constraints</a></h2>
<p>You can test version constraints using <a href="https://semver.madewithlove.com">semver.madewithlove.com</a>.
Fill in a package name and it will autofill the default version constraint
which Composer would add to your <code>composer.json</code> file. You can adjust the
version constraint and the tool will highlight all releases that match.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-do-i-install-a-package-to-a-custom-path-for-my-framework"><a class="header" href="#how-do-i-install-a-package-to-a-custom-path-for-my-framework">How do I install a package to a custom path for my framework?</a></h1>
<p>Each framework may have one or many different required package installation
paths. Composer can be configured to install packages to a folder other than
the default <code>vendor</code> folder by using
<a href="https://github.com/composer/installers">composer/installers</a>.</p>
<p>If you are a <strong>package author</strong> and want your package installed to a custom
directory, require <code>composer/installers</code> and set the appropriate <code>type</code>.
Specifying the package type, will override the default installer path.
This is common if your package is intended for a specific framework such as
CakePHP, Drupal or WordPress. Here is an example composer.json file for a
WordPress theme:</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;you/themename&quot;,
    &quot;type&quot;: &quot;wordpress-theme&quot;,
    &quot;require&quot;: {
        &quot;composer/installers&quot;: &quot;~1.0&quot;
    }
}
</code></pre>
<p>Now when your theme is installed with Composer it will be placed into
<code>wp-content/themes/themename/</code> folder. Check the
<a href="https://github.com/composer/installers#current-supported-package-types">current supported types</a>
for your package.</p>
<p>As a <strong>package consumer</strong> you can set or override the install path for a package
that requires composer/installers by configuring the <code>installer-paths</code> extra. A
useful example would be for a Drupal multisite setup where the package should be
installed into your site's subdirectory. Here we are overriding the install path
for a module that uses composer/installers, as well as putting all packages of type
<code>drupal-theme</code> into a themes folder:</p>
<pre><code class="language-json">{
    &quot;extra&quot;: {
        &quot;installer-paths&quot;: {
            &quot;sites/example.com/modules/{$name}&quot;: [&quot;vendor/package&quot;],
            &quot;sites/example.com/themes/{$name}&quot;: [&quot;type:drupal-theme&quot;]
        }
    }
}
</code></pre>
<p>Now the package would be installed to your folder location, rather than the default
composer/installers determined location. In addition, <code>installer-paths</code> is
order-dependent, which means moving a package by name should come before the installer
path of a <code>type:*</code> that matches the same package.</p>
<blockquote>
<p><strong>Note:</strong> You cannot use this to change the path of any package. This is only
applicable to packages that require <code>composer/installers</code> and use a custom type
that it handles.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-do-i-install-composer-programmatically"><a class="header" href="#how-do-i-install-composer-programmatically">How do I install Composer programmatically?</a></h1>
<p>As noted on the download page, the installer script contains a
checksum which changes when the installer code changes and as such
it should not be relied upon in the long term.</p>
<p>An alternative is to use this script which only works with UNIX utilities:</p>
<pre><code class="language-bash">#!/bin/sh

EXPECTED_CHECKSUM=&quot;$(php -r 'copy(&quot;https://composer.github.io/installer.sig&quot;, &quot;php://stdout&quot;);')&quot;
php -r &quot;copy('https://getcomposer.org/installer', 'composer-setup.php');&quot;
ACTUAL_CHECKSUM=&quot;$(php -r &quot;echo hash_file('sha384', 'composer-setup.php');&quot;)&quot;

if [ &quot;$EXPECTED_CHECKSUM&quot; != &quot;$ACTUAL_CHECKSUM&quot; ]
then
    &gt;&amp;2 echo 'ERROR: Invalid installer checksum'
    rm composer-setup.php
    exit 1
fi

php composer-setup.php --quiet
RESULT=$?
rm composer-setup.php
exit $RESULT
</code></pre>
<p>The script will exit with 1 in case of failure, or 0 on success, and is quiet
if no error occurs.</p>
<p>Alternatively, if you want to rely on an exact copy of the installer, you can fetch
a specific version from GitHub's history. The commit hash should be enough to
give it uniqueness and authenticity as long as you can trust the GitHub servers.
For example:</p>
<pre><code class="language-bash">wget https://raw.githubusercontent.com/composer/getcomposer.org/76a7060ccb93902cd7576b67264ad91c8a2700e2/web/installer -O - -q | php -- --quiet
</code></pre>
<p>You may replace the commit hash by whatever the last commit hash is on
https://github.com/composer/getcomposer.org/commits/main</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-do-i-install-untrusted-packages-safely-is-it-safe-to-run-composer-as-superuser-or-root"><a class="header" href="#how-do-i-install-untrusted-packages-safely-is-it-safe-to-run-composer-as-superuser-or-root">How do I install untrusted packages safely? Is it safe to run Composer as superuser or root?</a></h1>
<p>Certain Composer commands, including <code>exec</code>, <code>install</code>, and <code>update</code> allow third party code to
execute on your system. This is from its &quot;plugins&quot; and &quot;scripts&quot; features. Plugins and scripts have
full access to the user account which runs Composer. For this reason, it is strongly advised to
<strong>avoid running Composer as super-user/root</strong>. All commands also dispatch events which can be
caught by plugins so unless explicitly disabled installed plugins will be loaded/executed by <strong>every</strong>
Composer command.</p>
<p>You can disable plugins and scripts during package installation or updates with the following
syntax so only Composer's code, and no third party code, will execute:</p>
<pre><code class="language-sh">php composer.phar install --no-plugins --no-scripts ...
php composer.phar update --no-plugins --no-scripts ...
</code></pre>
<p>Depending on the operating system we have seen cases where it is possible to trigger execution
of files in the repository using specially crafted <code>composer.json</code>. So in general if you do want
to install untrusted dependencies you should sandbox them completely in a container or equivalent.</p>
<p>Also note that the <code>exec</code> command will always run third party code as the user which runs <code>composer</code>.</p>
<p>See <a href="en/faqs/../03-cli.html#composer-allow-superuser">Environment variable - COMPOSER_ALLOW_SUPERUSER</a>
for more info on how to disable warning</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="should-i-commit-the-dependencies-in-my-vendor-directory"><a class="header" href="#should-i-commit-the-dependencies-in-my-vendor-directory">Should I commit the dependencies in my vendor directory?</a></h1>
<p>The general recommendation is <strong>no</strong>. The vendor directory (or wherever your
dependencies are installed) should be added to <code>.gitignore</code>/<code>svn:ignore</code>/etc.</p>
<p>The best practice is to then have all the developers use Composer to install
the dependencies. Similarly, the build server, CI, deployment tools etc should
be adapted to run Composer as part of their project bootstrapping.</p>
<p>While it can be tempting to commit it in some environment, it leads to a few
problems:</p>
<ul>
<li>Large VCS repository size and diffs when you update code.</li>
<li>Duplication of the history of all your dependencies in your own VCS.</li>
<li>Adding dependencies installed via git to a git repo will show them as
submodules. This is problematic because they are not real submodules, and you
will run into issues.</li>
</ul>
<p>If you really feel like you must do this, you have a few options:</p>
<ol>
<li>Limit yourself to installing tagged releases (no dev versions), so that you
only get zipped installs, and avoid problems with the git &quot;submodules&quot;.</li>
<li>Use --prefer-dist or set <code>preferred-install</code> to <code>dist</code> in your
<a href="en/faqs/../04-schema.html#config">config</a>.</li>
<li>Remove the <code>.git</code> directory of every dependency after the installation, then
you can add them to your git repo. You can do that with <code>rm -rf vendor/**/.git</code>
in ZSH or <code>find vendor/ -type d -name &quot;.git&quot; -exec rm -rf {} \;</code> in Bash.
But this means you will have to delete those dependencies from disk before
running <code>composer update</code>.</li>
<li>Add a .gitignore rule (<code>/vendor/**/.git</code>) to ignore all the vendor <code>.git</code> folders.
This approach does not require that you delete dependencies from disk prior to
running a <code>composer update</code>.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="which-version-numbering-system-does-composer-itself-use"><a class="header" href="#which-version-numbering-system-does-composer-itself-use">Which version numbering system does Composer itself use?</a></h1>
<p>Composer uses <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning (aka SemVer)
2.0.0</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-are-unbound-version-constraints-a-bad-idea"><a class="header" href="#why-are-unbound-version-constraints-a-bad-idea">Why are unbound version constraints a bad idea?</a></h1>
<p>A version constraint without an upper bound such as <code>*</code>, <code>&gt;=3.4</code> or
<code>dev-master</code> will allow updates to any future version of the dependency.
This includes major versions breaking backward compatibility.</p>
<p>Once a release of your package is tagged, you cannot tweak its dependencies
anymore in case a dependency breaks BC - you have to do a new release, but the
previous one stays broken.</p>
<p>The only good alternative is to define an upper bound on your constraints,
which you can increase in a new release after testing that your package is
compatible with the new major version of your dependency.</p>
<p>For example instead of using <code>&gt;=3.4</code> you should use <code>~3.4</code> which allows all
versions up to <code>3.999</code> but does not include <code>4.0</code> and above. The <code>^</code> operator
works very well with libraries following <a href="https://semver.org">semantic versioning</a>.</p>
<p><strong>Note:</strong> As a package maintainer, you can help your users
by providing an <a href="en/faqs/../articles/aliases.html">alias version</a> for your development
branch to allow it to match bound constraints.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-are-version-constraints-combining-comparisons-and-wildcards-a-bad-idea"><a class="header" href="#why-are-version-constraints-combining-comparisons-and-wildcards-a-bad-idea">Why are version constraints combining comparisons and wildcards a bad idea?</a></h1>
<p>This is a fairly common mistake people make, defining version constraints in
their package requires like <code>&gt;=2.*</code> or <code>&gt;=1.1.*</code>.</p>
<p>If you think about it and what it really means though, you will quickly
realize that it does not make much sense. If we decompose <code>&gt;=2.*</code>, you
have two parts:</p>
<ul>
<li><code>&gt;=2</code> which says the package should be in version 2.0.0 or above.</li>
<li><code>2.*</code> which says the package should be between version 2.0.0 (inclusive)
and 3.0.0 (exclusive).</li>
</ul>
<p>As you see, both rules agree on the fact that the package must be &gt;=2.0.0,
but it is not possible to determine if when you wrote that you were thinking
of a package in version 3.0.0 or not. Should it match because you asked for
<code>&gt;=2</code> or should it not match because you asked for a <code>2.*</code>?</p>
<p>For this reason, Composer throws an error and says that this is invalid.
The way to fix it is to think about what you really mean, and use only
one of those rules.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-cant-composer-load-repositories-recursively"><a class="header" href="#why-cant-composer-load-repositories-recursively">Why can't Composer load repositories recursively?</a></h1>
<p>You may run into problems when using custom repositories because Composer does
not load the repositories of your requirements, so you have to redefine those
repositories in all your <code>composer.json</code> files.</p>
<p>Before going into details as to why this is like that, you have to understand
that the main use of custom VCS &amp; package repositories is to temporarily try
some things, or use a fork of a project until your pull request is merged, etc.
You should not use them to keep track of private packages. For that you should
rather look into <a href="https://packagist.com">Private Packagist</a> which lets you
configure all your private packages in one place, and avoids the slow-downs
associated with inline VCS repositories.</p>
<p>There are three ways the dependency solver could work with custom repositories:</p>
<ul>
<li>
<p>Fetch the repositories of root package, get all the packages from the defined
repositories, then resolve requirements. This is the current state and it works well
except for the limitation of not loading repositories recursively.</p>
</li>
<li>
<p>Fetch the repositories of root package, while initializing packages from the
defined repos, initialize recursively all repos found in those packages, and
their package's packages, etc, then resolve requirements. It could work, but it
slows down the initialization a lot since VCS repos can each take a few seconds,
and it could end up in a completely broken state since many versions of a package
could define the same packages inside a package repository, but with different
dist/source. There are many ways this could go wrong.</p>
</li>
<li>
<p>Fetch the repositories of root package, then fetch the repositories of the
first level dependencies, then fetch the repositories of their dependencies, etc,
then resolve requirements. This sounds more efficient, but it suffers from the
same problems as the second solution, because loading the repositories of the
dependencies is not as easy as it sounds. You need to load all the repos of all
the potential matches for a requirement, which again might have conflicting
package definitions.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
